@(#)PROGRAM:stapler  PROJECT:libticket-33
t8lr
t8lr
init
setHashedFile:
hashedFile
setAppropriateExitCode:
length
bytes
setRevoked:
dataWithBytes:length:
cdHash
isEqualToData:
ticketData
isValidTicketData:
errorWithDomain:code:userInfo:
localizedDescription
tempFileURL
writeToURL:options:error:
fileURL
path
operation
writeNewTicketDataFromURL:error:
stringByReplacingOccurrencesOfString:withString:
URLWithString:
requestWithURL:
ephemeralSessionConfiguration
sessionWithConfiguration:delegate:delegateQueue:
downloadTaskWithRequest:
resume
state
isExistingTicketValid
lastPathComponent
revoked
notifyResult
digestAlgorithm
dataWithJSONObject:options:error:
setHTTPMethod:
setHTTPBody:
addValue:forHTTPHeaderField:
allHTTPHeaderFields
allHeaderFields
objectForKeyedSubscript:
processInfo
globallyUniqueString
defaultManager
temporaryDirectory
stringWithFormat:
URLByAppendingPathComponent:
setTempFileURL:
JSONObjectWithData:options:error:
objectAtIndexedSubscript:
setLargeTicketSize:
initWithBase64EncodedString:options:
asynchronouslyDownloadLargeTicketFromURLString:
prettyHashString
writeDownloadedData:withError:
dataTaskWithRequest:completionHandler:
appropriateExitCode
initWithFileURL:
protectionSpace
host
authenticationMethod
isEqualToString:
serverTrust
array
addObject:
count
countByEnumeratingWithState:objects:count:
credentialForTrust:
dataWithContentsOfURL:
response
largeTicketSize
unsignedIntegerValue
statusCode
localizedStringForStatusCode:
stringFromByteCount:countStyle:
localizedFailureReason
isEqual:
class
self
performSelector:
performSelector:withObject:
performSelector:withObject:withObject:
isProxy
isKindOfClass:
isMemberOfClass:
conformsToProtocol:
respondsToSelector:
retain
release
autorelease
retainCount
zone
hash
superclass
description
debugDescription
TQ,R
T#,R
T@"NSString",R,C
URLSession:didBecomeInvalidWithError:
URLSession:didReceiveChallenge:completionHandler:
URLSessionDidFinishEventsForBackgroundURLSession:
initWithHashedFile:
grabTicket
URLSession:downloadTask:didFinishDownloadingToURL:
URLSession:task:didCompleteWithError:
setOperation:
dryrun
setDryrun:
force
setForce:
.cxx_destruct
_operation
_dryrun
_force
_hashedFile
_tempFileURL
_largeTicketSize
T@"LTHashedFile",&,V_hashedFile
T@"NSURL",&,V_tempFileURL
T@"NSNumber",&,V_largeTicketSize
TC,V_operation
Tc,V_dryrun
Tc,V_force
initWithSuiteName:
registerDefaults:
stringForKey:
boolForKey:
dictionaryWithObjects:forKeys:count:
arrayWithObjects:count:
stringWithCapacity:
appendFormat:
dictionary
setObject:forKeyedSubscript:
copy
arguments
lastObject
fileURLWithPath:
currentRunLoop
initWithFormat:arguments:
stringByAppendingString:
fileHandleWithStandardOutput
fileHandleWithNullDevice
dataUsingEncoding:
writeData:
setFileURL:
codeResourcesURL
getResourceValue:forKey:error:
boolValue
dataWithContentsOfURL:options:error:
unsignedIntValue
setDigestAlgorithm:
trashItemAtURL:resultingItemURL:error:
copyItemAtURL:toURL:error:
removeItemAtURL:error:
processName
_ticketData
_cdHash
_deleteExistingTicket
internalTicketData
setInternalTicketData:
internalCDHash
setInternalCDHash:
_internalTicketData
_internalCDHash
T@"NSURL",R
T@"NSData",C,V_internalTicketData
T@"NSData",C,V_internalCDHash
populateHeader
fileHandleForReadingFromURL:error:
seekToEndOfFile
setOrigEOF:
reason
origEOF
seekToFileOffset:
readDataOfLength:
dmgHeader
setCsStart:
setCsLength:
csStart
csLength
setEndOfDMGData:
emptySuperblob
setSuperblob:
setSyntheticCDHash:
superblob
getBytes:length:
setNumBlobs:
numBlobs
orderedBlobSetForSuperBlob:numberOfBlobs:
setBlobs:
blobs
closeFile
orderedSet
getBytes:range:
numberWithUnsignedInt:
numberWithUnsignedInteger:
subdataWithRange:
syntheticCDHash
data
appendData:
dataWithData:
replaceBytesInRange:withBytes:length:
appendBytes:length:
stringByAppendingPathComponent:
fileHandleForUpdatingURL:error:
endOfDMGData
offsetInFile
truncateFileAtOffset:
synchronizeFile
_writeNewTicketDataFromURL:intoURL:deleteExisting:error:
setDmgHeader:
_numBlobs
_superblob
_blobs
_syntheticCDHash
_origEOF
_csStart
_csLength
_endOfDMGData
_dmgHeader
T{UDIFFileHeader=IIiIqqqqqII{HDISegmentID=[16C]}{HDIChecksumStruct=II[128C]}qq{UDIFFileExternal=[64c]}QQ{UDIFFileHeaderReserved=[40c]}{HDIChecksumStruct=II[128C]}iq[12C]},V_dmgHeader
T@"NSData",C,V_superblob
T@"NSOrderedSet",C,V_blobs
T@"NSData",C,V_syntheticCDHash
TQ,V_origEOF
TQ,V_csStart
TQ,V_csLength
TQ,V_endOfDMGData
TI,V_numBlobs
setObject:forKey:
null
setWithArray:
lowercaseString
indexOfObjectPassingTest:
resourceValuesForKeys:error:
pathExtension
bundleWithURL:
executableURL
URLForDirectory:inDomain:appropriateForURL:create:error:
isEqualTo:
replaceItemAtURL:withItemAtURL:backupItemName:options:resultingItemURL:error:
common_writeNewTicketDataFromURL:deleteExisting:error:
exceptionWithName:reason:userInfo:
raise
_deleteExistingTicket:
_revoked
_appropriateExitCode
_digestAlgorithm
_fileURL
T@"NSURL",C,V_fileURL
Ti,V_appropriateExitCode
Tc,V_revoked
T@"NSData",R
TI,V_digestAlgorithm
setOrigEOL:
setHasTrailers:
setTicketStart:
setTicketLength:
setDataToAppend:
fileSystemRepresentation
stringWithUTF8String:
intValue
ticketStart
hasTrailers
dataToAppend
origEOL
ticketLength
_hasTrailers
_origEOL
_ticketStart
_ticketLength
_dataToAppend
TQ,V_origEOL
TQ,V_ticketStart
TQ,V_ticketLength
Tc,V_hasTrailers
T@"NSData",C,V_dataToAppend
Could not save data. %@
Downloaded ticket has been stored at %@.
Could not write ticket to %@ due to %@
Could not validate ticket for %@
${f}
ckasset.ticket
Large ticket was requested from an invalid URL: %@
URL of large ticket asset: %@
Cannot download ticket. CDHash must be set.
Cannot download ticket. File Path is required for the given CDHash.
%@ does not have a ticket stapled to it.
POST
application/json
Content-Type
JSON Data is %@
 Headers: %@
Response is %@
error is %@
Size of data is %lu
CloudKit's response is inconsistent with expections: %@
X-Apple-Request-UUID
%@.ticket
JSON Response is: %@
records
fields
signedTicket
value
signedTicketAsset
downloadURL
size
reason
CloudKit query for %@ (%@) failed due to "%@".
CloudKit query for %@ did not return expected JSON data.
Could not find base64 encoded ticket in response for %@
v32@?0@"NSData"8@"NSURLResponse"16@"NSError"24
%d/%@
Although we wrote the ticket, the written data did not validate. Please restore %@ from backup to try again.
The %@ action %@!%@
staple and validate
validate
failed
worked
 Error %d.
The ticket for %@ has been revoked. Gatekeeper will prevent it from running.
Domain is %@
Could not set trust policy. %@
Certificate trust evaluation failed. %@
Certificate trust evaluation did not return expected result. (%d) %@
Certificate trust evaluation for %@ did not return expected result. %@.
Could not establish secure connection to %@
We were expecting a ticket size of %@ but download a ticket of size %lu
Attempting to download larger ticket for %@ failed. %@
Big ticket response is %@
Downloaded large ticket size is %@
Large ticket for %@ failed to download. %@
https://api.apple-cloudkit.com/database/1/%@/%@/public/records/lookup
com.apple.gk.ticket-delivery
production
com.apple.gk.stapler
ck-container
ck-production
development
%d/%d/%@
recordName
%02hhx
cdhash
digestAlgorithm
teamId
secureTimestamp
signingId
flags
help
quiet
verbose
staple
Usage: %s staple [-q] [-v] path
        Retrieves a ticket and attaches it to the supported file
        format at path.
Usage: %s validate [-q] [-v] path
        Validates an existing stapled ticket.
Supported file formats are: UDIF disk images, code-signed executable
bundles, and signed "flat" installer packages.
Props are %@
Contents
CodeResources
Successfully moved ticket to trash. Find it at %@
Could not delete ticket %@. %@
Could not save ticket to %@ because an error occurred. %@
Could not remove existing ticket from %@ because an error occurred. %@
%@ will not replace the compatibility symlink at %@. Please remove it manually
Could not create file handle to %@. %@
Could not get file size of %@. This should not have happened. %@
%@ is too small (%llu bytes) to be a proper disk image
Could read UDIF header of %@. This should not have happened. %@
Not a supported disk image format, %d
%@ only supports version %d disk images while %@ is version %d.
Creating synthetic cdHash for unsigned disk image, %@. Humanity must endure.
synthetic cdHash generation failed. %d
Codesign offset 0x%llx length: %llu
In a good disk image, the stored code signature end MUST match the UDIF header start. It currently doesn't. (%llu vs %llu)
Could read code signature header of %@. This should not have happened. %@
Not a supported code signature block, %d
Stored Codesign length: %u number of blobs: %d
%tu blobs in %@ exceeds the maximum possible number of blobs, %d
The code signature block must be %llu bytes in length. However, it is %d.
Could not get disk image header from %@. %@
cs slot type
offset
Did not find %d unique blobs in the code signing data.
Calculated length (%tu) does not match embedded blob length (%tu)
length
data
magic
Length of all blobs (%tu) did not match length of code signing data (%tu).
Total Length: %tu Found blobs: %tu
Generating a synthetic cdHash for %@ failed. %d
Cannot add a new ticket to %@. %@
Cannot delete an existing ticket in %@ that doesn't exist.
Adding %lu blobs to superblob. What about Blob?
Adding blob of size %@ to offset %d.
Length of new ticket blob is %tu
%@.dmgData
A copy of the new disk image blobs and headers has been saved to %@. Enjoy.
All that work and I can't open %@ for writing.
Truncating %@ from to %llu bytes to %llu bytes.
Fatal error while %@ ticket to %@. %@.
deleting existing
writing new
Unable to create for %@: %@
ADHOC
Unable to create signer reference. %@
Unable to add signer to code reference. %@
Unable to add detached signature to code reference. %@
Could not get signing information. %@
Could not get newly minted CD hash for %@.
Signing information is %@
com.apple.xip-archive
com.apple.installer-package-archive
com.apple.installer-package
com.apple.installer-meta-package
public.unix-executable
com.apple.application
com.apple.dashboard-widget
com.apple.systempreference.prefpane
com.apple.systempreference.screen-saver
com.apple.systempreference.screen-slide-saver
com.apple.menu-extra
com.apple.disk-image-udif
com.apple.bundle
com.apple.package
kext
c32@?0@"NSString"8Q16^c24
File %@ does not exist. %@
Processing: %@
Properties are %@
Stapler is incapable of working with %@ files.
Could not create replacement directory for %@. %@
Could not copy backup to %@. %@
Cloned %@ to %@
Could not replace %@ with the safetly modified file at %@. %@
Successfully trashed %@!!!
Attempting to attach a new ticket to %@. Let's see how that works out.
Attempting to delete the existing ticket attatched %@. Let's see how that works out.
You must override %@ in the %@ subclass
Length %zu does not equal expected size of %lu
We do not know how to deal with trailer version %d. Exepected %d
t8lr
Expected Magic %4s for trailer but found %4s
Terminator Trailer size must be 0, not %d
Trailer type %d does not match expected terminator type %d
Found Terminator at %llu
{magic: %c%c%c%c, version: %d, type: %d, length: %d}
Found unknown trailer type %d. Adding %llu bytes to append.
Couldn't read existing package trailers of %@. %@.
Data read for unknown trailer does not match expected size. %lu vs %llu.
Found expected ticket at %llu with length of %d
Couldn't read existing ticket of %@. %@.
Could not get ticket for %@. %@
Sig Type is %s. Length is %lu
Could not find an appropriate "code signature" in the %@ installer package.
Error %d prevented extracting package hash for package: %@
checksum/size
Package %@ uses a checksum of size %s
SecPolicyCreateAppleDeveloperIDPlusTicket
1.2.840.113635.100.6.2.17
1.2.840.113635.100.6.1.30
1.2.840.113635.100.1.90
g8tk
s8ch
DownloadDelegate
NSURLSessionDelegate
NSObject
LTHashedBundle
LTHashedDiskImage
LTHashedFile
LTHashedFlatPackage
c24@0:8@16
#16@0:8
@16@0:8
@24@0:8:16
@32@0:8:16@24
@40@0:8:16@24@32
c16@0:8
c24@0:8#16
c24@0:8:16
Vv16@0:8
Q16@0:8
^{_NSZone=}16@0:8
c24@0:8@"Protocol"16
@"NSString"16@0:8
v32@0:8@16@24
v40@0:8@16@24@?32
v24@0:8@16
v32@0:8@"NSURLSession"16@"NSError"24
v40@0:8@"NSURLSession"16@"NSURLAuthenticationChallenge"24@?<v@?q@"NSURLCredential">32
v24@0:8@"NSURLSession"16
@24@0:8@16
v32@0:8@16^@24
v16@0:8
v40@0:8@16@24@32
C16@0:8
v20@0:8C16
v20@0:8c16
@"LTHashedFile"
@"NSURL"
@"NSNumber"
c32@0:8@16^@24
@"NSData"
@28@0:8@16I24
c44@0:8@16@24c32^@36
{UDIFFileHeader=IIiIqqqqqII{HDISegmentID=[16C]}{HDIChecksumStruct=II[128C]}qq{UDIFFileExternal=[64c]}QQ{UDIFFileHeaderReserved=[40c]}{HDIChecksumStruct=II[128C]}iq[12C]}16@0:8
v528@0:8{UDIFFileHeader=IIiIqqqqqII{HDISegmentID=[16C]}{HDIChecksumStruct=II[128C]}qq{UDIFFileExternal=[64c]}QQ{UDIFFileHeaderReserved=[40c]}{HDIChecksumStruct=II[128C]}iq[12C]}16
v24@0:8Q16
I16@0:8
v20@0:8I16
@"NSOrderedSet"
{UDIFFileHeader="fUDIFSignature"I"fUDIFVersion"I"fUDIFHeaderSize"i"fUDIFFlags"I"fUDIFRunningDataForkOffset"q"fUDIFDataForkOffset"q"fUDIFDataForkLength"q"fUDIFRsrcForkOffset"q"fUDIFRsrcForkLength"q"fUDIFSegmentNumber"I"fUDIFSegmentCount"I"fUDIFSegmentID"{HDISegmentID="fSegmentID"[16C]}"fUDIFDataForkChecksum"{HDIChecksumStruct="checksumType"I"checksumLength"I"checksumData"[128C]}"fUDIFXMLOffset"q"fUDIFXMLLength"q"fUDIFExternal"{UDIFFileExternal="reserved"[64c]}"fUDIFCodeSignOffset"Q"fUDIFCodeSignLength"Q"fReserved"{UDIFFileHeaderReserved="reserved"[40c]}"fUDIFMasterChecksum"{HDIChecksumStruct="checksumType"I"checksumLength"I"checksumData"[128C]}"fUDIFImageVariant"i"fUDIFSectorCount"q"fPadding"[12C]}
c36@0:8@16c24^@28
c24@0:8^@16
i16@0:8
v20@0:8i16
Unable to create SecCode (%d): %@
Unable to copy signing information (%d)
Unable to copy signing information from code reference.
Unable to extract cdhash from signing information
