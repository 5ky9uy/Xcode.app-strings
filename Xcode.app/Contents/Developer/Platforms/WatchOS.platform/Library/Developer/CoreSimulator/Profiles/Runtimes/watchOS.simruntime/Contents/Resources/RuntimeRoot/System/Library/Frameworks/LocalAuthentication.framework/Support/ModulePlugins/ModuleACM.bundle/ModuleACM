@(#)PROGRAM:ModuleACM  PROJECT:CoreAuthentication-801
init
initWithProcessId:proxy:invalidationBlock:
invalidationBlock
proxy
.cxx_destruct
_pid
_invalidationBlock
_proxy
initWithObjects:
addObject:
addObjectsFromArray:
allInfos
countByEnumeratingWithState:objects:count:
initWithInfo:context:
addInfo:
addInfos:
numberOfOwnersOtherThanPid:
context
_allInfos
_context
initWithLength:
mutableBytes
replaceBytesInRange:withBytes:
initWithACMParamType:bytes:length:
acmParameterWithUserId:
acmParameterWithTimeOffset:
acmParameter
_data
_acmParameter
initWithContextOwner:underlyingPtr:module:
module
untrackPlugin:
contextOwner
dealloc
objectForKey:
_acmPolicyForPolicy:
numberWithInteger:
stringWithFormat:
parameterErrorWithMessage:
createInternalInfoWithPolicy:policyOptions:originator:
_handleAcmRequirement:policy:constraintData:operation:internalInfo:uiDelegate:originator:request:reply:
error:hasCode:
array
boolValue
arrayByAddingObject:
enumerateKeysAndObjectsUsingBlock:
dictionaryWithObject:forKey:
userInfo
dictionaryByMerging:with:
errorWithCode:userInfo:
initWithACMContext:cachedExternalizationDelegate:
sharedInstance
event:params:reply:
finishedAuthenticationForPolicy:constraintData:operation:internalInfo:uiDelegate:originator:request:availabilityEvents:result:error:reply:
authenticateForPolicy:constraintData:internalInfo:uiDelegate:originator:mechanism:reply:
mechanismForACMRequirement:acmContextRecord:policy:internalInfo:uiDelegate:originator:request:reply:
_unsatisfiedListForRequirement:
componentsJoinedByString:
setResultInfo:
integerValue
objectForKeyedSubscript:
processId
checkEntitlement:
intValue
auditToken
callerDisplayNameWithPid:auditToken:bundleId:
count
evaluateACL:operation:options:uiDelegate:originator:request:callerName:callerBundleId:reply:
_decodeOperation:
isEqualToString:
_validateACL:evaluateOperation:options:uiDelegate:originator:request:callerName:callerBundleId:reply:
_evaluateACL:operation:options:uiDelegate:originator:request:callerName:callerBundleId:reply:
_validatePassword:options:uiDelegate:originator:request:callerName:callerBundleId:reply:
_evaluateOperation:aclRef:options:uiDelegate:originator:request:validate:callerName:callerBundleId:reply:
dictionary
errorNotSupported
internalErrorWithMessage:
member:
keyEnumerator
_validateOperations:aclRef:evaluateOperation:options:uiDelegate:originator:request:currentResult:reply:
nextObject
dictionaryWithObjects:forKeys:count:
dictionaryByMergingWith:
_validateOperation:aclRef:evaluateOperation:options:uiDelegate:originator:request:reply:
isEqual:
null
missingEntitlementError:
errorWithCode:message:
dataUsingEncoding:
initWithACMContext:contextOwner:module:
instanceId
_acmParamForPolicy:userId:secondPass:
evaluatePolicy:options:uiDelegate:originator:request:reply:
evaluateACL:operation:options:uiDelegate:originator:request:reply:
_fillConstraint:options:userId:error:
_operationAsString:error:
_isSimpleACLConstraint:
isCredentialSet:originator:reply:
setCredential:type:options:originator:reply:
checkCredentialSatisfied:policy:reply:
_requirementTypeForCredentialType:
externalizedContextWithReply:
_credentialTypeForEvent:
resetEvent:originator:reply:
authMethodWithReply:
acmContext
_applicationPasswordWasSet
_applicationPasswordCounter
_ctkPin
_acmContext
initWithMechanismManager:type:
weakToStrongObjectsMapTable
allObjects
_cleanupPlugins
setObject:forKey:
removeObjectForKey:
initWithCapacity:
numberWithInt:
setWithObject:
removeAllObjects
enumerateObjectsUsingBlock:
creationTime
laterDate:
contextPluginWithExternalizedContext:reply:
trackPlugin:processId:proxy:context:invalidationBlock:
_activePlugins
_mechanismForACMRequirement:acmContextRecord:policy:internalInfo:uiDelegate:originator:request:reply:
_loadACMMechanismFromPlugin:acmContextRecord:internalInfo:request:error:
arrayWithObjects:count:
mechanismWithK:ofSubmechanisms:serial:request:
bestEffortAvailableMechanismForRequest:error:
purpose
availabilityEventsForPurpose:
_restrictedNonUiMechanism:availabilityEvents:policy:internalInfo:request:
_buildUiForMechanism:policy:internalInfo:uiDelegate:originator:error:
loadMechanism:initParams:request:className:error:
initWithNonUiMechanism:eventProcessing:policy:internalInfo:
requiresUiWithEventProcessing:
findMechanismWithEventIdentifier:
mechanismForApplicationPasswordMode:acmContextRecord:options:internalInfo:uiDelegate:originator:request:reply:
cachedExternalizationDelegate
request
initWithEventIdentifier:remoteViewController:cachedExternalizationDelegate:request:
setParent:
eventIdentifier
isAND
runWithHints:eventsDelegate:reply:
_runSilentWithHints:eventsDelegate:reply:
_startUiWithHints:eventsDelegate:reply:
succeedAuthenticationWithResult:
failAuthenticationWithError:
initWithBackgroundMechanism:internalInfo:
show
dismiss
willFinish
_nonUiMechanism
_backgroundMechanism
_silentMechanism
_eventProcessing
_internalInfo
_isKofNAnd
_previousResult
initWithDelegate:
internalInfo
takeAssertionWithIdentifier:reason:flags:timeoutSeconds:timeoutBlock:
backgroundMechanism
holdAssertionUntilFinished:
setDismissable:
setDisplaysWhileLocked:
showPromptWithSettings:failureHandler:
cancelPrompt
cancelAuthentication
secureDataWithString:
externalizedACMContext
verifyPasswordUsingAKS:acmContext:userId:policy:options:
numberWithBool:
noResponseEventWithParams:
passcodePromptWasDismissed:
passcodePrompt:didProvidePasscode:
passcodePromptDidBailForUserHasAlphanumericPasscode:
_passcodePrompt
externalizedContext
_externalizedACMContext
OwnerInfo
OwnerInfos
ManagedACMParameter
ContextPluginACM
ModuleACM
MechanismManagerACM
MechanismUI
PasscodeUI
CSLSPasscodePromptDelegate
UIBase
@36@0:8i16@20@?28
i16@0:8
@?16@0:8
@16@0:8
v16@0:8
@32@0:8@16@24
v24@0:8@16
Q20@0:8i16
@"NSMutableArray"
@20@0:8I16
@36@0:8I16^v20Q28
^{?=I^vI}16@0:8
@"NSMutableData"
^{?=I^vI}
@36@0:8^{__ACMHandle=}16B24@28
I16@0:8
*24@0:8q16
@32@0:8q16I24B28
v64@0:8q16@24@32@40@48@?56
v88@0:8r^{__ACMRequirement=}16q24@32@40@48@56@64@72@?80
@24@0:8^{__ACMRequirement=}16
v104@0:8q16@24@32@40@48@56@64@72@80@88@?96
@24@0:8@16
v72@0:8@16@24@32@40@48@56@?64
v88@0:8@16@24@32@40@48@56@64@72@?80
@48@0:8@16@24@32^@40
v92@0:8@16@24@32@40@48@56B64@68@76@?84
@32@0:8@16^@24
B24@0:8@16
v80@0:8@16@24@32@40@48@56@64@?72
B80@0:8q16@24@32@40@48@56@64@?72
v40@0:8q16@24@?32
v56@0:8@16q24@32@40@?48
v40@0:8q16q24@?32
I24@0:8q16
v24@0:8@?16
^{__ACMHandle=}16@0:8
@"NSData"
^{__ACMHandle=}
v32@0:8@16@?24
v52@0:8@16i24@28@36@?44
@"NSMapTable"
v80@0:8r^{__ACMRequirement=}16@24q32@40@48@56@64@?72
v80@0:8q16@24@32@40@48@56@64@?72
@64@0:8@16q24@32@40@48^@56
@56@0:8@16^@24q32@40@48
@56@0:8q16@24@32@40^@48
@48@0:8@16@24q32@40
v40@0:8@16@24@?32
@24@0:8q16
@"MechanismBase"
@"NSDictionary"
@"UIBase"
v32@0:8@16@24
v24@0:8@"CSLSPasscodePrompt"16
v32@0:8@"CSLSPasscodePrompt"16@"NSString"24
@"CSLSPasscodePrompt"
Ti,R,N,V_pid
invalidationBlock
T@?,R,N,V_invalidationBlock
proxy
T@,R,W,N,V_proxy
allInfos
T@"NSArray",R,N,V_allInfos
context
T@,R,W,N,V_context
acmParameter
T^{?=I^vI},R,N,V_acmParameter
DeviceOwnerAuthentication
TouchIdEnrollment
Stockholm
Oslo
OsloPIN
Result
v24@?0@"NSDictionary"8@"NSError"16
Can't find ACM policy for: %@
v32@?0@"NSNumber"8@"NSNumber"16^B24
v32@?0@"NSDictionary"8@"NSDictionary"16@"NSError"24
v32@?0@"MechanismBase"8@"NSDictionary"16@"NSError"24
v16@?0r^{__ACMRequirement=}8
%d:%d
com.apple.private.LocalAuthentication.CallerPID
com.apple.private.LocalAuthentication.CallerName
Invalid operation: %@
Invalid ACL: '%@'
v20@?0B8@"NSError"12
@"NSDictionary"16@?0@"NSError"8
v8@?0
v32@?0@8@16^B24
resu
com.apple.private.CoreAuthentication.SPI
Credential not set
Unsupported credential type
simulated ACM context
acmContext
T^{__ACMHandle=},R,N,V_acmContext
v24@?0@"ContextPlugin"8^B16
v32@?0@"ContextPlugin"8Q16^B24
PasswordMode
AcmContextRecord
UserId
MechanismPassword
Options
Unexpected mechanism class: %@
-[MechanismUI runWithHints:eventsDelegate:reply:]
UI not supported for %@
-[MechanismUI willFinish]
com.apple.LocalAuthentication
MechanismUI
Policy
com.apple.LocalAuthentication.PasscodeUI
v16@?0@"NSError"8
Passcode verification failed: %@
Alphanumeric passcode
PasscodeUI
backgroundMechanism
T@"MechanismBase",R,N,V_backgroundMechanism
externalizedACMContext
T@"NSData",R,N,V_externalizedACMContext
internalInfo
T@"NSDictionary",R,N,V_internalInfo
osgn
handle
/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager_ClientLibs_Sim/AppleCredentialManager-404/common/LibSerialization.c
outSize
policyLength <= 128
err == kACMErrorSuccess
(parameters && parametersCount) || (!parameters && !parametersCount)
parametersCount <= 10
outBuffer
*outSize >= requiredSize
buffer
preflight
maxGlobalCredentialAge
parameters
parametersCount
(size - offset) >= sizeof(ACMHandle)
(policyLength <= 128)
(size - offset) >= (policyLength + 1)
policy
(size - offset) >= sizeof(uint8_t)
(size - offset) >= sizeof(uint32_t)
paramsCount <= 10
params
(size - offset) >= sizeof(ACMParameterType) + sizeof(uint32_t)
(size - offset) >= params[i].parameterDataLength
params[i].parameterData
aclConstraint
__os_warn_unused(__builtin_add_overflow((dynamicLength), (aclConstraintLength), (&dynamicLength))) == 0 
__os_warn_unused(__builtin_add_overflow((dynamicLength), (parametersLength), (&dynamicLength))) == 0 
__os_warn_unused(__builtin_add_overflow((dynamicLength), (operationLength), (&dynamicLength))) == 0 
aclConstraintLength
constraint
(size - offset) >= constraintLength
(size - offset) >= opLength
sizeof(ACMHandle) + sizeof(uint64_t) + sizeof(uint32_t) + operationLength + sizeof(uint32_t) + sizeof(uint32_t) > operationLength && sizeof(ACMHandle) + sizeof(uint64_t) + aclLength + sizeof(uint32_t) + operationLength + sizeof(uint32_t) + sizeof(uint32_t) > aclLength && sizeof(ACMHandle) + sizeof(uint64_t) + aclLength + sizeof(uint32_t) + operationLength + sizeof(uint32_t) + sizeof(uint32_t) + parametersLength > parametersLength
aclLength
operation
operationLength
tmpAcl
(size - offset) >= tmpAclLength
(size - offset) >= opLen
bufferSize
reqLen <= *bufferSize
size >= sizeof(ACMRequirement)
consumedBytes
size >= reqSize
reqSize > offset || ((ACMRequirementDataAnd *)(inReq->data))->subrequirementsCount == 0
reqSize > offset || ((ACMRequirementDataKofN *)(inReq->data))->subrequirementsCount == 0
credLen <= *outSize
size >= sizeof(ACMCredential)
dataLength == 0
dataLength == sizeof(ACMCredentialDataPassphraseExtractable)
dataLength == sizeof(ACMCredentialDataPassphraseEntered)
dataLength == sizeof(ACMCredentialDataUserOutputDisplayed)
dataLength == sizeof(ACMCredentialDataBiometryMatched)
dataLength == sizeof(ACMCredentialDataPasscodeValidated)
dataLength == sizeof(ACMCredentialDataPasscodeValidated2)
dataLength == sizeof(ACMCredentialDataContinuityUnlock)
dataLength == sizeof(ACMCredentialDataKextDenyList)
dataLength == sizeof(ACMCredentialDataSecureIntent)
size >= credSize
copy
credential1
credential2
equal
handle || scope == kACMScopeGlobal
size >= sizeof(ACMHandle) + sizeof(ACMCredential) + sizeof(ACMScope)
scope
size - offset >= sizeof(ACMScope)
buffer && type
credentialList || (count == 0)
credentialList[i]
credentialList
count
credCount <= 1000
list
property
(size - offset) >= sizeof(ACMContextProperty)
size >= sizeof(ACMHandle)
credentialType
credentialProperty
size >= sizeof(ACMHandle) + sizeof(ACMCredentialType) + sizeof(ACMCredentialProperty)
size >= requiredSize
size >= sizeof(ACMHandle) + sizeof(ACMCredentialType) + sizeof(ACMScope)
dataType != kACMContextDataTypeUnknown
handle && dataType && data && dataSize
size >= sizeof(ACMHandle) + sizeof(ACMContextDataType) + sizeof(uint32_t)
offset + *dataSize <= size
handle && dataType && getSizeOnly
paramsLength
parametersLength + param->parameterDataLength > parametersLength
param
!param->parameterDataLength
param->parameterDataLength == sizeof(int32_t)
param->parameterDataLength == 16
param->parameterDataLength && (param->parameterDataLength <= 1000)
param->parameterDataLength == sizeof(uid_t)
/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager_ClientLibs_Sim/AppleCredentialManager-404/common/LibCallBlock.c
processAuthMethod
LibCall_ACMKernelControl_Block
LibCall_ACMGlobalContextCredentialGetProperty_Block
processVariable
LibCall_ACMGetEnvironmentVariable_Block
processState
LibCall_ACMTRMLoadState_Block
ACMLib
ACMContextCreate
ACMContextCreateWithExternalForm
ACMContextDelete
destroyed
deleted
ACMContextGetExternalForm
/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager_ClientLibs_Sim/AppleCredentialManager-404/ACMLib/ACMLib.c
processExternalForm
err == 0 
ACMContextAddCredential
ACMContextRemoveCredentialsByType
ACMContextRemoveCredentialsByValue
ACMContextContainsCredentialType
ACMContextAddCredentialWithScope
context || scope == kACMScopeGlobal
credential
ACMGlobalContextAddCredential
ACMContextRemoveCredentialsByTypeAndScope
ACMGlobalContextRemoveCredentialsByType
ACMContextRemoveCredentialsByValueAndScope
ACMContextRemovePassphraseCredentialsByPurposeAndScope
ACMContextReplacePassphraseCredentialsWithScope
ACMContextContainsCredentialTypeEx
ACMContextContainsPassphraseCredentialWithPurpose
ACMContextVerifyPolicy
policyId
processRequirement
ACMContextVerifyPolicyWithPreflight
ACMContextVerifyPolicyEx
ACMGlobalContextVerifyPolicy
ACMParseAclAndCopyConstraintCharacteristics
acl && aclLength
processConstraintCharacteristics
ACMCredentialGetProperty
processProperty
ACMRequirementGetSubrequirements
requirement
processSubrequirement
ACMRequirementGetProperty
ACMRequirementGetProperties
ACMGetAclAuthMethod
ACMSetEnvironmentVariable
ACMSetEnvironmentVariableWithAccessPolicy
ACMGetEnvironmentVariable
ACMKernelControl
ACMGlobalContextCredentialGetProperty
ACMContextCredentialGetProperty
ACMContextSetData
ACMContextAppendData
ACMContextGetData
resultBuffer
ACMContextGetInfo
init
verifyPolicyInternal
policySatisfied
ACMContextVerifyAclConstraintForOperationCommand
aclConstraint && aclConstraintLength
verifyAclConstraintInternal
ioKitTransport
hints
!dataSize || data
/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager_ClientLibs_Sim/AppleCredentialManager-404/common/LibCall.c
commandSize
__os_warn_unused(__builtin_add_overflow((sizeof(acm_command_t)), (dataSize), (&cmdSize))) == 0 
cmd = (acm_command_t *)custom_malloc(cmdSize)
transport
handleWithPayload
err != kACMErrorBadParameter
fallback
responseSize == sizeof(response)
responseSize == sizeof(response.body)
%s: %s: returning, err = %ld.
LibCall_ACMContextCreate
externalForm
dataLength == sizeof(ACMHandle)
response.body.found
context not found
LibCall_ACMContextCreateWithExternalForm
LibCall_ACMContextDelete
inputBuffer
LibCall_ACMContexAddCredentialWithScope
LibCall_ACMContexRemoveCredentialsByTypeAndScope
( (parametersCount > 0 && parameters != ((void*)0)) || ((parametersCount == 0) && parameters == ((void*)0)) )
reqBuffer
reqBufferSize >= sizeof(uint32_t)
LibCall_ACMContextVerifyPolicyAndCopyRequirementEx
LibCall_ACMRequirementDelete
(data && dataLength && dataLength <= 256) || (!data && !dataLength)
LibCall_ACMKernelControl
commandCursor == commandBuffer + sizeof(commandBuffer)
cred
(data && dataLength) || (!data && !dataLength)
dataLength == 16
dataLength == sizeof(uint32_t)
dataLength == sizeof(int32_t)
credential->type == kACMCredentialTypePassphraseEntered
dataLength <= 128
dataLength == sizeof(ACMPassphrasePurpose)
credential->type == kACMCredentialTypePassphraseExtractable
credential->type == kACMCredentialTypeBiometryMatched
dataLength == 32
dataLength == sizeof(credData->accPubKey)
dataLength == sizeof(uid_t)
credential->type == kACMCredentialTypeUserOutputDisplayed
dataLength == 24
credential->type == kACMCredentialTypePasscodeValidated2
dataLength == sizeof(uuid_t)
credential->type == kACMCredentialTypeKextDenyListApplePay || credential->type == kACMCredentialTypeKextDenyListFairPlay
dataLength == sizeof(ACMKextDenyListFormat)
dataLength == sizeof(ACMKextDenyListRevision)
credential->type == kACMCredentialTypeSecureIntent
dataLength == sizeof(credData->accUUID)
data
length
dataLength
requirement->type == kACMCredentialTypePassphraseEntered
requirement->type == kACMRequirementTypeBiometryMatched
requirement->type == kACMRequirementTypeKofN
requirement->type == kACMRequirementTypeUserOutputDisplayed
LibCall_ACMPing
LibCall_ACMKernDoubleClickNotify
data && dataLength
commandSize == sizeof(commandBuffer)
LibCall_ACMContextCredentialGetProperty
LibCall_ACMGlobalContextCredentialGetProperty
dataOutBuffer && dataInOutLength
LibCall_ACMGetEnvironmentVariable
(keybagUuid && keybagUuidLength == 16) || (!keybagUuid && !keybagUuidLength)
(data && dataLength && dataLength <= 64) || (!data && !dataLength)
LibCall_ACMSetEnvironmentVariable
stateOutBuffer && stateInOutSize
LibCall_ACMTRMLoadState
(state && stateSize && stateSize <= 1024) || (!state && !stateSize)
LibCall_ACMTRMSaveState
(inData && inSize) || (!inData && !inSize)
inSize <= (3*1024 + 512)
commandBuffer
LibCall_ACMContextSetData
LibCall_ACMContextAppendData
outBuffer && outSize
LibCall_ACMContextGetData
!accUUIDsSize || accUUIDs
accUUIDsSize <= (16 * 16)
accUUIDsSize % sizeof(uuid_t) == 0
LibCall_ACMPublishTrustedAccessories
transport && context && value
responseBufferSize >= sizeof(Response)
response->version >= kCmdCurrentVersion_ContextGetInfo
LibCall_ACMContextGetInfo
Will specify uid %u using ACM parameter
Will specify time offset %u using ACM parameter
deleting ACMContext:%u (destroy:%d)
ACMContextDelete failed: %d
No known ACM policy for LAPolicy %d
%{public}@ evaluates operation: %{public}@
%{public}@ validates operation: %{public}@
resetEvent:%d
Exceeded number of allocated contexts, will invalidate a context in the process that hoarded the most.
Greediest PID: %d holds %d unique contexts.
Will invalidate %{public}@ which is the oldest context created at %{public}@ and having the least references from other processes (%d).
Invalidating %{public}@ of PID %d
nonUiMechanism: %{public}@
availableNonUiMechanism: %{public}@
restrictedNonUiMechanism: %{public}@
uiMechanism: %{public}@ nonUiMechanism: %{public}@
%s %{public}@, %{public}@, KofNAnd: %d on %@
%s  on %@
backlight assertion timed out
%s: %s: called.
%s: %s: CS[%u] created.
%s: %s: returning, err = %ld.
%s: %s: CS[%u] acquired.
%s: %s: returning, -> ctx = %p.
%s: %s: CS[%u] %s.
%s: %s: returning.
%s: %s: returning, err = %ld, var=%u.
%s: %s: returning, err = %ld, code=%u.
%s: AssertMacros: %s (value: 0x%lx), %s, file: %s:%d
zPLR
zPLR
