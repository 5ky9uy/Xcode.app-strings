init
stringWithFormat:
UTF8String
dealloc
objectForKey:
removeObjectForKey:
objectForKeyedSubscript:
initWithDescription:
initWithIdentifier:timeout:
setObject:forKeyedSubscript:
objectEnumerator
countByEnumeratingWithState:objects:count:
copy
cancelWorkForKey:
scheduleWorkForKey:afterDelay:work:
cancel
flush
_lock
_queue
_requests
defaultStore
initWithAccountStore:
mailAccounts
boolValue
future
isTimeoutError:
addFailureBlock:
arrayWithObjects:count:
completionHandlerAdapter
accountValuesForKeys:completionBlock:
resultWithTimeout:error:
accountProperties
rawAddressFromFullAddress:
addObject:
receivedEmailAddressesFromAccount:
allObjects
allKeys
enumerateEmailAddresses:
emailAddressesForAccount:
.cxx_destruct
_accountStore
stop
start
mainRunLoop
defaultPath
initWithPath:
sharedMonitor
isLocked
_adjustLibraryStoreSyncBehaviorWithLockedState:
defaultCenter
_lockStateChanged:
addObserver:selector:name:object:
_executeAfterFirstUnlock:
removeObserver:
initWithConnection:library:
initWithClient:
clientForConnection:
clientMayConnect:
weakReferenceWithObject:
daemonLibraryForClient:
XPCInterface
setExportedInterface:
setExportedObject:
object
removeObject:
setInvalidationHandler:
setInterruptionHandler:
resume
hasEntitlement:
setStoreSyncDelay:
synchronize
userInfo
initWithMachServiceName:
setDelegate:
invalidate
closeDatabaseConnections
isEqual:
class
self
performSelector:
performSelector:withObject:
performSelector:withObject:withObject:
isProxy
isKindOfClass:
isMemberOfClass:
conformsToProtocol:
respondsToSelector:
retain
release
autorelease
retainCount
zone
hash
superclass
description
debugDescription
TQ,R
T#,R
T@"NSString",R,C
listener:shouldAcceptNewConnection:
_listener
_library
_libraryAvailable
_startupQueue
_clients
initWithConnection:forWriting:
wrapperWithConnection:forWriting:
incrementRefcount
decrementRefcount
writer
setWriter:
connection
setConnection:
_refcount
_writer
_connection
T@"CRSQLiteConnection",&,N,V_connection
TB,N,V_writer
defaultManager
initWithFormat:
fileExistsAtPath:
dictionaryWithObjects:forKeys:count:
initWithPath:accountAdaptor:
initWithDelegate:
migrateMailEmbeddedLibraryToPath:
defaultPluginPath
initWithDelegate:maxConcurrentReaders:
setCacheSize:
setMaximumRecentsAgeInDays:forRecentsDomain:
performExpungeRecentsOverLimitsForDomain:afterDelay:
storeMapping
_initializeStoreForRecentsDomain:storeIdentifier:
coordinateChangesInUbiquitousStoreForDomain:
enumerateKeysAndObjectsUsingBlock:
_synchronizeAllStores
initWithPath:databaseName:
open
_handleSQLiteErrorCode:
migrateWithSQLiteConnection:
close
_handleCorruptDatabase
needsRebuild
mergeCloudDataOneWayIntoLocalStoreWithReason:
stringByAppendingPathComponent:
renameOrRemoveDatabase
_handleFullDatabase
_handleIOError
_handleBusyError
currentThread
threadDictionary
setObject:forKey:
beginTransactionWithType:
handleSqliteError:format:
commitTransaction
rollbackTransaction
_activeConnectionWrapper
checkInConnection:
_setActiveConnection:forWriting:
writerConnection
readerConnection
_connectionForWriting:
beginTransaction:withType:
commitTransaction:
rollbackTransaction:
unlockConnection:
_performTransaction:forWriting:
rowWithStatement:
numberWithIntegerAtIndex:
cr_CRRecentIDValue
cr_CRContactIDValue
stringAtIndex:
numberWithDoubleAtIndex:
cr_CRContactGroupKindValue
arrayWithCapacity:
scannerWithString:
isAtEnd
scanLongLong:
scanString:intoString:
initWithContactID:
setRecentID:
setKind:
setRawAddress:
externalAddressFromAddress:kind:
setAddress:
setRecentsDomain:
setDisplayName:
setGroupName:
setRecentDates:
setLastSendingAddress:
setOriginalSource:
setWeight:
setGroupKind:
numberWithLongLong:
populateMetadataForRecents:
array
cr_predicateClauseWithBindings:error:
cr_addNonNilObject:
domainClauseWithDomains:bindings:
count
componentsJoinedByString:
bindingForDomain:
predicate
domains
implicitGroupThreshold
options
errorWithDomain:code:userInfo:
isUsingiCloud
_whereClauseFromPredicate:inDomains:bindings:error:
preparedStatementForPattern:
copyContactRecentsFromStatement:selectIndexes:groupThreshold:options:
pageRange
_cn_skip:
_cn_take:
performReadTransaction:
stringWithString:
appendString:
longLongValue
setMetadata:
dictionary
objectAtIndex:
enumerateRowsInStatement:usingBlock:
objectAtIndex:statement:
copyRecentContactFromStatement:columnIndexes:populateMetadata:
recentID
arrayWithObject:
senderEmailAddresses
groupKind
recentDates
upcomingEventIdentifierForRecentID:
indexSet
kind
isEqualToString:
address
containsObject:
addIndex:
removeObjectsAtIndexes:
groupName
recentsDomain
initWithMembers:displayName:recentDate:recentsDomain:
allValues
hashesForGroupMembers:recentsDomain:
hashForGroupMemberHashes:
recentsHashForExternalAddress:kind:
cr_insertObject:usingComparator:
firstObject
dataUsingEncoding:
cr_md5DigestHexString
stringByAppendingString:
setWithCapacity:
integerValue
_copyRecentContactForID:
hashForContact:
isGroup
_deleteRecentsWithRecentIDs:storeKeys:recentsDomain:deleteInUbiquitousStore:
_storeForRecentsDomain:
_synchronizeStore:
removeLocalRecordsForDomain:removeInUbiquitousStore:
performWriteTransaction:
lock
unlock
_databasePropertyValueByKey:
_setDatabasePropertyValue:forKey:
_propertyValueForKey:defaultValue:
_setPropertyValue:forKey:
expungeRecentsOverLimitsForDomain:forcibly:expungedRecentIDs:
intValue
cancelPerformExpungeRecentsOverLimitsForDomain:
maximumRecentsForDomain:
maximumGroupRecentsForDomain:
maximumRecentsAgeInDaysForDomain:
date
currentCalendar
setDay:
dateByAddingComponents:toDate:options:
_nts_expungeRecentsOlderThanDate:domain:storeKeys:connection:
addObjectsFromArray:
_nts_expungeGroupRecentsOverLimit:domain:storeKeys:connection:
_nts_expungeIndividualRecentsOverLimit:domain:storeKeys:connection:
dictionaryRepresentation
initWithArray:
hasPrefix:
countOfRecents
displayName
originalSource
mostRecentDate
weight
string
length
appendFormat:
lastSendingAddress
addressFromExternalAddress:kind:
_bindRecent:forStatement:
members
nextObject
_bindContact:withRecentID:forStatement:
metadata
contactID
_insertRecentContacts:
_updateRecentContacts:
cr_map:
_copyRecentContactForRecordHash:recentsDomain:
unsignedIntegerValue
lastObject
mutableCopy
arrayByAddingObjectsFromArray:
hashForGroupMembers:recentsDomain:
applyWeight:
recordRecentEventForDate:userInitiated:
objectAtIndexedSubscript:
initWithAddress:displayName:kind:recentDate:recentsDomain:
dictionaryWithCapacity:
makeObjectsPerformSelector:withObject:
_saveRecentContacts:
_syncContact:withStore:
scheduleSynchronizationForStore:
_deleteRecentWithRecordHash:kind:recentsDomain:
addressHandlerForAddressKind:
syncKeyForAddress:kind:
hashForGroup:
cr_insertionSortedArrayUsingComparator:
_initWithStoreIdentifier:usingEndToEndEncryption:
_storeChangedExternally:
_recentsDomainForStore:
ubiquitousStoreForDomainChangedAccount:
null
setMaximumRecents:forRecentsDomain:
dictionaryForKey:
_mergeRemoteChanges:fromStore:forRecentsDomain:
keyForContact:
enumerateRecentsForDomain:usingBlock:
numberWithUnsignedInteger:
setDictionary:forKey:
substringFromIndex:
compare:
indexOfObject:inSortedRange:options:usingComparator:
insertObject:atIndex:
distantPast
subarrayWithRange:
isSyncingDisabledForAccountWithAddress:
dictionaryWithDictionary:
dictionaryWithObjectsAndKeys:
setDomains:
setImplicitGroupThreshold:
copyRecentsForQuery:error:
removeRecentContactsWithRecentIDs:syncKeys:domain:removeInUbiquitousStore:
notificationWithName:object:userInfo:
postNotification:
newConnectionForConnectionPool:
recentsHashForAddress:kind:
removeAllRecentContactsWithCompletion:
setMaximumGroupRecents:forRecentsDomain:
recordContactEvents:recentsDomain:sendingAddress:source:
removeContact:
storeSyncDelay
cloudStores
setCloudStores:
ubiquitousCoordinator
setUbiquitousCoordinator:
_path
_pluginManager
_connectionPool
_migrator
_accountAdaptor
_cachedProperties
_pendingDomainExpunges
_pendingStoreSyncEvents
_storeSyncDelay
_cloudStores
_ubiquitousCoordinator
T@"NSMutableDictionary",&,N,V_cloudStores
T@"CRUbiquitousCoordinator",&,N,V_ubiquitousCoordinator
Td,N,V_storeSyncDelay
dateWithTimeIntervalSince1970:
arrayByAddingObject:
setMembers:
doubleValue
timeIntervalSinceReferenceDate
dataWithPropertyList:format:options:error:
bytes
currentHandler
stringWithUTF8String:
handleFailureInFunction:file:lineNumber:description:
predicateWithBlock:
filteredArrayUsingPredicate:
sortedArrayUsingFunction:context:
initWithCapacity:
timeIntervalSinceDate:
timeIntervalSinceNow
removeObjectAtIndex:
transactionWithDescription:
_transaction
migrateWithSQLiteConnection:toVersion:
isOpen
noteNeedsRebuild
migrateLibraryFilesFrom:to:
containsString:
moveItemAtPath:toPath:error:
code
domain
versionOfDatabase:
setVersion:ofDatabase:
executeSQL:database:
_delegate
_needsRebuild
bundleForClass:
URLForResource:withExtension:
stringWithContentsOfURL:encoding:error:
auditToken
auditToken:
bundleIdentifierForAuditToken:
bundleIdentifier
library
T@"NSXPCConnection",R,N,V_connection
T@"_CRRecentsLibrary",R,N,V_library
T@"NSString",R,N
os_log
uuid
defaultProvider
timestamp
stringForTimeInterval:
searchRecentsUsingQuery:completion:
recordContactEvents:domain:sendingAddress:source:completion:
removeRecentContactsWithRecentIDs:syncKeys:domain:
_remoteLibraryWithErrorHandler:
_client
_vfsModuleName
connectionToNewInMemoryStore
beginTransaction
_statementCache
_ICUSearchContext
_CRSearchContext
_CRPhoneSearchContext
_transactionType
_transactionCount
_log
T^{sqlite3=},R,N,V_db
_loadPlugins
contentsOfDirectoryAtPath:error:
pathExtension
caseInsensitiveCompare:
bundleWithPath:
_loadPluginBundle:
loadAndReturnError:
principalClass
supportedAddressKinds
addressHandlerWithPrincipalClass:
_addAddressHandler:
setWithSet:
setWithArray:
intersectSet:
addressHandlers
_addressHandlersByKind
currentLocale
initWithLocale:
normalizeAddress:
objectForKey:onCacheMiss:
isEqualToNumber:
numberWithBool:
stringByFoldingWithOptions:locale:
addAddress:isRestricted:
isAddressRestricted:
allAddresses
_cache
_locale
_updateLockStateWithToken:
postNotificationName:object:userInfo:
_lockNotifyToken
_lockState
locked
TB,R,N,GisLocked
_powerAssertion
_setCloudStoreState:forDomain:
_cloudStoreStateForDomain:
_setCloudStoreStateForAllDomains:
_removeLocalRecordsForAllDomains
_removeLocalRecordsForCloudStoresWithDataFromPreviousAccount
_allDomains
accountAdaptor:observediCloudAccountTransition:
_cloudStoreStates
anyObject
initWithConnection:generation:
setIsWriter:
isWriter
generation
cacheSize
maxConcurrentReaders
maxConcurrentWriters
readersWaiting
writersWaiting
delegate
_cacheLock
_cacheSize
_cacheGeneration
_maxConcurrentReaders
_maxConcurrentWriters
_checkoutLock
_checkoutMap
_readerSemaphore
_readersWaiting
_writerSemaphore
_writersWaiting
T@"<CRSQLiteConnectionPoolDelegate>",V_delegate
_generation
_isWriter
T@"CRSQLiteConnection",R,N,V_connection
TQ,R,N,V_generation
TB,N,V_isWriter
step:
removeAllObjects
initWithBytesNoCopy:length:freeWhenDone:
initWithSearchString:
dataWithData:
setLastPhoneSearch:
copySearcherForPattern:
lastPhoneSearch
_lastSearchString
_lastSearchStringLength
_lastPhoneSearch
T@"CRPhoneSearch",&,N,V_lastPhoneSearch
matchesUTF8String:matchType:
stringByDeletingLastPathComponent
lastPathComponent
cr_uniqueFilenameWithRespectToFilenames:
fileSystemRepresentation
initWithSearchString:options:
arrayWithObjects:
dictionaryWithObject:forKey:
expressionType
collection
cr_expressionValue
arrayByApplyingSelector:
variable
handleFailureInMethod:object:file:lineNumber:description:
cr_sqlBindings
constantValue
objCType
keyPath
cr_simplifiedPredicateSingleStep
setHadError:
doesNotRecognizeSelector:
componentsSeparatedByString:
cr_simplifiedPredicate
cr_processWithContext:
cr_addToClause:usingOperator:bindings:
cr_isInvalidOperatorType:forKeyPath:
hadError
clauseWithBindings:
subpredicates
compoundPredicateType
notPredicateWithSubpredicate:
initWithType:subpredicates:
cr_mergeSubcontext:intoContext:
wantsGroups
setWantsGroups:
kindPredicates
setKindPredicates:
predicates
initWithObjects:
predicateOperatorType
customSelector
cr_isInvalidComparisonPredicate
leftExpression
rightExpression
comparisonPredicateModifier
addPredicate:forFieldName:
tokenSearch:
prefixSearch:
phoneSearch:
cr_sqlNameForFieldName:
expressionForKeyPath:
expressionForConstantValue:
predicateWithLeftExpression:rightExpression:modifier:type:options:
kindClauseWithBindings:
setPredicates:
_predicateCollectionsMap
_hadError
_wantsGroups
_kindPredicates
_predicates
TB,N,V_hadError
TB,N,V_wantsGroups
T@"NSMutableArray",&,N,V_kindPredicates
T@"NSMutableArray",&,N,V_predicates
lowercaseString
copyCountryCode
copyNormalizedPhoneNumber:countryCode:
_copyInterpretationsForPhoneNumber:
reverseObjectEnumerator
initWithBytesNoCopy:length:encoding:freeWhenDone:
isEqualToPhoneNumber:
_countryCode
_searchString
initForAddressHandler:
identityForAddressHandler:
setSupportedAddressKinds:
_className
_supportedAddressKinds
T@"NSSet",C,N,V_supportedAddressKinds
initWithPrincipalClass:
initWithAddressHandler:
identity
setIdentity:
_handler
_identity
T@"CRAddressHandlerIdentity",&,N,V_identity
standardUserDefaults
initWithUserDefaults:accountStore:delegate:
stringForKey:
boolForKey:
_resetCachedAccountInfo
mailAccountListenerWithHandler:
_delegateAccountChanges
appleAccountListenerForStore:withHandler:
_runWithAnalyzerLock:
_analyzeMailAccounts
aa_primaryAppleAccount
aa_personID
_primaryiCloudAccountPersonID
setBool:forKey:
refresh
_analyzer
_mailAccountListener
_appleAccountListener
_userDefaults
_iCloudAccountPersonID
_iCloudAccountWasLoggedIn
T@"<CRAccountAdaptorDelegate>",N,V_delegate
matchesASCIIString:matchType:
matchesUTF8String:
dataWithLength:
mutableBytes
whitespaceCharacterSet
componentsSeparatedByCharactersInSet:
initWithSearchString:andLocale:andOptions:
matches:
matches:matchType:
initWithSearchString:andLocale:
_options
_components
_asciiComponents
_wholeSearchStringData
_context
initWithObject:
_weakRef
_makeObservableForMailAccount
observerWithResultBlock:
subscribe:
_makeObservableForAccountStore:
observableOnDefaultNotificationCenterWithName:object:
tokenWithCancelationBlock:
observableWithBlock:
observerDidReceiveResult:
com.apple.corerecents.delayedWork.%p
com.apple.corerecents.delayedWork-%p-%@
v8@?0
defaultAddress
ReceiveEmailAliasAddresses
v16@?0@"NSError"8
failed to get account information after 10 seconds
Error loading Mail account information: %@
com.apple.contacts.corerecents.agent.startup
com.apple.corerecents.launch
com.apple.private.corerecents
com.apple.private.contactsui
-[_CRRecentsSQLiteConnectionWrapper decrementRefcount]
_CRRecentsLibrary.m
_refcount > 0
%@/Library/Recents
com.apple.mail.recents
com.apple.eventkit.locations
com.apple.passbook.locations
v32@?0@"NSString"8@"NSString"16^B24
Recents
com.apple.corerecents.recentsLibrary.connection
recents: beginning transaction
recents: committing transaction
recents: rolling back transaction
-[_CRRecentsLibrary unlockConnection:]
[wrapper connection] == connection
-[_CRRecentsLibrary _connectionForWriting:]
nil != connection
[wrapper writer]
WHERE %@
 AND 
bundle_identifier IN (%@)
v20@?0^{sqlite3_stmt=}8i16
%@ %@
B16@?0@"CRSQLiteConnection"8
SELECT recent_id, key, value FROM metadata WHERE recent_id IN (?
) ORDER BY recent_id
v16@?0@"CRSQLRow"8
SELECT value FROM metadata WHERE recent_id = ? AND key = ?
v32@?0@"NSNumber"8@"NSMutableArray"16^B24
address
kind
 WHERE recents.record_hash = :record_hash AND recents.bundle_identifier = :bundle_identifier
:record_hash
:bundle_identifier
 WHERE recents.ROWID = :rowid
:rowid
 WHERE recents.bundle_identifier = :bundle_identifier
SELECT value FROM properties WHERE key = :key
:key
INSERT OR REPLACE INTO properties (key, value) VALUES (:key, :value)
:value
-[_CRRecentsLibrary setMaximumRecents:forRecentsDomain:]
maxRecents > 0
-[_CRRecentsLibrary setMaximumGroupRecents:forRecentsDomain:]
        SELECT recents.ROWID, recents.record_hash, recents.count 
        FROM recents 
        WHERE recents.bundle_identifier = :bundle_identifier 
        AND recents.last_date < :expunge_date     
:expunge_date
        SELECT recents.ROWID, recents.record_hash 
        FROM recents 
        WHERE recents.bundle_identifier = :bundle_identifier 
            AND recents.count = 1 
        ORDER BY recents.last_date DESC 
        LIMIT -1 
        OFFSET :offset     
:offset
        SELECT recents.ROWID, recents.record_hash 
        FROM recents 
        WHERE recents.bundle_identifier = :bundle_identifier 
            AND recents.count != 1 
        ORDER BY recents.last_date DESC 
        LIMIT -1 
        OFFSET :offset     
                    SELECT recents.record_hash, recents.count 
                    FROM recents 
                    WHERE recents.bundle_identifier = :bundle_identifier                 
-[_CRRecentsLibrary _bindRecent:forStatement:]
[recent countOfRecents] > 0 && "can't save recent contact without event dates"
:display_name
:original_source
:last_date
:weight
:group_kind
%@%lld
:dates
:sending_address
:recent_id
:kind
:address
INSERT INTO recents (display_name, bundle_identifier, original_source, dates, last_date, sending_address, count, weight, record_hash, group_kind)             VALUES (:display_name, :bundle_identifier, :original_source, :dates, :last_date, :sending_address, :count, :weight, :record_hash, :group_kind)
INSERT INTO contacts (recent_id, display_name, kind, address)             VALUES (:recent_id, :display_name, :kind, :address)
INSERT INTO metadata (recent_id, key, value) VALUES (:recent_id, :key, :value)
:count
v32@?0@8@16^B24
            UPDATE contacts             SET display_name = :display_name             WHERE ROWID = :recent_id         
            UPDATE recents             SET                 weight = COALESCE(MAX(weight, :weight), weight, :weight),                 display_name    = :display_name,                 dates           = :dates,                 last_date       = :last_date,                 sending_address = :sending_address,                 group_kind      = :group_kind             WHERE ROWID = :recent_id         
INSERT OR REPLACE INTO metadata (recent_id, key, value) VALUES (:recent_id, :key, :value)
-[_CRRecentsLibrary _deleteRecentWithRecordHash:kind:recentsDomain:]
recentsDomain
DELETE FROM recents WHERE recents.record_hash = :record_hash AND recents.bundle_identifier = :bundle_identifier
-[_CRRecentsLibrary _deleteRecentsWithRecentIDs:storeKeys:recentsDomain:deleteInUbiquitousStore:]
recentsDomain != nil
            DELETE FROM recents 
            WHERE recents.ROWID IN (%@) 
            AND recents.bundle_identifier = :bundle_identifier         
@"CRRecentContact"16@?0@"NSString"8
options
members
timestamp
displayName
metadata
weight
v24@?0@"CRRecentContact"8@"NSString"16
@"NSString"16@?0@"CRRecentContact"8
com.apple.corerecents.externalStoreChange
-[_CRRecentsLibrary _storeChangedExternally:]
MAX_RECENTS
v32@?0@"NSString"8@16^B24
v24@?0@"CRRecentContact"8^B16
q24@?0@"NSString"8@"NSString"16
v32@?0@"NSString"8@"NSDictionary"16^B24
v24@?0@8@"NSString"16
succeeded
failed
v32@?0@8@"NSUbiquitousKeyValueStore"16^B24
@16@?0@"CRRecentContact"8
SELECT recents.ROWID,
       recents.bundle_identifier,
       recents.dates,
       recents.display_name,
       recents.sending_address,
       recents.original_source,
       recents.weight,
       recents.group_kind,
       contacts.ROWID,
       contacts.kind,
       contacts.display_name,
       contacts.address
  FROM recents
  JOIN contacts ON contacts.recent_id = recents.ROWID
_maxRecentPropertyKeyForRecentsDomain
max-recent:
_maxGroupRecentPropertyKeyForRecentsDomain
max-group-recent:
_maxRecentAgePropertyKeyForRecentsDomain
max-recent-age:
void _bindData(sqlite3_stmt *, const char *, NSData *)
data length is more than INT_MAX
NSUbiquitousKeyValueStoreServerChange
NSUbiquitousKeyValueStoreInitialSyncChange
NSUbiquitousKeyValueStoreQuotaViolationChange
NSUbiquitousKeyValueStoreAccountChange
com.apple.corerecents.newDatabase
com.apple.corerecents.iCloudSignIn
com.apple.corerecents.iCloudSwitch
unknown change reason (%lu)
B24@?0@8@"NSDictionary"16
-[CRProcessTransaction init]
CRProcessTransaction.m
<%@:%p> %s
getting library version
Error: migration is not supported for version %d
VACUUM
%@/Library/Mail
/tmp/
New path looks like a temporary directory, skipping migration: %@
Recents-shm
Recents-wal
Failed to migrate %@ to %@. Error: %@
Error %d %@: %s
SELECT value FROM properties WHERE key = 'version'
INSERT OR REPLACE INTO properties (key, value) values ('version', ?)
setting library version
preparing library version insert statement
recents
Error loading SQL: %@
executing SQL from file: %@
_ExecuteSQL
CRRecentsMigrator.m
nil != sql
executing SQL statements
ALTER TABLE recents ADD COLUMN address_hash TEXT;
adding address_hash to recents table
DROP INDEX IF EXISTS recents_last_name; DROP INDEX IF EXISTS recents_first_name; ALTER TABLE recents ADD COLUMN display_name TEXT;
dropping indexes, adding display name columns
UPDATE recents SET display_name = NULLIF(IFNULL(first_name, '') || ' ' || IFNULL(last_name, ''), ' '), last_name = NULL, middle_name = NULL, first_name = NULL, suffix = NULL;
updating recents with display names
ALTER TABLE recents ADD COLUMN sending_address TEXT;
adding sending address column
DROP TABLE IF EXISTS new_recents;
CREATE TABLE new_recents (ROWID INTEGER PRIMARY KEY AUTOINCREMENT,
display_name TEXT,
bundle_identifier TEXT,
property INTEGER,
address TEXT,
address_hash TEXT,
sending_address TEXT,
dates TEXT NOT NULL,
last_date INTEGER,
UNIQUE (bundle_identifier, address_hash)
);INSERT INTO new_recents (bundle_identifier, display_name, property, address, address_hash, sending_address, dates, last_date)SELECT 'com.apple.mobilemail', display_name, property, address, address_hash, sending_address, dates, last_date FROM recents;DROP TABLE recents; ALTER TABLE new_recents RENAME TO recents;
migrating data to recents table with new contraints
CREATE INDEX recents_address_hash ON recents(bundle_identifier, address_hash, property);CREATE INDEX recents_expunge ON recents(bundle_identifier, last_date DESC);
adding new index
_migration_hash
registering hash function
DROP TABLE IF EXISTS new_recents;
CREATE TABLE new_recents (ROWID INTEGER PRIMARY KEY AUTOINCREMENT,
display_name TEXT,
bundle_identifier TEXT,
kind TEXT,
address TEXT,
address_hash TEXT NOT NULL,
sending_address TEXT,
dates TEXT NOT NULL,
last_date INTEGER,
UNIQUE (bundle_identifier, address_hash)
creating new_recents table with new constraints
DROP TABLE IF EXISTS recents; ALTER TABLE new_recents RENAME TO recents;CREATE INDEX recents_address_hash ON recents(bundle_identifier, address_hash, kind);CREATE INDEX recents_expunge ON recents(bundle_identifier, last_date DESC);
dropping old recents table, rename new_recents to recents, adding new indexes
unregistering hash function
__recentsHashFunction
SELECT bundle_identifier, display_name, CASE WHEN property = 4 THEN 'email' WHEN property = 3 THEN 'phone' END, address, _migration_hash(CASE WHEN property = 4 THEN 'email' WHEN property = 3 THEN 'phone' END, address), sending_address, dates, last_date FROM recents;
%s-%s
bundle_identifier
address_hash
dates
last_date
display_name
sending_address
INSERT INTO new_recents (bundle_identifier, display_name, kind, address, address_hash, sending_address, dates, last_date)VALUES (?, ?, ?, ?, ?, ?, ?, ?);
transferring recents to new_recents
DROP TABLE IF EXISTS new_recents;
DROP TABLE IF EXISTS contacts;
        CREATE TABLE new_recents (            ROWID INTEGER PRIMARY KEY AUTOINCREMENT,             display_name TEXT,             bundle_identifier TEXT,             sending_address TEXT,                         dates TEXT NOT NULL,             last_date INTEGER,                         count INTEGER         );                INSERT INTO new_recents (ROWID, display_name, bundle_identifier, sending_address, dates, last_date, count)         SELECT ROWID, display_name, bundle_identifier, sending_address, dates, last_date, 1 FROM recents;   CREATE TABLE contacts (             ROWID INTEGER PRIMARY KEY AUTOINCREMENT,                         recent_id INTEGER,                         display_name TEXT,             kind TEXT,             address TEXT,             address_hash TEXT NOT NULL,                         FOREIGN KEY (recent_id) REFERENCES new_recents (ROWID) ON DELETE CASCADE         );                 INSERT INTO contacts (recent_id, display_name, kind, address, address_hash)         SELECT ROWID, display_name, kind, address, address_hash FROM recents;                 DROP TABLE recents; ALTER TABLE new_recents RENAME TO recents;                 DROP INDEX IF EXISTS recents_address_hash;         DROP INDEX IF EXISTS recents_expunge;     
creating separate contacts and recents tables
            CREATE INDEX contacts_recentsidx ON contacts(recent_id);             CREATE INDEX contacts_address_hash ON contacts(address_hash, kind);             CREATE INDEX contacts_search ON contacts(display_name, address);                    CREATE INDEX recents_expunge ON recents(bundle_identifier, last_date DESC);         
adding new index for contacts table
DROP TABLE IF EXISTS metadata;
CREATE TABLE metadata (
    ROWID INTEGER PRIMARY KEY AUTOINCREMENT,
    recent_id INTEGER,
    key TEXT,
    value,
    FOREIGN KEY (recent_id) REFERENCES recents (ROWID) ON DELETE CASCADE,
    UNIQUE (recent_id, key)
DROP INDEX IF EXISTS contacts_search;
DROP INDEX IF EXISTS contacts_address;
DROP INDEX IF EXISTS metadata_recents;
CREATE INDEX metadata_recents ON metadata(recent_id);
CREATE INDEX contacts_address ON contacts(kind, display_name, address);
creating metadata tables and indexes
ALTER TABLE recents ADD COLUMN original_source TEXT;
adding original_source column
ALTER TABLE recents ADD COLUMN weight FLOAT;
adding weight column
0. Disable foreign key constraints.
PRAGMA foreign_keys = OFF;
1. Add record_hash column to recents
DROP TABLE IF EXISTS new_recents; 
CREATE TABLE new_recents ( 
   ROWID INTEGER PRIMARY KEY AUTOINCREMENT, 
   display_name TEXT, 
   bundle_identifier TEXT, 
   sending_address TEXT, 
   original_source TEXT, 
   dates TEXT NOT NULL, 
   last_date INTEGER, 
   weight FLOAT, 
   record_hash TEXT NOT NULL, 
   count INTEGER 
);INSERT INTO new_recents (ROWID, display_name, bundle_identifier, sending_address, 
                         original_source, dates, last_date, weight, count, record_hash) SELECT recents.ROWID, 
       recents.display_name, 
       recents.bundle_identifier, 
        recents.sending_address, 
        recents.original_source, 
        recents.dates, 
        recents.last_date, 
        recents.weight, 
        recents.count, 
        contacts.address_hash 
 FROM recents 
 INNER JOIN contacts 
         ON contacts.recent_id = recents.ROWID 
GROUP BY recents.ROWID;
2. Generate new hashes for each group
SELECT recents.ROWID, contacts.address_hash, contacts.kind FROM recents INNER JOIN contacts ON contacts.recent_id = recents.ROWID WHERE recents.count > 1
q24@?0@8@16
UPDATE new_recents SET record_hash = '%@' WHERE ROWID = %ld
3. Remove contacts' address_hash column
DROP TABLE IF EXISTS new_contacts; 
CREATE TABLE new_contacts ( 
    ROWID INTEGER PRIMARY KEY AUTOINCREMENT, 
    recent_id INTEGER, 
    display_name TEXT, 
    kind TEXT, 
     address TEXT, 
    FOREIGN KEY (recent_id) REFERENCES new_recents (ROWID) ON DELETE CASCADE 
);INSERT INTO new_contacts (ROWID, recent_id, display_name, kind, address) SELECT ROWID, recent_id, display_name, kind, address FROM contacts; 
DROP TABLE contacts; ALTER TABLE new_contacts RENAME TO contacts; 
DROP TABLE recents; ALTER TABLE new_recents RENAME TO recents; 
DROP INDEX IF EXISTS contacts_address_hash; 
DROP INDEX IF EXISTS recents_record_hash; 
DROP INDEX IF EXISTS recents_expunge; 
CREATE INDEX recents_record_hash ON recents(record_hash); 
CREATE INDEX recents_expunge ON recents(bundle_identifier, last_date DESC); 
4. Re-enable foreign key constraints.
PRAGMA foreign_keys = ON;
DROP INDEX IF EXISTS contacts_recentsidx;
DROP INDEX IF EXISTS contacts_address;
CREATE INDEX contacts_recentsidx ON contacts(recent_id);
CREATE INDEX contacts_address ON contacts(kind, display_name, address);
creating contacts indexes
ALTER TABLE recents ADD COLUMN group_kind INTEGER;
adding group kind column
DELETE FROM recents WHERE bundle_identifier='com.apple.eventkit.ios'
deleting pre-existing com.apple.eventkit.ios records
UPDATE recents SET bundle_identifier='com.apple.eventkit.ios' WHERE bundle_identifier='com.apple.reminders';
renaming iOS reminders domain
DELETE FROM contacts WHERE rowid IN (SELECT c.rowid FROM contacts c LEFT JOIN recents r ON (c.recent_id = r.rowid) WHERE r.rowid IS NULL)
deleting dangling contacts
DELETE FROM metadata WHERE rowid IN (SELECT m.rowid FROM metadata m LEFT JOIN recents r ON (m.recent_id = r.rowid) WHERE r.rowid IS NULL)
deleting dangling metadata
DELETE FROM recents WHERE bundle_identifier IN ('com.apple.MobileSMS', 'com.apple.messages')
deleting messages recents
com.apple.corerecents
daemon
:memory:
-[CRSQLiteConnection initWithPath:]
CRSQLiteConnection.m
NULL != path
com.apple.contacts.recentsd
statement-cache
-[CRSQLiteConnection initWithPath:databaseName:]
NULL != databaseName
-[CRSQLiteConnection dealloc]
NULL == _db
-[CRSQLiteConnection open]
enabling extended error codes
icusearch
creating custom icusearch function
cpsearch
creating custom cpsearch function
phonesearch
creating custom phonesearch function
setting busy timeout
PRAGMA page_size = 4096;
setting page_size
PRAGMA auto_vacuum = 1;
setting auto_vacuum
PRAGMA cache_size = 100;
setting cache_size
PRAGMA journal_mode = WAL;
setting journal_mode
setting foreign_keys
opening database %s
-[CRSQLiteConnection preparedStatementForPattern:]
NULL != _db
preparing statement for query "%@"
-[CRSQLiteConnection beginTransactionWithType:]
BEGIN DEFERRED
BEGIN IMMEDIATE
BEGIN EXCLUSIVE
0 && "unsupported transaction type"
_transactionType == type
-[CRSQLiteConnection commitTransaction]
COMMIT
-[CRSQLiteConnection rollbackTransaction]
ROLLBACK
com.apple.message.library.vfsQueue
vfsQueue
_vfsQueue != NULL
CoreRecentsVFS
/System/Library/Recents/Plugins
addresshandler
no conforming principal class found in %@
unable to load plugin bundle %@: %@
ERROR: %@ attempting to register multiple sync transformers for kinds: {%@}
registered transformers:
%@ => %@
@"NSNumber"16@?0@"NSString"8
CRPowerMonitorDeviceWillLockNotification
CRPowerMonitorDeviceLockedStateKey
com.apple.corerecents.sblockqueue
v12@?0i8
.StateUnknown
.StateSignedIn
.StateSignedInWithLocalDataRemoved
.StateSignedOut
-[CRSQLiteConnectionPool initWithDelegate:maxConcurrentReaders:]
CRSQLiteConnectionPool.m
maxConcurrentReaders > 0
-[CRSQLiteConnectionPool checkInConnection:]
nil != connectionWrapper
-journal
-wal
-shm
unhandled expression type
expected only NSString, NSNumber and NSNull types, got %@
count
operator
predicate
-[NSCompoundPredicate(PredicateBindings) cr_simplifiedPredicateSingleStep]
NSPredicateBindings.m
1 == count
0 && "unknown compound predicate type"
 AND 
 OR 
tokenSearch:
prefixSearch:
phoneSearch:
%@%@ == ?
%@%@ != ?
%@%@ < ?
%@%@ <= ?
%@%@ >= ?
%@%@ > ?
%@%@ BETWEEN ? AND ?
%@%@ IN (?
%%@%@(%%@, ?, %d)
%%@%@(%%@, ?, %ld)
-[NSComparisonPredicate(PredicateBindings) cr_addToClause:usingOperator:bindings:]
0 && "should be impossible to get here if we verified everything correctly ahead of time"
groupName
sendingAddress
failed to find collections for field '%@'
unexpected kind of predicate present
%@recents.rowid IN (
      SELECT contacts.recent_id
        FROM contacts
        JOIN recents ON (recents.ROWID = contacts.recent_id)
       WHERE 
    recents.count = 1
contacts.address
contacts.display_name
recents.display_name
recents.sending_address
<%@:%p; %@ kinds={%@}>
.SignedOut
.SignedInWithPreviousAccount
.SignedInWithNewAccount
.SwitchedAccount
CRAccountAdaptor.m
Use designated initializer.
LastiCloudAccountPersonID
LastiCloudAccountWasLoggedIn
v20@?0@"NSString"8B16
-[CRAccountAdaptor _delegateAccountChanges]
v32@?0r*8Q16^B24
collation
search
AppleCollationOrder
AppleLanguages
v16@?0@8
@"<CNCancelable>"16@?0@"<CNObserver>"8
Failed to open ICUSQLite collator: %s
CRDelayedWorkQueue
CRMailAccountIterator
CRAgent
NSXPCListenerDelegate
NSObject
_CRRecentsSQLiteConnectionWrapper
_CRRecentsLibrary
CRSQLiteConnectionPoolDelegate
CRRecentsMigratorDelegate
CRUbiquitousCoordinatorDelegate
CRProcessTransaction
CRRecentsMigrator
CRDClient
CRDRecentContactsLibrary
CRDRecentContactsLibraryProtocol
CRSQLiteConnection
CRAddressHandler
CRPluginManager
CRMailAccountAnalyzer
CRPowerMonitor
CRPowerAssertion
CRUbiquitousCoordinator
CRAccountAdaptorDelegate
CRSQLiteConnectionPool
_CRSQLiteConnectionWrapper
_CRPhoneSearchCache
PredicateBindings
PredicateBindingsInternal
_ClauseGenerationContext
CRPhoneSearch
CRAddressHandlerIdentity
CRAccountAdaptor
CRSearchMatcher
CRWeakReference
CRAccountListener
@16@0:8
v16@0:8
v24@0:8@16
B40@0:8@16d24@?32
{os_unfair_lock_s="_os_unfair_lock_opaque"I}
@"NSObject<OS_dispatch_queue>"
@"NSMutableDictionary"
@24@0:8@16
v24@0:8@?16
@"ACAccountStore"
B24@0:8@16
#16@0:8
@24@0:8:16
@32@0:8:16@24
@40@0:8:16@24@32
B16@0:8
B24@0:8#16
B24@0:8:16
Vv16@0:8
Q16@0:8
^{_NSZone=}16@0:8
B24@0:8@"Protocol"16
@"NSString"16@0:8
B32@0:8@16@24
B32@0:8@"NSXPCListener"16@"NSXPCConnection"24
v20@0:8B16
@"NSXPCListener"
@"_CRRecentsLibrary"
@"NSMutableSet"
@28@0:8@16B24
@"CRSQLiteConnection"
@"CRSQLiteConnection"24@0:8@"CRSQLiteConnectionPool"16
@32@0:8@16@24
@"NSString"32@0:8@"NSString"16@"NSString"24
v28@0:8@16B24
v24@0:8Q16
v28@0:8@"NSString"16B24
v20@0:8i16
i32@0:8^{sqlite3=}16@24
i28@0:8@16i24
i24@0:8@16
@20@0:8B16
v28@0:8@?16B24
@80@0:8^{sqlite3_stmt=}16{?={?=iiiiiiii}{?=iiiii}}24B76
@48@0:8@16@24^@32^@40
@?24@0:8@16
@32@0:8@16^@24
@24@0:8q16
@92@0:8^{sqlite3_stmt=}16{?={?=iiiiiiii}{?=iiiii}}24Q76Q84
v32@0:8@16@?24
v44@0:8@16@24@32B40
Q24@0:8@16
B32@0:8Q16@24
Q32@0:8@16Q24
v32@0:8Q16@24
v32@0:8@16d24
@48@0:8@16@24^@32@40
@48@0:8Q16@24^@32@40
B36@0:8@16B24^@28
v32@0:8@16^{sqlite3_stmt=}24
v40@0:8@16q24^{sqlite3_stmt=}32
v40@0:8@16@24@32
Q48@0:8@16@24@32@40
v32@0:8@16@24
B40@0:8@16@24@32
d16@0:8
v24@0:8d16
@"NSString"
@"CRPluginManager"
@"CRSQLiteConnectionPool"
@"CRRecentsMigrator"
@"<CRAccountAdaptor>"
@"NSLock"
^{__CFDictionary=}
@"CRDelayedWorkQueue"
@"CRUbiquitousCoordinator"
@"NSObject<OS_os_transaction>"
v28@0:8i16@20
B28@0:8@16i24
@"<CRRecentsMigratorDelegate>"
@"NSXPCConnection"
v56@0:8@16@24@32@40@?48
v32@0:8@"CRSearchQuery"16@?<v@?@"NSArray"@"NSError">24
v56@0:8@"NSArray"16@"NSString"24@"NSString"32@"NSString"40@?<v@?@"NSError">48
v40@0:8@"NSArray"16@"NSArray"24@"NSString"32
v24@0:8@?<v@?@"NSError">16
@24@0:8@?16
@"CRDClient"
r*16@0:8
i16@0:8
^{sqlite3_stmt=}24@0:8@16
i20@0:8i16
^{sqlite3=}16@0:8
^{sqlite3=}
@"NSObject<OS_os_log>"
@"NSSet"16@0:8
@"CNCache"
@"NSLocale"
@32@0:8@16d24
v32@0:8@16q24
v32@0:8@"<CRAccountAdaptor>"16q24
@"<CRUbiquitousCoordinatorDelegate>"
@32@0:8@16Q24
@"<CRSQLiteConnectionPoolDelegate>"
@"NSObject<OS_dispatch_semaphore>"
@24@0:8r*16
@"NSCache"
@"CRPhoneSearch"
@"NSDictionary"
@"NSMutableArray"
@32@0:8^{__CFString=}16^{__CFString=}24
B32@0:8r*16Q24
@"NSSet"
@24@0:8#16
@"<CRAddressHandler>"
@"CRAddressHandlerIdentity"
B24@0:8@"NSString"16
@40@0:8@16@24@32
@"CRMailAccountAnalyzer"
@"<CNCancelable>"
@"NSUserDefaults"
@"<CRAccountAdaptorDelegate>"
B28@0:8r*16i24
B24@0:8r*16
@36@0:8@16@24i32
@28@0:8@16i24
@"NSArray"
@"NSData"
@32@0:8@16@?24
dropping unentitled connection %{public}@
dropping connection %{public}@ because library is not available (probable cause: device not unlocked after boot)
Connection %p for %{public}@ was invalidated.
Connection %p for %{public}@ was interrupted.
Warning: getting writer connection on the main thread
No hash for contact %@
canceling any pending expunge for domain %{public}@
performing pending expunge for domain %{public}@
scheduled pending expunge after %.2fs for domain %{public}@
No hash for old recent with rowid %@ and kind %@
Found %lu recents over age limit for domain %{public}@
No hash for recent with rowid %@
Found %lu individual recents over hard limit for domain %{public}@
No hash for group recent with rowid %@
Found %lu group recents over hard limit for domain %{public}@
Expunging %lu recents over limit for bundle identifier %{public}@
No hash for row %@
No hash for recent %@
**** SQLITE ERROR: %s
deleting contact from '%{public}@' with record hash: [%{public}@]
deleting recent from remote store for domain '%{public}@' with key %{public}@
No hash for domain %@
deleting contacts from '%{public}@' with recent IDs: [%{public}@]
deleting recents from remote store for domain '%{public}@' with keys %{public}@
Attempt to remove invalid contact (h=%{public}@, b=%{public}@): %{public}@
Initializing KVS store (%{public}@: %{public}@)
reason:%{public}@ recentsDomain:%{public}@
Received external KVS change event: (%{public}@) %{public}@, changed keys=%{public}@
iCloud Key Value Store Over-Quota: %{public}@
After expunging, store has %lu entries
%{public}@: %{public}@
Syncing back local changes
Finished handling cloud store change
numChanges:%lu store:%{public}@ recentsDomain:%{public}@
Recent with hash '%{public}@' was removed from the cloud store, removing from local store
removing corrupted recent group %{public}@: %{public}@
calculated hash doesn't match reference key: %@ != %@, %@
MERGE: Skipping display name %{public}@
MERGE: Merged in local changes %{public}@ for contact %{public}@
MERGE: Skipping merging contact %{public}@ because we saw no dates %{public}@
Account with address %{public}@ is denying sync of contacts, skipping %{public}@
Contact with address %{public}@ has kind we don't know how to sync, %{public}@
SYNC: Skipped syncing contact because we could not calculate sync key: %{public}@
SYNC: Skipped syncing contact because there's not a sync transformer registered for address kind '%{public}@': %{public}@
SYNC: skipped syncing contact because not all members have an address or kind: %{public}@
SYNC: Skipping display name %{public}@
SYNC: Merged local changes from %{public}@: remote=%{public}@
merge=%{public}@
SYNC: Skipped syncing contact because we had no dates: %{public}@
Scheduled synchronization with iCloud store (%{public}@) %{public}@ after %.2fs
Synchronizing with iCloud store (%{public}@) %{public}@: %{public}@
Synchronizing with iCloud stores %{public}@
Removing local records for domain %{public}@
Removed %lu record(s)
Merge cloud data one-way into local with reason: %{public}@
wrong number of arguments (%d) to %s
Will execute query %{public}@ for %{public}@
Database connection unavailable
Query %{public}@ failed: %{public}@
Did execute query %{public}@ (%{public}@)
Closing sqlite connection %p
Will prepare statement for pattern: %@
Initializing cache
Cache hit
Cache miss
Prep time: %.3fms
SQLite I/O error (%d): %s
SQLite error (%d): %s
Did prepare statement in %.3fms
Observed iCloud account transition %@
Setting state for domain:%{public}@ -> %{public}@
Removing local records for all domains
Error %d on connection %p %{public}@: %s - I/O error %d (%s)
Error %d on connection %p %{public}@: %s
wrong number of arguments (%d) to icusearch
wrong number of arguments (%d) to cpsearch
wrong number of arguments (%d) to phonesearch
Renaming database %{public}@ to %{public}@
Removing database %{public}@
%s old:%{public}@ current:%{public}@
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>CFBundleDevelopmentRegion</key>
<string>English</string>
<key>CFBundleExecutable</key>
<string>recentsd</string>
<key>CFBundleIconFile</key>
<string></string>
<key>CFBundleIdentifier</key>
<string>com.apple.corerecents.recentsd</string>
<key>CFBundleInfoDictionaryVersion</key>
<string>6.0</string>
<key>CFBundleName</key>
<string>recentsd</string>
<key>CFBundlePackageType</key>
<string>APPL</string>
<key>CFBundleShortVersionString</key>
<string>1.0</string>
<key>CFBundleSignature</key>
<string>????</string>
<key>CFBundleVersion</key>
<string>1</string>
</dict>
</plist>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>com.apple.mobilemail.mailservices</key>
<true/>
<key>com.apple.private.accounts.allaccounts</key>
<true/>
<key>com.apple.private.tcc.allow.overridable</key>
<array>
<string>kTCCServiceCalendar</string>
<string>kTCCServiceReminders</string>
</array>
<key>com.apple.private.ubiquity-additional-kvstore-identifiers</key>
<array>
<string>com.apple.mail.recents</string>
<string>com.apple.facetime.recents</string>
<string>com.apple.calendar.recents</string>
<string>com.apple.eventkit.locations</string>
<string>com.apple.passbook.locations</string>
</array>
<key>com.apple.wifi.manager-access</key>
<true/>
</dict>
</plist>
oooo
HKMQO
dataWithData:
lock
setMembers:
constantValue
indexOfObject:inSortedRange:options:usingComparator:
dictionaryWithObject:forKey:
setBool:forKey:
mostRecentDate
initWithMachServiceName:
removeObjectForKey:
accountValuesForKeys:completionBlock:
fileSystemRepresentation
isEqualToNumber:
timeIntervalSinceDate:
loadAndReturnError:
objectAtIndexedSubscript:
array
dataUsingEncoding:
predicate
dictionaryWithDictionary:
removeObjectAtIndex:
applyWeight:
accountProperties
objectAtIndex:statement:
setAddress:
postNotificationName:object:userInfo:
threadDictionary
fileExistsAtPath:
XPCInterface
implicitGroupThreshold
step:
dictionaryWithCapacity:
removeObject:
objectAtIndex:
cr_addNonNilObject:
customSelector
isAtEnd
postNotification:
aa_primaryAppleAccount
bytes
length
compoundPredicateType
dictionaryRepresentation
initWithFormat:
leftExpression
appendString:
cr_CRRecentIDValue
bundleWithPath:
aa_personID
currentThread
standardUserDefaults
objCType
componentsSeparatedByString:
expressionType
dictionaryForKey:
appendFormat:
currentLocale
cr_CRContactIDValue
invalidate
bundleIdentifierForAuditToken:
lastSendingAddress
componentsSeparatedByCharactersInSet:
removeAllObjects
expressionForKeyPath:
sortedArrayUsingFunction:context:
metadata
anyObject
dictionary
intersectSet:
whitespaceCharacterSet
substringFromIndex:
numberWithUnsignedInteger:
lastPathComponent
cr_CRContactGroupKindValue
currentHandler
setKind:
subscribe:
recordRecentEventForDate:userInitiated:
componentsJoinedByString:
expressionForConstantValue:
countOfRecents
integerValue
bundleForClass:
scannerWithString:
numberWithLongLong:
allValues
lastObject
weight
currentCalendar
setWithSet:
subpredicates
members
initWithContactID:
completionHandlerAdapter
intValue
errorWithDomain:code:userInfo:
numberWithIntegerAtIndex:
cr_uniqueFilenameWithRespectToFilenames:
scanString:intoString:
allObjects
countByEnumeratingWithState:objects:count:
pathExtension
comparisonPredicateModifier
boolValue
setInvalidationHandler:
insertObject:atIndex:
setWithCapacity:
subarrayWithRange:
defaultStore
enumerateRowsInStatement:usingBlock:
boolForKey:
count
numberWithDoubleAtIndex:
scanLongLong:
allKeys
setWithArray:
pageRange
setInterruptionHandler:
defaultProvider
compare:
UTF8String
numberWithBool:
stringWithUTF8String:
_cn_take:
variable
setImplicitGroupThreshold:
kind
recentsDomain
initWithType:subpredicates:
setWeight:
stringWithString:
_cn_skip:
rowWithStatement:
enumerateKeysAndObjectsUsingBlock:
null
keyPath
originalSource
uuid
recentID
notificationWithName:object:userInfo:
handleFailureInMethod:object:file:lineNumber:description:
stringWithFormat:
options
setGroupName:
userInfo
collection
initWithCapacity:
recentDates
defaultManager
stringWithContentsOfURL:encoding:error:
doubleValue
auditToken:
handleFailureInFunction:file:lineNumber:description:
setGroupKind:
initWithBytesNoCopy:length:freeWhenDone:
code
observerWithResultBlock:
setRecentsDomain:
defaultCenter
rightExpression
notPredicateWithSubpredicate:
stringForTimeInterval:
address
domains
auditToken
initWithBytesNoCopy:length:encoding:freeWhenDone:
setExportedObject:
makeObjectsPerformSelector:withObject:
setRecentID:
stringForKey:
observerDidReceiveResult:
reverseObjectEnumerator
groupName
setExportedInterface:
arrayWithObjects:count:
isTimeoutError:
initWithArray:
setRecentDates:
stringByFoldingWithOptions:locale:
mainRunLoop
rawAddressFromFullAddress:
domain
observableWithBlock:
nextObject
addObserver:selector:name:object:
arrayWithObjects:
resume
copy
setDomains:
_initWithStoreIdentifier:usingEndToEndEncryption:
unlock
cr_md5DigestHexString
groupKind
principalClass
doesNotRecognizeSelector:
dateWithTimeIntervalSince1970:
setRawAddress:
stringByDeletingLastPathComponent
observableOnDefaultNotificationCenterWithName:object:
addObjectsFromArray:
resultWithTimeout:error:
cr_map:
setDisplayName:
arrayWithObject:
initWithAddress:displayName:kind:recentDate:recentsDomain:
dateByAddingComponents:toDate:options:
setOriginalSource:
contentsOfDirectoryAtPath:error:
distantPast
tokenWithCancelationBlock:
stringByAppendingString:
setDictionary:forKey:
arrayWithCapacity:
lowercaseString
future
objectForKeyedSubscript:
initWithObjects:
date
setObject:forKeyedSubscript:
containsString:
arrayByApplyingSelector:
mutableCopy
objectForKey:onCacheMiss:
displayName
addIndex:
stringByAppendingPathComponent:
timestamp
URLForResource:withExtension:
isGroup
predicateWithLeftExpression:rightExpression:modifier:type:options:
dataWithPropertyList:format:options:error:
longLongValue
setObject:forKey:
mutableBytes
cr_insertionSortedArrayUsingComparator:
dictionaryWithObjectsAndKeys:
containsObject:
arrayByAddingObjectsFromArray:
stringAtIndex:
addFailureBlock:
removeObserver:
setDay:
timeIntervalSinceReferenceDate
firstObject
dataWithLength:
isEqualToString:
objectForKey:
caseInsensitiveCompare:
predicateWithBlock:
indexSet
setMetadata:
moveItemAtPath:toPath:error:
contactID
string
timeIntervalSinceNow
removeObjectsAtIndexes:
initWithMembers:displayName:recentDate:recentsDomain:
dictionaryWithObjects:forKeys:count:
filteredArrayUsingPredicate:
arrayByAddingObject:
cr_insertObject:usingComparator:
predicateOperatorType
objectEnumerator
init
dealloc
cancelWorkForKey:
scheduleWorkForKey:afterDelay:work:
cancel
flush
_lock
_queue
_requests
receivedEmailAddressesFromAccount:
initWithAccountStore:
enumerateEmailAddresses:
mailAccounts
emailAddressesForAccount:
.cxx_destruct
_accountStore
_lockStateChanged:
clientMayConnect:
isEqual:
class
self
performSelector:
performSelector:withObject:
performSelector:withObject:withObject:
isProxy
isKindOfClass:
isMemberOfClass:
conformsToProtocol:
respondsToSelector:
retain
release
autorelease
retainCount
zone
hash
superclass
description
debugDescription
TQ,R
T#,R
T@"NSString",R,C
listener:shouldAcceptNewConnection:
clientForConnection:
daemonLibraryForClient:
_adjustLibraryStoreSyncBehaviorWithLockedState:
_executeAfterFirstUnlock:
start
stop
_listener
_library
_libraryAvailable
_startupQueue
_clients
wrapperWithConnection:forWriting:
initWithConnection:forWriting:
incrementRefcount
decrementRefcount
writer
setWriter:
connection
setConnection:
_refcount
_writer
_connection
T@"CRSQLiteConnection",&,N,V_connection
TB,N,V_writer
setLastSendingAddress:
_storeChangedExternally:
unsignedIntegerValue
defaultPath
storeMapping
newConnectionForConnectionPool:
recentsHashForAddress:kind:
removeLocalRecordsForDomain:removeInUbiquitousStore:
mergeCloudDataOneWayIntoLocalStoreWithReason:
initWithPath:
initWithPath:accountAdaptor:
closeDatabaseConnections
renameOrRemoveDatabase
_handleCorruptDatabase
_handleFullDatabase
_handleIOError
_handleBusyError
_handleSQLiteErrorCode:
handleSqliteError:format:
_setActiveConnection:forWriting:
_activeConnectionWrapper
beginTransaction:withType:
commitTransaction:
rollbackTransaction:
unlockConnection:
_connectionForWriting:
_performTransaction:forWriting:
performWriteTransaction:
performReadTransaction:
copyRecentContactFromStatement:columnIndexes:populateMetadata:
_whereClauseFromPredicate:inDomains:bindings:error:
domainClauseWithDomains:bindings:
bindingForDomain:
copyRecentsForQuery:error:
populateMetadataForRecents:
upcomingEventIdentifierForRecentID:
copyContactRecentsFromStatement:selectIndexes:groupThreshold:options:
hashForGroupMembers:recentsDomain:
hashesForGroupMembers:recentsDomain:
hashForGroupMemberHashes:
_copyRecentContactForRecordHash:recentsDomain:
_copyRecentContactForID:
enumerateRecentsForDomain:usingBlock:
removeRecentContactsWithRecentIDs:syncKeys:domain:removeInUbiquitousStore:
removeAllRecentContactsWithCompletion:
_databasePropertyValueByKey:
_setDatabasePropertyValue:forKey:
_propertyValueForKey:defaultValue:
_setPropertyValue:forKey:
maximumRecentsForDomain:
setMaximumRecents:forRecentsDomain:
maximumGroupRecentsForDomain:
setMaximumGroupRecents:forRecentsDomain:
maximumRecentsAgeInDaysForDomain:
setMaximumRecentsAgeInDays:forRecentsDomain:
cancelPerformExpungeRecentsOverLimitsForDomain:
performExpungeRecentsOverLimitsForDomain:afterDelay:
_nts_expungeRecentsOlderThanDate:domain:storeKeys:connection:
_nts_expungeIndividualRecentsOverLimit:domain:storeKeys:connection:
_nts_expungeGroupRecentsOverLimit:domain:storeKeys:connection:
expungeRecentsOverLimitsForDomain:forcibly:expungedRecentIDs:
_bindRecent:forStatement:
_bindContact:withRecentID:forStatement:
_insertRecentContacts:
_updateRecentContacts:
_saveRecentContacts:
_deleteRecentWithRecordHash:kind:recentsDomain:
_deleteRecentsWithRecentIDs:storeKeys:recentsDomain:deleteInUbiquitousStore:
recordContactEvents:recentsDomain:sendingAddress:source:
removeContact:
addressHandlerForAddressKind:
recentsHashForExternalAddress:kind:
addressFromExternalAddress:kind:
externalAddressFromAddress:kind:
hashForContact:
hashForGroup:
keyForContact:
_initializeStoreForRecentsDomain:storeIdentifier:
_recentsDomainForStore:
_storeForRecentsDomain:
_mergeRemoteChanges:fromStore:forRecentsDomain:
_syncContact:withStore:
synchronize
scheduleSynchronizationForStore:
_synchronizeStore:
_synchronizeAllStores
storeSyncDelay
setStoreSyncDelay:
cloudStores
setCloudStores:
ubiquitousCoordinator
setUbiquitousCoordinator:
_path
_pluginManager
_connectionPool
_migrator
_accountAdaptor
_cachedProperties
_pendingDomainExpunges
_pendingStoreSyncEvents
_storeSyncDelay
_cloudStores
_ubiquitousCoordinator
T@"NSMutableDictionary",&,N,V_cloudStores
T@"CRUbiquitousCoordinator",&,N,V_ubiquitousCoordinator
Td,N,V_storeSyncDelay
transactionWithDescription:
initWithDescription:
_transaction
migrateLibraryFilesFrom:to:
versionOfDatabase:
setVersion:ofDatabase:
executeSQL:database:
initWithDelegate:
needsRebuild
noteNeedsRebuild
migrateWithSQLiteConnection:
migrateWithSQLiteConnection:toVersion:
migrateMailEmbeddedLibraryToPath:
_delegate
_needsRebuild
initWithConnection:library:
hasEntitlement:
bundleIdentifier
library
T@"NSXPCConnection",R,N,V_connection
T@"_CRRecentsLibrary",R,N,V_library
T@"NSString",R,N
os_log
searchRecentsUsingQuery:completion:
recordContactEvents:domain:sendingAddress:source:completion:
removeRecentContactsWithRecentIDs:syncKeys:domain:
initWithClient:
_remoteLibraryWithErrorHandler:
_client
connectionToNewInMemoryStore
initWithPath:databaseName:
_vfsModuleName
open
close
isOpen
preparedStatementForPattern:
beginTransaction
beginTransactionWithType:
commitTransaction
rollbackTransaction
_statementCache
_ICUSearchContext
_CRSearchContext
_CRPhoneSearchContext
_transactionType
_transactionCount
_log
T^{sqlite3=},R,N,V_db
supportedAddressKinds
syncKeyForAddress:kind:
defaultPluginPath
_loadPlugins
_loadPluginBundle:
_addAddressHandler:
addressHandlers
_addressHandlersByKind
initWithLocale:
addAddress:isRestricted:
isAddressRestricted:
allAddresses
normalizeAddress:
_cache
_locale
sharedMonitor
_updateLockStateWithToken:
isLocked
_lockNotifyToken
_lockState
locked
TB,R,N,GisLocked
initWithIdentifier:timeout:
_powerAssertion
accountAdaptor:observediCloudAccountTransition:
coordinateChangesInUbiquitousStoreForDomain:
ubiquitousStoreForDomainChangedAccount:
_allDomains
_cloudStoreStateForDomain:
_setCloudStoreState:forDomain:
_setCloudStoreStateForAllDomains:
_removeLocalRecordsForCloudStoresWithDataFromPreviousAccount
_removeLocalRecordsForAllDomains
_cloudStoreStates
initWithDelegate:maxConcurrentReaders:
readerConnection
writerConnection
checkInConnection:
setCacheSize:
cacheSize
maxConcurrentReaders
maxConcurrentWriters
readersWaiting
writersWaiting
delegate
setDelegate:
_cacheLock
_cacheSize
_cacheGeneration
_maxConcurrentReaders
_maxConcurrentWriters
_checkoutLock
_checkoutMap
_readerSemaphore
_readersWaiting
_writerSemaphore
_writersWaiting
T@"<CRSQLiteConnectionPoolDelegate>",V_delegate
initWithConnection:generation:
generation
isWriter
setIsWriter:
_generation
_isWriter
T@"CRSQLiteConnection",R,N,V_connection
TQ,R,N,V_generation
TB,N,V_isWriter
copySearcherForPattern:
lastPhoneSearch
setLastPhoneSearch:
_lastSearchString
_lastSearchStringLength
_lastPhoneSearch
T@"CRPhoneSearch",&,N,V_lastPhoneSearch
cr_expressionValue
cr_sqlBindings
cr_simplifiedPredicate
cr_simplifiedPredicateSingleStep
cr_processWithContext:
cr_addToClause:usingOperator:bindings:
cr_isInvalidOperatorType:forKeyPath:
cr_predicateClauseWithBindings:error:
cr_mergeSubcontext:intoContext:
tokenSearch:
prefixSearch:
phoneSearch:
cr_isInvalidComparisonPredicate
cr_sqlNameForFieldName:
addObject:
addPredicate:forFieldName:
kindClauseWithBindings:
clauseWithBindings:
hadError
setHadError:
wantsGroups
setWantsGroups:
kindPredicates
setKindPredicates:
predicates
setPredicates:
_predicateCollectionsMap
_hadError
_wantsGroups
_kindPredicates
_predicates
TB,N,V_hadError
TB,N,V_wantsGroups
T@"NSMutableArray",&,N,V_kindPredicates
T@"NSMutableArray",&,N,V_predicates
copyCountryCode
copyNormalizedPhoneNumber:countryCode:
initWithSearchString:
_copyInterpretationsForPhoneNumber:
isEqualToPhoneNumber:
hasPrefix:
matchesUTF8String:matchType:
_countryCode
_searchString
identityForAddressHandler:
initForAddressHandler:
setSupportedAddressKinds:
_className
_supportedAddressKinds
T@"NSSet",C,N,V_supportedAddressKinds
addressHandlerWithPrincipalClass:
initWithPrincipalClass:
initWithAddressHandler:
identity
setIdentity:
_handler
_identity
T@"CRAddressHandlerIdentity",&,N,V_identity
isSyncingDisabledForAccountWithAddress:
senderEmailAddresses
isUsingiCloud
initWithUserDefaults:accountStore:delegate:
_runWithAnalyzerLock:
_analyzeMailAccounts
_resetCachedAccountInfo
_primaryiCloudAccountPersonID
_delegateAccountChanges
refresh
_analyzer
_mailAccountListener
_appleAccountListener
_userDefaults
_iCloudAccountPersonID
_iCloudAccountWasLoggedIn
T@"<CRAccountAdaptorDelegate>",N,V_delegate
matchesASCIIString:matchType:
matchesUTF8String:
matches:
matches:matchType:
initWithSearchString:andLocale:andOptions:
initWithSearchString:andLocale:
initWithSearchString:options:
_options
_components
_asciiComponents
_wholeSearchStringData
_context
weakReferenceWithObject:
initWithObject:
object
_weakRef
mailAccountListenerWithHandler:
appleAccountListenerForStore:withHandler:
_makeObservableForAccountStore:
_makeObservableForMailAccount
com.apple.corerecents.delayedWork.%p
com.apple.corerecents.delayedWork-%p-%@
v8@?0
defaultAddress
ReceiveEmailAliasAddresses
v16@?0@"NSError"8
failed to get account information after 10 seconds
Error loading Mail account information: %@
com.apple.contacts.corerecents.agent.startup
com.apple.corerecents.launch
com.apple.private.corerecents
com.apple.private.contactsui
-[_CRRecentsSQLiteConnectionWrapper decrementRefcount]
_CRRecentsLibrary.m
_refcount > 0
%@/Library/Recents
com.apple.mail.recents
com.apple.eventkit.locations
com.apple.passbook.locations
v32@?0@"NSString"8@"NSString"16^B24
Recents
com.apple.corerecents.recentsLibrary.connection
recents: beginning transaction
recents: committing transaction
recents: rolling back transaction
-[_CRRecentsLibrary unlockConnection:]
[wrapper connection] == connection
-[_CRRecentsLibrary _connectionForWriting:]
nil != connection
[wrapper writer]
WHERE %@
 AND 
bundle_identifier IN (%@)
v20@?0^{sqlite3_stmt=}8i16
%@ %@
B16@?0@"CRSQLiteConnection"8
SELECT recent_id, key, value FROM metadata WHERE recent_id IN (?
) ORDER BY recent_id
v16@?0@"CRSQLRow"8
SELECT value FROM metadata WHERE recent_id = ? AND key = ?
v32@?0@"NSNumber"8@"NSMutableArray"16^B24
address
kind
 WHERE recents.record_hash = :record_hash AND recents.bundle_identifier = :bundle_identifier
:record_hash
:bundle_identifier
 WHERE recents.ROWID = :rowid
:rowid
 WHERE recents.bundle_identifier = :bundle_identifier
SELECT value FROM properties WHERE key = :key
:key
INSERT OR REPLACE INTO properties (key, value) VALUES (:key, :value)
:value
-[_CRRecentsLibrary setMaximumRecents:forRecentsDomain:]
maxRecents > 0
-[_CRRecentsLibrary setMaximumGroupRecents:forRecentsDomain:]
        SELECT recents.ROWID, recents.record_hash, recents.count 
        FROM recents 
        WHERE recents.bundle_identifier = :bundle_identifier 
        AND recents.last_date < :expunge_date     
:expunge_date
        SELECT recents.ROWID, recents.record_hash 
        FROM recents 
        WHERE recents.bundle_identifier = :bundle_identifier 
            AND recents.count = 1 
        ORDER BY recents.last_date DESC 
        LIMIT -1 
        OFFSET :offset     
:offset
        SELECT recents.ROWID, recents.record_hash 
        FROM recents 
        WHERE recents.bundle_identifier = :bundle_identifier 
            AND recents.count != 1 
        ORDER BY recents.last_date DESC 
        LIMIT -1 
        OFFSET :offset     
                    SELECT recents.record_hash, recents.count 
                    FROM recents 
                    WHERE recents.bundle_identifier = :bundle_identifier                 
-[_CRRecentsLibrary _bindRecent:forStatement:]
[recent countOfRecents] > 0 && "can't save recent contact without event dates"
:display_name
:original_source
:last_date
:weight
:group_kind
%@%lld
:dates
:sending_address
:recent_id
:kind
:address
INSERT INTO recents (display_name, bundle_identifier, original_source, dates, last_date, sending_address, count, weight, record_hash, group_kind)             VALUES (:display_name, :bundle_identifier, :original_source, :dates, :last_date, :sending_address, :count, :weight, :record_hash, :group_kind)
INSERT INTO contacts (recent_id, display_name, kind, address)             VALUES (:recent_id, :display_name, :kind, :address)
INSERT INTO metadata (recent_id, key, value) VALUES (:recent_id, :key, :value)
:count
v32@?0@8@16^B24
            UPDATE contacts             SET display_name = :display_name             WHERE ROWID = :recent_id         
            UPDATE recents             SET                 weight = COALESCE(MAX(weight, :weight), weight, :weight),                 display_name    = :display_name,                 dates           = :dates,                 last_date       = :last_date,                 sending_address = :sending_address,                 group_kind      = :group_kind             WHERE ROWID = :recent_id         
INSERT OR REPLACE INTO metadata (recent_id, key, value) VALUES (:recent_id, :key, :value)
-[_CRRecentsLibrary _deleteRecentWithRecordHash:kind:recentsDomain:]
recentsDomain
DELETE FROM recents WHERE recents.record_hash = :record_hash AND recents.bundle_identifier = :bundle_identifier
-[_CRRecentsLibrary _deleteRecentsWithRecentIDs:storeKeys:recentsDomain:deleteInUbiquitousStore:]
recentsDomain != nil
            DELETE FROM recents 
            WHERE recents.ROWID IN (%@) 
            AND recents.bundle_identifier = :bundle_identifier         
@"CRRecentContact"16@?0@"NSString"8
options
members
timestamp
displayName
metadata
weight
v24@?0@"CRRecentContact"8@"NSString"16
@"NSString"16@?0@"CRRecentContact"8
com.apple.corerecents.externalStoreChange
-[_CRRecentsLibrary _storeChangedExternally:]
MAX_RECENTS
v32@?0@"NSString"8@16^B24
v24@?0@"CRRecentContact"8^B16
q24@?0@"NSString"8@"NSString"16
v32@?0@"NSString"8@"NSDictionary"16^B24
v24@?0@8@"NSString"16
succeeded
failed
v32@?0@8@"NSUbiquitousKeyValueStore"16^B24
@16@?0@"CRRecentContact"8
SELECT recents.ROWID,
       recents.bundle_identifier,
       recents.dates,
       recents.display_name,
       recents.sending_address,
       recents.original_source,
       recents.weight,
       recents.group_kind,
       contacts.ROWID,
       contacts.kind,
       contacts.display_name,
       contacts.address
  FROM recents
  JOIN contacts ON contacts.recent_id = recents.ROWID
_maxRecentPropertyKeyForRecentsDomain
max-recent:
_maxGroupRecentPropertyKeyForRecentsDomain
max-group-recent:
_maxRecentAgePropertyKeyForRecentsDomain
max-recent-age:
void _bindData(sqlite3_stmt *, const char *, NSData *)
data length is more than INT_MAX
NSUbiquitousKeyValueStoreServerChange
NSUbiquitousKeyValueStoreInitialSyncChange
NSUbiquitousKeyValueStoreQuotaViolationChange
NSUbiquitousKeyValueStoreAccountChange
com.apple.corerecents.newDatabase
com.apple.corerecents.iCloudSignIn
com.apple.corerecents.iCloudSwitch
unknown change reason (%lu)
B24@?0@8@"NSDictionary"16
-[CRProcessTransaction init]
CRProcessTransaction.m
<%@:%p> %s
getting library version
Error: migration is not supported for version %d
VACUUM
%@/Library/Mail
/tmp/
New path looks like a temporary directory, skipping migration: %@
Recents-shm
Recents-wal
Failed to migrate %@ to %@. Error: %@
Error %d %@: %s
SELECT value FROM properties WHERE key = 'version'
INSERT OR REPLACE INTO properties (key, value) values ('version', ?)
setting library version
preparing library version insert statement
recents
Error loading SQL: %@
executing SQL from file: %@
_ExecuteSQL
CRRecentsMigrator.m
nil != sql
executing SQL statements
ALTER TABLE recents ADD COLUMN address_hash TEXT;
adding address_hash to recents table
DROP INDEX IF EXISTS recents_last_name; DROP INDEX IF EXISTS recents_first_name; ALTER TABLE recents ADD COLUMN display_name TEXT;
dropping indexes, adding display name columns
UPDATE recents SET display_name = NULLIF(IFNULL(first_name, '') || ' ' || IFNULL(last_name, ''), ' '), last_name = NULL, middle_name = NULL, first_name = NULL, suffix = NULL;
updating recents with display names
ALTER TABLE recents ADD COLUMN sending_address TEXT;
adding sending address column
DROP TABLE IF EXISTS new_recents;
CREATE TABLE new_recents (ROWID INTEGER PRIMARY KEY AUTOINCREMENT,
display_name TEXT,
bundle_identifier TEXT,
property INTEGER,
address TEXT,
address_hash TEXT,
sending_address TEXT,
dates TEXT NOT NULL,
last_date INTEGER,
UNIQUE (bundle_identifier, address_hash)
);INSERT INTO new_recents (bundle_identifier, display_name, property, address, address_hash, sending_address, dates, last_date)SELECT 'com.apple.mobilemail', display_name, property, address, address_hash, sending_address, dates, last_date FROM recents;DROP TABLE recents; ALTER TABLE new_recents RENAME TO recents;
migrating data to recents table with new contraints
CREATE INDEX recents_address_hash ON recents(bundle_identifier, address_hash, property);CREATE INDEX recents_expunge ON recents(bundle_identifier, last_date DESC);
adding new index
_migration_hash
registering hash function
DROP TABLE IF EXISTS new_recents;
CREATE TABLE new_recents (ROWID INTEGER PRIMARY KEY AUTOINCREMENT,
display_name TEXT,
bundle_identifier TEXT,
kind TEXT,
address TEXT,
address_hash TEXT NOT NULL,
sending_address TEXT,
dates TEXT NOT NULL,
last_date INTEGER,
UNIQUE (bundle_identifier, address_hash)
creating new_recents table with new constraints
DROP TABLE IF EXISTS recents; ALTER TABLE new_recents RENAME TO recents;CREATE INDEX recents_address_hash ON recents(bundle_identifier, address_hash, kind);CREATE INDEX recents_expunge ON recents(bundle_identifier, last_date DESC);
dropping old recents table, rename new_recents to recents, adding new indexes
unregistering hash function
__recentsHashFunction
SELECT bundle_identifier, display_name, CASE WHEN property = 4 THEN 'email' WHEN property = 3 THEN 'phone' END, address, _migration_hash(CASE WHEN property = 4 THEN 'email' WHEN property = 3 THEN 'phone' END, address), sending_address, dates, last_date FROM recents;
%s-%s
bundle_identifier
address_hash
dates
last_date
display_name
sending_address
INSERT INTO new_recents (bundle_identifier, display_name, kind, address, address_hash, sending_address, dates, last_date)VALUES (?, ?, ?, ?, ?, ?, ?, ?);
transferring recents to new_recents
DROP TABLE IF EXISTS new_recents;
DROP TABLE IF EXISTS contacts;
        CREATE TABLE new_recents (            ROWID INTEGER PRIMARY KEY AUTOINCREMENT,             display_name TEXT,             bundle_identifier TEXT,             sending_address TEXT,                         dates TEXT NOT NULL,             last_date INTEGER,                         count INTEGER         );                INSERT INTO new_recents (ROWID, display_name, bundle_identifier, sending_address, dates, last_date, count)         SELECT ROWID, display_name, bundle_identifier, sending_address, dates, last_date, 1 FROM recents;   CREATE TABLE contacts (             ROWID INTEGER PRIMARY KEY AUTOINCREMENT,                         recent_id INTEGER,                         display_name TEXT,             kind TEXT,             address TEXT,             address_hash TEXT NOT NULL,                         FOREIGN KEY (recent_id) REFERENCES new_recents (ROWID) ON DELETE CASCADE         );                 INSERT INTO contacts (recent_id, display_name, kind, address, address_hash)         SELECT ROWID, display_name, kind, address, address_hash FROM recents;                 DROP TABLE recents; ALTER TABLE new_recents RENAME TO recents;                 DROP INDEX IF EXISTS recents_address_hash;         DROP INDEX IF EXISTS recents_expunge;     
creating separate contacts and recents tables
            CREATE INDEX contacts_recentsidx ON contacts(recent_id);             CREATE INDEX contacts_address_hash ON contacts(address_hash, kind);             CREATE INDEX contacts_search ON contacts(display_name, address);                    CREATE INDEX recents_expunge ON recents(bundle_identifier, last_date DESC);         
adding new index for contacts table
DROP TABLE IF EXISTS metadata;
CREATE TABLE metadata (
    ROWID INTEGER PRIMARY KEY AUTOINCREMENT,
    recent_id INTEGER,
    key TEXT,
    value,
    FOREIGN KEY (recent_id) REFERENCES recents (ROWID) ON DELETE CASCADE,
    UNIQUE (recent_id, key)
DROP INDEX IF EXISTS contacts_search;
DROP INDEX IF EXISTS contacts_address;
DROP INDEX IF EXISTS metadata_recents;
CREATE INDEX metadata_recents ON metadata(recent_id);
CREATE INDEX contacts_address ON contacts(kind, display_name, address);
creating metadata tables and indexes
ALTER TABLE recents ADD COLUMN original_source TEXT;
adding original_source column
ALTER TABLE recents ADD COLUMN weight FLOAT;
adding weight column
0. Disable foreign key constraints.
PRAGMA foreign_keys = OFF;
1. Add record_hash column to recents
DROP TABLE IF EXISTS new_recents; 
CREATE TABLE new_recents ( 
   ROWID INTEGER PRIMARY KEY AUTOINCREMENT, 
   display_name TEXT, 
   bundle_identifier TEXT, 
   sending_address TEXT, 
   original_source TEXT, 
   dates TEXT NOT NULL, 
   last_date INTEGER, 
   weight FLOAT, 
   record_hash TEXT NOT NULL, 
   count INTEGER 
);INSERT INTO new_recents (ROWID, display_name, bundle_identifier, sending_address, 
                         original_source, dates, last_date, weight, count, record_hash) SELECT recents.ROWID, 
       recents.display_name, 
       recents.bundle_identifier, 
        recents.sending_address, 
        recents.original_source, 
        recents.dates, 
        recents.last_date, 
        recents.weight, 
        recents.count, 
        contacts.address_hash 
 FROM recents 
 INNER JOIN contacts 
         ON contacts.recent_id = recents.ROWID 
GROUP BY recents.ROWID;
2. Generate new hashes for each group
SELECT recents.ROWID, contacts.address_hash, contacts.kind FROM recents INNER JOIN contacts ON contacts.recent_id = recents.ROWID WHERE recents.count > 1
q24@?0@8@16
UPDATE new_recents SET record_hash = '%@' WHERE ROWID = %ld
3. Remove contacts' address_hash column
DROP TABLE IF EXISTS new_contacts; 
CREATE TABLE new_contacts ( 
    ROWID INTEGER PRIMARY KEY AUTOINCREMENT, 
    recent_id INTEGER, 
    display_name TEXT, 
    kind TEXT, 
     address TEXT, 
    FOREIGN KEY (recent_id) REFERENCES new_recents (ROWID) ON DELETE CASCADE 
);INSERT INTO new_contacts (ROWID, recent_id, display_name, kind, address) SELECT ROWID, recent_id, display_name, kind, address FROM contacts; 
DROP TABLE contacts; ALTER TABLE new_contacts RENAME TO contacts; 
DROP TABLE recents; ALTER TABLE new_recents RENAME TO recents; 
DROP INDEX IF EXISTS contacts_address_hash; 
DROP INDEX IF EXISTS recents_record_hash; 
DROP INDEX IF EXISTS recents_expunge; 
CREATE INDEX recents_record_hash ON recents(record_hash); 
CREATE INDEX recents_expunge ON recents(bundle_identifier, last_date DESC); 
4. Re-enable foreign key constraints.
PRAGMA foreign_keys = ON;
DROP INDEX IF EXISTS contacts_recentsidx;
DROP INDEX IF EXISTS contacts_address;
CREATE INDEX contacts_recentsidx ON contacts(recent_id);
CREATE INDEX contacts_address ON contacts(kind, display_name, address);
creating contacts indexes
ALTER TABLE recents ADD COLUMN group_kind INTEGER;
adding group kind column
DELETE FROM recents WHERE bundle_identifier='com.apple.eventkit.ios'
deleting pre-existing com.apple.eventkit.ios records
UPDATE recents SET bundle_identifier='com.apple.eventkit.ios' WHERE bundle_identifier='com.apple.reminders';
renaming iOS reminders domain
DELETE FROM contacts WHERE rowid IN (SELECT c.rowid FROM contacts c LEFT JOIN recents r ON (c.recent_id = r.rowid) WHERE r.rowid IS NULL)
deleting dangling contacts
DELETE FROM metadata WHERE rowid IN (SELECT m.rowid FROM metadata m LEFT JOIN recents r ON (m.recent_id = r.rowid) WHERE r.rowid IS NULL)
deleting dangling metadata
DELETE FROM recents WHERE bundle_identifier IN ('com.apple.MobileSMS', 'com.apple.messages')
deleting messages recents
com.apple.corerecents
daemon
:memory:
-[CRSQLiteConnection initWithPath:]
CRSQLiteConnection.m
NULL != path
com.apple.contacts.recentsd
statement-cache
-[CRSQLiteConnection initWithPath:databaseName:]
NULL != databaseName
-[CRSQLiteConnection dealloc]
NULL == _db
-[CRSQLiteConnection open]
enabling extended error codes
icusearch
creating custom icusearch function
cpsearch
creating custom cpsearch function
phonesearch
creating custom phonesearch function
setting busy timeout
PRAGMA page_size = 4096;
setting page_size
PRAGMA auto_vacuum = 1;
setting auto_vacuum
PRAGMA cache_size = 100;
setting cache_size
PRAGMA journal_mode = WAL;
setting journal_mode
setting foreign_keys
opening database %s
-[CRSQLiteConnection preparedStatementForPattern:]
NULL != _db
preparing statement for query "%@"
-[CRSQLiteConnection beginTransactionWithType:]
BEGIN DEFERRED
BEGIN IMMEDIATE
BEGIN EXCLUSIVE
0 && "unsupported transaction type"
_transactionType == type
-[CRSQLiteConnection commitTransaction]
COMMIT
-[CRSQLiteConnection rollbackTransaction]
ROLLBACK
com.apple.message.library.vfsQueue
vfsQueue
_vfsQueue != NULL
CoreRecentsVFS
/System/Library/Recents/Plugins
addresshandler
no conforming principal class found in %@
unable to load plugin bundle %@: %@
ERROR: %@ attempting to register multiple sync transformers for kinds: {%@}
registered transformers:
%@ => %@
@"NSNumber"16@?0@"NSString"8
CRPowerMonitorDeviceWillLockNotification
CRPowerMonitorDeviceLockedStateKey
com.apple.corerecents.sblockqueue
v12@?0i8
.StateUnknown
.StateSignedIn
.StateSignedInWithLocalDataRemoved
.StateSignedOut
-[CRSQLiteConnectionPool initWithDelegate:maxConcurrentReaders:]
CRSQLiteConnectionPool.m
maxConcurrentReaders > 0
-[CRSQLiteConnectionPool checkInConnection:]
nil != connectionWrapper
-journal
-wal
-shm
unhandled expression type
expected only NSString, NSNumber and NSNull types, got %@
count
operator
predicate
-[NSCompoundPredicate(PredicateBindings) cr_simplifiedPredicateSingleStep]
NSPredicateBindings.m
1 == count
0 && "unknown compound predicate type"
 AND 
 OR 
tokenSearch:
prefixSearch:
phoneSearch:
%@%@ == ?
%@%@ != ?
%@%@ < ?
%@%@ <= ?
%@%@ >= ?
%@%@ > ?
%@%@ BETWEEN ? AND ?
%@%@ IN (?
%%@%@(%%@, ?, %d)
%%@%@(%%@, ?, %ld)
-[NSComparisonPredicate(PredicateBindings) cr_addToClause:usingOperator:bindings:]
0 && "should be impossible to get here if we verified everything correctly ahead of time"
groupName
sendingAddress
failed to find collections for field '%@'
unexpected kind of predicate present
%@recents.rowid IN (
      SELECT contacts.recent_id
        FROM contacts
        JOIN recents ON (recents.ROWID = contacts.recent_id)
       WHERE 
    recents.count = 1
contacts.address
contacts.display_name
recents.display_name
recents.sending_address
<%@:%p; %@ kinds={%@}>
.SignedOut
.SignedInWithPreviousAccount
.SignedInWithNewAccount
.SwitchedAccount
CRAccountAdaptor.m
Use designated initializer.
LastiCloudAccountPersonID
LastiCloudAccountWasLoggedIn
v20@?0@"NSString"8B16
-[CRAccountAdaptor _delegateAccountChanges]
v32@?0r*8Q16^B24
collation
search
AppleCollationOrder
AppleLanguages
v16@?0@8
@"<CNCancelable>"16@?0@"<CNObserver>"8
Failed to open ICUSQLite collator: %s
CRDelayedWorkQueue
CRMailAccountIterator
CRAgent
NSXPCListenerDelegate
NSObject
_CRRecentsSQLiteConnectionWrapper
_CRRecentsLibrary
CRSQLiteConnectionPoolDelegate
CRRecentsMigratorDelegate
CRUbiquitousCoordinatorDelegate
CRProcessTransaction
CRRecentsMigrator
CRDClient
CRDRecentContactsLibrary
CRDRecentContactsLibraryProtocol
CRSQLiteConnection
CRAddressHandler
CRPluginManager
CRMailAccountAnalyzer
CRPowerMonitor
CRPowerAssertion
CRUbiquitousCoordinator
CRAccountAdaptorDelegate
CRSQLiteConnectionPool
_CRSQLiteConnectionWrapper
_CRPhoneSearchCache
PredicateBindings
PredicateBindingsInternal
_ClauseGenerationContext
CRPhoneSearch
CRAddressHandlerIdentity
CRAccountAdaptor
CRSearchMatcher
CRWeakReference
CRAccountListener
@16@0:8
v16@0:8
v24@0:8@16
B40@0:8@16d24@?32
{os_unfair_lock_s="_os_unfair_lock_opaque"I}
@"NSObject<OS_dispatch_queue>"
@"NSMutableDictionary"
@24@0:8@16
v24@0:8@?16
@"ACAccountStore"
B24@0:8@16
#16@0:8
@24@0:8:16
@32@0:8:16@24
@40@0:8:16@24@32
B16@0:8
B24@0:8#16
B24@0:8:16
Vv16@0:8
Q16@0:8
^{_NSZone=}16@0:8
B24@0:8@"Protocol"16
@"NSString"16@0:8
B32@0:8@16@24
B32@0:8@"NSXPCListener"16@"NSXPCConnection"24
v20@0:8B16
@"NSXPCListener"
@"_CRRecentsLibrary"
@"NSMutableSet"
@28@0:8@16B24
@"CRSQLiteConnection"
@"CRSQLiteConnection"24@0:8@"CRSQLiteConnectionPool"16
@32@0:8@16@24
@"NSString"32@0:8@"NSString"16@"NSString"24
v28@0:8@16B24
v24@0:8Q16
v28@0:8@"NSString"16B24
v20@0:8i16
i32@0:8^{sqlite3=}16@24
i28@0:8@16i24
i24@0:8@16
@20@0:8B16
v28@0:8@?16B24
@80@0:8^{sqlite3_stmt=}16{?={?=iiiiiiii}{?=iiiii}}24B76
@48@0:8@16@24^@32^@40
@?24@0:8@16
@32@0:8@16^@24
@24@0:8q16
@92@0:8^{sqlite3_stmt=}16{?={?=iiiiiiii}{?=iiiii}}24Q76Q84
v32@0:8@16@?24
v44@0:8@16@24@32B40
Q24@0:8@16
B32@0:8Q16@24
Q32@0:8@16Q24
v32@0:8Q16@24
v32@0:8@16d24
@48@0:8@16@24^@32@40
@48@0:8Q16@24^@32@40
B36@0:8@16B24^@28
v32@0:8@16^{sqlite3_stmt=}24
v40@0:8@16q24^{sqlite3_stmt=}32
v40@0:8@16@24@32
Q48@0:8@16@24@32@40
v32@0:8@16@24
B40@0:8@16@24@32
d16@0:8
v24@0:8d16
@"NSString"
@"CRPluginManager"
@"CRSQLiteConnectionPool"
@"CRRecentsMigrator"
@"<CRAccountAdaptor>"
@"NSLock"
^{__CFDictionary=}
@"CRDelayedWorkQueue"
@"CRUbiquitousCoordinator"
@"NSObject<OS_os_transaction>"
v28@0:8i16@20
B28@0:8@16i24
@"<CRRecentsMigratorDelegate>"
@"NSXPCConnection"
v56@0:8@16@24@32@40@?48
v32@0:8@"CRSearchQuery"16@?<v@?@"NSArray"@"NSError">24
v56@0:8@"NSArray"16@"NSString"24@"NSString"32@"NSString"40@?<v@?@"NSError">48
v40@0:8@"NSArray"16@"NSArray"24@"NSString"32
v24@0:8@?<v@?@"NSError">16
@24@0:8@?16
@"CRDClient"
r*16@0:8
i16@0:8
^{sqlite3_stmt=}24@0:8@16
i20@0:8i16
^{sqlite3=}16@0:8
^{sqlite3=}
@"NSObject<OS_os_log>"
@"NSSet"16@0:8
@"CNCache"
@"NSLocale"
@32@0:8@16d24
v32@0:8@16q24
v32@0:8@"<CRAccountAdaptor>"16q24
@"<CRUbiquitousCoordinatorDelegate>"
@32@0:8@16Q24
@"<CRSQLiteConnectionPoolDelegate>"
@"NSObject<OS_dispatch_semaphore>"
@24@0:8r*16
@"NSCache"
@"CRPhoneSearch"
@"NSDictionary"
@"NSMutableArray"
@32@0:8^{__CFString=}16^{__CFString=}24
B32@0:8r*16Q24
@"NSSet"
@24@0:8#16
@"<CRAddressHandler>"
@"CRAddressHandlerIdentity"
B24@0:8@"NSString"16
@40@0:8@16@24@32
@"CRMailAccountAnalyzer"
@"<CNCancelable>"
@"NSUserDefaults"
@"<CRAccountAdaptorDelegate>"
B28@0:8r*16i24
B24@0:8r*16
@36@0:8@16@24i32
@28@0:8@16i24
@"NSArray"
@"NSData"
@32@0:8@16@?24
dropping unentitled connection %{public}@
dropping connection %{public}@ because library is not available (probable cause: device not unlocked after boot)
Connection %p for %{public}@ was invalidated.
Connection %p for %{public}@ was interrupted.
Warning: getting writer connection on the main thread
No hash for contact %@
canceling any pending expunge for domain %{public}@
performing pending expunge for domain %{public}@
scheduled pending expunge after %.2fs for domain %{public}@
No hash for old recent with rowid %@ and kind %@
Found %lu recents over age limit for domain %{public}@
No hash for recent with rowid %@
Found %lu individual recents over hard limit for domain %{public}@
No hash for group recent with rowid %@
Found %lu group recents over hard limit for domain %{public}@
Expunging %lu recents over limit for bundle identifier %{public}@
No hash for row %@
No hash for recent %@
**** SQLITE ERROR: %s
deleting contact from '%{public}@' with record hash: [%{public}@]
deleting recent from remote store for domain '%{public}@' with key %{public}@
No hash for domain %@
deleting contacts from '%{public}@' with recent IDs: [%{public}@]
deleting recents from remote store for domain '%{public}@' with keys %{public}@
Attempt to remove invalid contact (h=%{public}@, b=%{public}@): %{public}@
Initializing KVS store (%{public}@: %{public}@)
reason:%{public}@ recentsDomain:%{public}@
Received external KVS change event: (%{public}@) %{public}@, changed keys=%{public}@
iCloud Key Value Store Over-Quota: %{public}@
After expunging, store has %lu entries
%{public}@: %{public}@
Syncing back local changes
Finished handling cloud store change
numChanges:%lu store:%{public}@ recentsDomain:%{public}@
Recent with hash '%{public}@' was removed from the cloud store, removing from local store
removing corrupted recent group %{public}@: %{public}@
calculated hash doesn't match reference key: %@ != %@, %@
MERGE: Skipping display name %{public}@
MERGE: Merged in local changes %{public}@ for contact %{public}@
MERGE: Skipping merging contact %{public}@ because we saw no dates %{public}@
Account with address %{public}@ is denying sync of contacts, skipping %{public}@
Contact with address %{public}@ has kind we don't know how to sync, %{public}@
SYNC: Skipped syncing contact because we could not calculate sync key: %{public}@
SYNC: Skipped syncing contact because there's not a sync transformer registered for address kind '%{public}@': %{public}@
SYNC: skipped syncing contact because not all members have an address or kind: %{public}@
SYNC: Skipping display name %{public}@
SYNC: Merged local changes from %{public}@: remote=%{public}@
merge=%{public}@
SYNC: Skipped syncing contact because we had no dates: %{public}@
Scheduled synchronization with iCloud store (%{public}@) %{public}@ after %.2fs
Synchronizing with iCloud store (%{public}@) %{public}@: %{public}@
Synchronizing with iCloud stores %{public}@
Removing local records for domain %{public}@
Removed %lu record(s)
Merge cloud data one-way into local with reason: %{public}@
wrong number of arguments (%d) to %s
Will execute query %{public}@ for %{public}@
Database connection unavailable
Query %{public}@ failed: %{public}@
Did execute query %{public}@ (%{public}@)
Closing sqlite connection %p
Will prepare statement for pattern: %@
Initializing cache
Cache hit
Cache miss
Prep time: %.3fms
SQLite I/O error (%d): %s
SQLite error (%d): %s
Did prepare statement in %.3fms
Observed iCloud account transition %@
Setting state for domain:%{public}@ -> %{public}@
Removing local records for all domains
Error %d on connection %p %{public}@: %s - I/O error %d (%s)
Error %d on connection %p %{public}@: %s
wrong number of arguments (%d) to icusearch
wrong number of arguments (%d) to cpsearch
wrong number of arguments (%d) to phonesearch
Renaming database %{public}@ to %{public}@
Removing database %{public}@
%s old:%{public}@ current:%{public}@
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>CFBundleDevelopmentRegion</key>
<string>English</string>
<key>CFBundleExecutable</key>
<string>recentsd</string>
<key>CFBundleIconFile</key>
<string></string>
<key>CFBundleIdentifier</key>
<string>com.apple.corerecents.recentsd</string>
<key>CFBundleInfoDictionaryVersion</key>
<string>6.0</string>
<key>CFBundleName</key>
<string>recentsd</string>
<key>CFBundlePackageType</key>
<string>APPL</string>
<key>CFBundleShortVersionString</key>
<string>1.0</string>
<key>CFBundleSignature</key>
<string>????</string>
<key>CFBundleVersion</key>
<string>1</string>
</dict>
</plist>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>com.apple.mobilemail.mailservices</key>
<true/>
<key>com.apple.private.accounts.allaccounts</key>
<true/>
<key>com.apple.private.tcc.allow.overridable</key>
<array>
<string>kTCCServiceCalendar</string>
<string>kTCCServiceReminders</string>
</array>
<key>com.apple.private.ubiquity-additional-kvstore-identifiers</key>
<array>
<string>com.apple.mail.recents</string>
<string>com.apple.facetime.recents</string>
<string>com.apple.calendar.recents</string>
<string>com.apple.eventkit.locations</string>
<string>com.apple.passbook.locations</string>
</array>
<key>com.apple.wifi.manager-access</key>
<true/>
</dict>
</plist>
