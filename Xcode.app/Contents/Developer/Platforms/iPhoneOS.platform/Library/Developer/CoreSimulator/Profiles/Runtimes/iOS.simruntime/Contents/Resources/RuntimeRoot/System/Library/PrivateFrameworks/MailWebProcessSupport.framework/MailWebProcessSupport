EFPropertyKey_contentID
EFPropertyKey_uttype
EFPropertyKey_data
EFPropertyKey_additionalMarkup
-[MSComposeBundlePageController observerProxy]
MSComposeBundlePageController.m
v8@?0
changeQuoteLevel
stack
JavaScript exception: %@:%@:%@: %@
sourceURL
line
column
v24@?0@"JSContext"8@"JSValue"16
addEventListener
unhandledrejection
reason
v16@?0@"JSValue"8
MailSupport/BodyField.js
MailSupport/Constants.js
MailSupport/DocumentExtras.js
MailSupport/ElementExtras.js
MailSupport/HTMLDocumentExtras.js
MailSupport/HTMLElementExtras.js
MailSupport/NodeExtras.js
MailSupport/RangeExtras.js
NSUTF8StringEncoding
NSURL
Range
prototype
@"NSString"8@?0
text
String
B8@?0
ef_isWebAddress
com.apple.email
MSPDFAttachmentController.m
Delegate is missing to update attachment
(%{public}@) Attachment is not a PDF
(%{public}@) Data is missing
(%{public}@) Could not create PDF document from data
(%{public}@) Attached PDF has %lu pages, isLocked=%{BOOL}d
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";const _appendTextFromDOMRange=function(e,t,n,i){let o=t.text();if(o){e||(e=[]);let t=o;t=t.replace(/\xa0/g," "),i&&"\n"!==o.charAt(o.length-1)&&(t+="\n"),e.push([t,n])}return e},MFCreatePlainTextRepresentationFromDOMDocument=function(e,t,n){let i,o=[],r=e.body,l=e.createRange(),a=0;l.setStartBefore(r);let d=r.firstChild;for(;d&&r!==d;){let e,r=d.firstChild,s=d.mf_quoteLevelDelta(),f=t?t(d):undefined;if(n&&d instanceof HTMLAnchorElement){let t=document.createRange();t.selectNode(d),e=`${t.text()} <${d.href}>`}for((f||e||0!==s)&&(l.setEndBefore(d),i=_appendTextFromDOMRange(i,l,a,0!==s),l.collapse()),e&&(i&&(o.push(i),i=null),o.push([[e,a]]),l.setStartAfter(d)),f&&(i&&(o.push(i),i=null),o.push(f)),a+=s;!r&&d;){let e=d.mf_quoteLevelDelta();0!==e&&(l.setEndAfter(d),i=_appendTextFromDOMRange(i,l,a,!0),l.collapse(),a-=e);let t=d.nextSibling;r=t,d=t=d.parentNode}d=r}return l.setEndAfter(r),(i=_appendTextFromDOMRange(i,l,a,!1))&&o.push(i),o.length||((i=[]).push(["",0]),o=[i]),o},_copyHtmlStringFromRange=function(e,t,n,i,o,r,l,a){let d,s,f,c=e.body,m=t.startContainer.mf_commonAncestorWithNode(t.endContainer),h=t.cloneContents();if(i&&!o||h.recursivelyRemoveMailAttributes(!i,o,!1),h){let t,n,o=!0;for(t=m;o&&t;t=t.parentNode)o=c!==t;if(!o)for(t=m;t;t=t.parentNode){let e=t.cloneNode();if(e.appendChild(h),h=e,n=t,t===c){m=t.parentNode;break}}let r=e.head?e.head.cloneNode(!0):e.createElement("head");for(i||(f=r.querySelector("meta[http-equiv=Content-Type]"))||(f=e.createElement("meta"),r.appendChild(f)),h.insertBefore(r,h.firstChild),t=m;t&&e!==t;t=t.parentNode){let e,i=t.cloneNode();if(o&&n)for(e=i.firstChild;e&&n!==e;e=e.nextSibling){let t=e.cloneNode(!0);t&&i.appendChild(t)}if(h&&i.appendChild(h),o&&n)for(e=n.nextSibling;e;e=e.nextSibling){let t=e.cloneNode(!0);t&&i.appendChild(t)}o||(o=c===t),h=i,n=t}}if(h){if(h.normalize(),r){let e;if("html"===h.nodeName.toLowerCase()){let t=h.firstChild;for(;t;){if("body"===t.nodeName.toLowerCase()){e=t;break}t=t.nextSibling}}if(e){e.removeAttribute("id"),e.removeAttribute("contenteditable"),e.removeAttribute("style");let t=e.getElementsByTagName("IMG");for(let e=0;e<t.length;e++){let n,i=t.item(e);try{n=new URL(i.src)}catch(e){}n!==undefined&&"file:"===n.protocol&&i.setAttribute("SRC","cid:"+n.pathname.substring(1))}}}if(a&&h.querySelectorAll("attachment, img").forEach(a),s=charsetForString(h.outerHTML,n),i||(f.httpEquiv="content-type",f.content="text/html; charset="+s.charsetName()),l){let e=h.ownerDocument.createRange();e.selectNodeContents(h),e.linkify()}d=h.outerHTML}return{string:d,charset:s}},_isSelectionPlaceholderNode=function(e){return e instanceof HTMLElement&&(e.id!==MFHtmlIDSelectionStart&&e.id!==MFHtmlIDSelectionEnd)};Object.defineProperty(this,"BodyField",{value:function(){addEventListener("beforeinput",e=>{if("insertParagraph"!==e.inputType||this._insertingNewlineInQuotedContent)return;let t=e.getTargetRanges()[0];t&&t.startContainer.mf_isQuoteOrWithinQuote()&&(e.preventDefault(),this._insertingNewlineInQuotedContent=!0,document.execCommand("InsertNewlineInQuotedContent"),this._insertingNewlineInQuotedContent=!1)})}}),BodyField.prototype={constructor:BodyField},BodyField.prototype.insertNodeWithParentAndNextSibling=function(e,t,n){if(t&&e)if(Node.DOCUMENT_FRAGMENT_NODE===e.nodeType){let i;for(;i=e.firstChild;)this.insertNodeWithParentAndNextSibling(i,t,n)}else if(n){if(!t.isSameNode(n.parentNode))return;t.insertBefore(e,n),_isSelectionPlaceholderNode(e)&&(this._dirty=!0)}else t.appendChild(e)},BodyField.prototype.insertNodeWithParentAndOffset=function(e,t,n){let i,o=t.childNodes;if(t&&n<=o.length)if(Node.DOCUMENT_FRAGMENT_NODE===e.nodeType){let i;for(;i=e.firstChild;)this.insertNodeWithParentAndOffset(i,t,n++)}else n===o.length?t.appendChild(e):(i=o.item(n),t.insertBefore(e,i)),_isSelectionPlaceholderNode(e)&&(this._dirty=!0)},BodyField.prototype.deleteNode=function(e){let t=e.parentNode;if(t){e.nextSibling;t.removeChild(e),_isSelectionPlaceholderNode(e)&&(this._dirty=!0)}},BodyField.prototype.selectionIsWebAddress=function(){let e=window.getSelection();if(!e.rangeCount)return!1;let t=e.getRangeAt(0);return!!t&&t.toString().ef_isWebAddress()},BodyField.prototype._canonicalizeSelection=function(e){let t,n,i,o,r=e.startContainer,l=e.endContainer,a=e.startOffset,d=e.endOffset,s=r===l;if(r instanceof Text)if(t=r.parentNode,a)if(a>=r.length)n=r.nextSibling;else{let e=r.cloneNode(!1),i=e.splitText(a);this.insertNodeWithParentAndNextSibling(e,t,r),this.insertNodeWithParentAndNextSibling(i,t,r),this.deleteNode(r),s&&(d-=Math.min(d,a),l=i),n=i}else n=r;else{for(n=r.firstChild;a--;)n=n.nextSibling;t=r}if(l instanceof Text)if(i=l.parentNode,d)if(d>=l.length)o=l.nextSibling;else{let e=l.cloneNode(!1),t=e.splitText(d);this.insertNodeWithParentAndNextSibling(e,i,l),this.insertNodeWithParentAndNextSibling(t,i,l),s&&l===n&&(n=e),this.deleteNode(l),o=t}else o=l;else{for(o=l.firstChild;d--;)o=o.nextSibling;i=l}return{startParent:t,startNextSibling:n,endParent:i,endNextSibling:o}},BodyField.prototype.deleteRange=function(e){let t=e.commonAncestorContainer,{startParent:n,startNextSibling:i,endParent:o,endNextSibling:r}=this._canonicalizeSelection(e),l=i;for(;l&&(!r||!r.isSameNode(l));)if(r&&r.mf_isDescendantOfNode(l)||!l.isSameNode(o)&&o.mf_isDescendantOfNode(l))l=l.mf_traverseNextNodeStayingWithin(t);else{let e=l.mf_traverseNextSiblingStayingWithin(t);if(this.deleteNode(l),l.isSameNode(o))break;l=e}},BodyField.prototype.splitUpBlockQuotesOverlappingStartOfRange=function(e){let t,n,i,o,r,l,a;for(e.mf_hoistRange(),n=e.mf_firstNode(),i=e.mf_lastNode(),t=(r=n).mf_containingBlockQuote();t;)n.mf_isAtBeginningOfContainerNode(t)?r=r.parentNode:((l=n.ownerDocument.createRange()).setStartBefore(t.firstChild),l.setEndBefore(n),a=l.cloneContents(),(o=n.ownerDocument.mf_createMessageQuoteElement()).appendChild(a),this.deleteRange(l),this.insertNodeWithParentAndNextSibling(o,t.parentNode,t),e.setStartBefore(n),e.setEndAfter(i),r=o.parentNode),t=r.mf_containingBlockQuote()},BodyField.prototype.splitUpBlockQuotesOverlappingEndOfRange=function(e){let t,n,i,o,r,l,a;for(n=e.mf_firstNode(),t=(o=i=e.mf_lastNode()).mf_containingBlockQuote();t;)i.mf_isAtEndOfContainerNode(t)?o=o.parentNode:((l=n.ownerDocument.createRange()).setStartBefore(t.firstChild),l.setEndAfter(e.mf_lastNode()),a=l.cloneContents(),r=n.ownerDocument.mf_createMessageQuoteElement(),n.mf_isDescendantOfNode(t)&&(n=a.firstChild),i=a.lastChild,r.appendChild(a),this.deleteRange(l),this.insertNodeWithParentAndNextSibling(r,t.parentNode,t),e.setStartBefore(n),e.setEndAfter(i),o=r.parentNode),t=o.mf_containingBlockQuote()},BodyField.prototype.replaceNode=function(e,t){e&&t&&(this.insertNodeWithParentAndNextSibling(e,t.parentNode,t),this.deleteNode(t))},BodyField.prototype.removeBlockQuoteFromTree=function(e){let t,n,i=e.parentNode,o=!1,r=e.ownerDocument.createNodeIterator(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);for(t=r.nextNode();t;t=r.nextNode())if(t!==e&&t.mf_blockNodeAncestor()===e){o=!0;break}for(n=e,o&&(i=e.ownerDocument.createElement("div"),n=null);t=e.firstChild;)this.deleteNode(t),this.insertNodeWithParentAndNextSibling(t,i,n);o?this.replaceNode(i,e):this.deleteNode(e)},BodyField.prototype.temporaryEndingSelectionMarker=function(){let e=[window],t=e.length;for(;t>0;){let n,i=e[0];try{n=i.document}catch(e){}if(e.shift(),t--,n instanceof HTMLDocument){let e=n.mf_findElement("SPAN",MFHtmlTemporaryEditingElement,MFHtmlIDSelectionEnd);if(e)return e}let o=i.frames;o.length&&(t+=o.length,e=e.concat(Array.from(o)))}return undefined},BodyField.prototype.insertTemporarySelectionMarkersForRange=function(e){let t=e;if(!t){let e=getSelection();e.rangeCount&&(t=e.getRangeAt(0))}let n;if(t){let{startParent:e,startNextSibling:i,endParent:o,endNextSibling:r}=this._canonicalizeSelection(t),l=e.ownerDocument;if(l&&l instanceof HTMLDocument){let t=l.createElement("SPAN");t.className=MFHtmlTemporaryEditingElement,t.id=MFHtmlIDSelectionEnd,this.insertNodeWithParentAndNextSibling(t,o,r),(n=l.createElement("SPAN")).className=MFHtmlTemporaryEditingElement,n.id=MFHtmlIDSelectionStart,this.insertNodeWithParentAndNextSibling(n,e,t)}}return n},BodyField.prototype.restoreSelectionFromTemporaryMarkers=function(e){let t=[window],n=t.length;for(;n>0;){let i,o=t[0];try{i=o.document}catch(e){}if(t.shift(),n--,i instanceof HTMLDocument){let t=e?undefined:MFHtmlTemporaryEditingElement,n=i.mf_findElement("SPAN",t,MFHtmlIDSelectionStart),o=i.mf_findElement("SPAN",t,MFHtmlIDSelectionEnd);if(n||o){let e=i.createRange();n&&e.setStartBefore(n),o&&e.setEndBefore(o),n||e.collapse(!1),o||e.collapse(!0),n&&this.deleteNode(n),o&&this.deleteNode(o);let t=window.getSelection();t.empty(),t.addRange(e)}}let r=o.frames;r.length&&(n+=r.length,t=t.concat(Array.from(r)))}},BodyField.prototype.changeQuoteLevel=function(e){let t=getSelection();if(!t.rangeCount)return;let n=!1,i=t.getRangeAt(0),o=i.startContainer.ownerDocument;if(i.mf_hoistRange(),!i.collapsed&&e>0){let e=i.endContainer;if(e instanceof Text&&!i.endOffset){let t=e.previousSibling;"blockquote"===t.nodeName.toLowerCase()&&i.setEnd(t,t.childNodes.length)}}this.insertTemporarySelectionMarkersForRange(i);let{parent:r,nextSibling:l}=i.mf_getBlockBoundaryParentAndNextSibling(!0),{parent:a,nextSibling:d}=i.mf_getBlockBoundaryParentAndNextSibling(!1),s=o.createRange();if(l)s.setStartBefore(l);else{let e=r.lastChild;e||(e=r),s.setStartAfter(e)}if(d)s.setEndBefore(d);else{let e=a.lastChild;e||(e=a),s.setEndAfter(e)}let f;if(1===e){let e,t,i,r,c;if(f=o.mf_createMessageQuoteElement(),(c=s.cloneContents())&&f.appendChild(c),f.mf_containsOnlySelectionMarkers()&&f.mf_appendBlockPlaceholder(),n=!0,i=s.startContainer,r=s.endContainer,i===r)this.insertNodeWithParentAndNextSibling(f,i,l),s.setStartAfter(f),d?s.setEndBefore(d):s.setEndAfter(a),this.deleteRange(s);else if((e=s.commonAncestorContainer)===r){for(this.deleteRange(s),t=d;t&&t.parentNode!==e;)t=t.parentNode;this.insertNodeWithParentAndNextSibling(f,e,t)}else if(e===i)this.deleteRange(s),this.insertNodeWithParentAndOffset(f,e,s.startOffset);else{if(this.splitUpBlockQuotesOverlappingStartOfRange(s),this.splitUpBlockQuotesOverlappingEndOfRange(s),f=o.mf_createMessageQuoteElement(),(c=s.cloneContents())&&f.appendChild(c),f.mf_containsOnlySelectionMarkers()&&f.mf_appendBlockPlaceholder(),"blockquote"===(e=s.commonAncestorContainer).nodeName.toLowerCase())s.setStart(e,0),t=undefined,this.deleteRange(s);else{let n=s.endContainer;for(let t=n.parentElement;t!==e;t=t.parentElement)n=t;t=n.nextSibling,this.deleteRange(s),n.parentElement===e&&(t=n)}this.insertNodeWithParentAndNextSibling(f,e,t)}}else if(-1===e){let e,t,i,o,r;for(this.splitUpBlockQuotesOverlappingStartOfRange(s),this.splitUpBlockQuotesOverlappingEndOfRange(s),e=s.mf_lastNode(),i=s.mf_firstNode(),r=!1;!r&&i;)(o=(t=i).mf_highestContainingBlockQuote())||(o=t.mf_firstDescendantBlockQuote()),o?(r=e.mf_isDescendantOfNode(o),i=o.mf_nextSiblingOrAunt(),this.removeBlockQuoteFromTree(o),n=!0):(r=e.mf_isDescendantOfNode(t)||t.mf_isDescendantOfNode(e),i=t.mf_nextSiblingOrAunt())}return f&&this.temporaryEndingSelectionMarker()===f.lastChild&&f.parentNode.insertBefore(this.temporaryEndingSelectionMarker(),f.nextSibling),this.restoreSelectionFromTemporaryMarkers(),n},BodyField.prototype.convertInternalImagesToAttachments=function(e,t,n){let i={};for(let e of document.querySelectorAll("img")){let o=e.src;if(!o||!o.startsWith("cid:"))continue;let r=t[o];r&&(e.removeAttribute("src"),i[HTMLAttachmentElement.getAttachmentIdentifier(e)]=new NSURL(o),n&&n(e,r))}return i},BodyField.prototype.replacePlaceholderWithAttachment=function(e,t){let n;if(t.isImage){let t=document.createElement("img");e.replaceWith(t),n=HTMLAttachmentElement.getAttachmentIdentifier(t)}else{let t=document.createElement("attachment");e.replaceWith(t),n=t.uniqueIdentifier}return n},BodyField.prototype.convertObjectElementsToAttachmentElements=function(e,t){let n={};for(let i of e.querySelectorAll("object[type='application/x-apple-msg-attachment']")){let e=i.getAttribute("data"),o=new NSURL(e);if(!o)continue;let r=t[e];r&&(n[this.replacePlaceholderWithAttachment(i,r)]=o)}return n},BodyField.prototype.replaceRangeWithNode=function(e,t){e.deleteContents(),e.insertNode(t)};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";const MFContentIDScheme="cid",MFHtmlIDSelectionEnd="x-apple-selection:end",MFHtmlIDSelectionStart="x-apple-selection:start",MFHtmlTemporaryEditingElement="AppleTemporaryEditingElement",MFHtmlTemporaryPresentationElement="AppleTemporaryPresentationElement",MFMailDropBannerClass="x-apple-maildropbanner",MFMailDropItemClass="x-apple-maildrop",MFHtmlIDSignature="AppleMailSignature";
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";Document.prototype.createBlockPlaceholder=function(){let e=this.createElement("BR");return e.className="webkit-block-placeholder",e};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";Element.prototype.isRichTextElementType=function(){let e=this.nodeName.toUpperCase();return-1!==["B","I","U","H1","H2","H3","H4","H5","H6","A","TABLE","BDO","FONT","CODE","TT","UL","LI","OL","STYLE","STRIKE"].indexOf(e)},Element.prototype.hasMarginsOfZero=function(){let e;if(!this.hasAttribute("style"))return!1;e=this.style;for(let t of["margin-top","margin-bottom","margin-left","margin-right"]){let S=e.getPropertyCSSValue(t);if(!S||S.getFloatValue(S.primitiveType))return!1}return!0};const _isZeroColorComponent=function(e){return!e||0===e.getFloatValue(CSSPrimitiveValue.CSS_NUMBER)},_isBlackCSSColorValue=function(e){if(!e)return!0;let t=!1;switch(e.cssValueType){case CSSValue.CSS_VALUE_LIST:{let S=e;S.length>0&&(t=_isBlackCSSColorValue(S.item(0)))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let S=e,i=S.primitiveType;if(CSSPrimitiveValue.CSS_RGBCOLOR===i){let e=S.getRGBColorValue();t=!e||_isZeroColorComponent(e.red)&&_isZeroColorComponent(e.blue)&&_isZeroColorComponent(e.green)}else CSSPrimitiveValue.CSS_IDENT===i&&(t="black"===S.getStringValue().toLowerCase())}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return t},_isMatchingFontFamilyCSSValue=function(e,t){if(!e)return!0;let S=!1;switch(e.cssValueType){case CSSValue.CSS_VALUE_LIST:{let i=e;i.length>0&&(S=_isMatchingFontFamilyCSSValue(i.item(0),t))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{S=!0;let i=e;if(CSSPrimitiveValue.CSS_STRING===i.primitiveType){let e=i.getStringValue();e&&e.length&&(S=t.toLowerCase()===e.toLowerCase())}}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return S},_isMatchingPixelSizeCSSValue=function(e,t){if(!e)return!0;let S=!1;switch(e.cssValueType){case CSSValue.CSS_VALUE_LIST:{let i=e;i.length>0&&(S=_isMatchingPixelSizeCSSValue(i.item(0),t))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let i=e;switch(i.primitiveType){case CSSPrimitiveValue.CSS_PERCENTAGE:case CSSPrimitiveValue.CSS_EMS:case CSSPrimitiveValue.CSS_EXS:case CSSPrimitiveValue.CSS_PX:case CSSPrimitiveValue.CSS_CM:case CSSPrimitiveValue.CSS_MM:case CSSPrimitiveValue.CSS_IN:case CSSPrimitiveValue.CSS_PT:case CSSPrimitiveValue.CSS_PC:try{S=Math.abs(i.getFloatValue(CSSPrimitiveValue.CSS_PX)-t)<.1}catch(e){}}}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return S},lightWeight=Symbol("lightWeight"),normalWeight=Symbol("normalWeight"),heavyWeight=Symbol("heavyWeight"),_isMatchingFontWeightCSSValue=function(e,t){if(!e)return!0;let S,i=t,l=normalWeight;switch(e.cssValueType){case CSSValue.CSS_VALUE_LIST:{let S=e;S.length>0&&_isMatchingFontWeightCSSValue(S.item(0),t)&&(l=i)}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let t=e.primitiveType;l=CSSPrimitiveValue.CSS_STRING===t||CSSPrimitiveValue.CSS_IDENT===t?"normal"===(S=e.getStringValue().toLowerCase())||"400"===S?normalWeight:"bold"===S||"bolder"===S||S>400?heavyWeight:lightWeight:i;break}case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:l=i}return i===l},_isRichFontStyleCSSValue=function(e){if(!e)return!1;let t=e.cssText;return t.length&&"normal"!==t},_isRichTextDecorationStyleCSSValue=function(e){if(!e)return!1;let t=!1;switch(e.cssValueType){case CSSPrimitiveValue.CSS_VALUE_LIST:{let S=e;S.length>0&&(t=_isRichTextDecorationStyleCSSValue(S.item(0)))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let S=e,i=S.primitiveType;if(CSSPrimitiveValue.CSS_STRING===i||CSSPrimitiveValue.CSS_IDENT===i){let e=S.getStringValue().toLowerCase();t="none"!==e&&"inherit"!==e}}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return t},_isRichTextAlignmentStyleCSSValue=function(e){if(!e)return!1;let t=!1;switch(e.cssValueType){case CSSPrimitiveValue.CSS_VALUE_LIST:{let S=e;S.length>0&&(t=_isRichTextAlignmentStyleCSSValue(S.item(0)))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let S=e,i=S.primitiveType;if(CSSPrimitiveValue.CSS_STRING===i||CSSPrimitiveValue.CSS_IDENT===i){let e=S.getStringValue().toLowerCase();t="left"!==e&&"inherit"!==e}}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return t};Element.prototype.isRichTextStyle=function(e){let t=!1;return(t=!_isBlackCSSColorValue(e.getPropertyCSSValue("color")))||(t||(t=!_isMatchingFontFamilyCSSValue(e.getPropertyCSSValue("font-family"),"Helvetica")),t||(t=!_isMatchingPixelSizeCSSValue(e.getPropertyCSSValue("font-size"),defaultComposeFontPixelSize)),t||(t=!_isMatchingFontWeightCSSValue(e.getPropertyCSSValue("font-weight"),normalWeight))),t||(t=_isRichFontStyleCSSValue(e.getPropertyCSSValue("font-style"))),t||(t=_isRichTextDecorationStyleCSSValue(e.getPropertyCSSValue("text-decoration"))),t||(t=_isRichTextAlignmentStyleCSSValue(e.getPropertyCSSValue("text-align"))),t||(t=!!e.getPropertyCSSValue("direction")),t},Element.prototype.isRichTextElement=function(){let e=this.isRichTextElementType();if(!e){let t=this.nodeName.toLowerCase();if("blockquote"===t){let t=this.getAttribute("type");e=!t||"cite"!==t.toLowerCase()}else if("img"===t){if(!(this instanceof HTMLImageElement&&this.attachmentIdentifier)){let t=this.src;t&&(e=new URL(t).protocol!==MFContentIDScheme+":")}}else"p"===t&&(e=!this.hasMarginsOfZero())}if(!e){let t=this.hasAttribute("STYLE")?this.style:undefined;t&&"none"!==t.getPropertyValue("display")&&(e=this.isRichTextStyle(t))}return e||this.getAttribute("class")!==MFMailDropItemClass&&this.getAttribute("class")!==MFMailDropBannerClass||(e=!0),e||this.getAttribute("id")===MFHtmlIDSignature&&(e=!0),e};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";HTMLDocument.prototype.mf_createMessageQuoteElement=function(){let e=this.createElement("BLOCKQUOTE");return e.setAttribute("TYPE","cite"),e},HTMLDocument.prototype.createElementFromMarkup=function(e){let t=this.createElement("template");return t.innerHTML=e,t.content.firstChild},HTMLDocument.mf_listElements=["ul","ol","dl"];
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";HTMLElement.prototype.mf_quoteLevelDelta=function(){if("BLOCKQUOTE"!==this.nodeName.toUpperCase())return 0;let t=this.getAttribute("type");if(t&&"CITE"===t.toUpperCase())return 1;let e=this.getAttribute("class");return e&&"GMAIL_QUOTE"===e.toUpperCase()?1:0};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";Node.prototype.mf_quoteLevelDelta=function(){return 0},Node.prototype.mf_isQuoteOrWithinQuote=function(){let e=this;for(;e;){if(e.mf_quoteLevelDelta()>0)return!0;e=e.parentNode}return!1},Node.prototype.mf_commonAncestorWithNode=function(e){let t,o,n=this;for(;n&&!t;n=n.parentNode)n===e?t=n:(o||(o=new Set),o.add(n));for(;e&&!t;e=e.parentNode)o&&o.has(e)&&(t=e);return t},Node.prototype.mf_appendBlockPlaceholder=function(){let e=this.ownerDocument.createBlockPlaceholder();return e&&this.appendChild(e),e},Node.prototype.mf_containsRichText=function(){let e=!1;this instanceof Element&&(e=this.isRichTextElement());let t=this.firstChild;for(;!e&&t;)e=t.mf_containsRichText(),t=t.nextSibling;return e},Node.prototype.stringValue=function(){let e=this.ownerDocument.createRange();return e.selectNode(this),e.stringValue()},Node.prototype.mf_isBody=function(){return"body"===this.nodeName.toLowerCase()},Node.prototype.mf_traversePreviousNode=function(){let e=this.previousSibling;for(;e&&e.lastChild;)e=e.lastChild;return e||this.parentNode},Node.prototype.mf_traverseNextNodeStayingWithin=function(e){let t=this.firstChild;if(t)return t;if(this.isSameNode(e))return undefined;if(t=this.nextSibling)return t;for(t=this;t&&!t.nextSibling&&(!e||!t.parentNode.isSameNode(e));)t=t.parentNode;return t.nextSibling},Node.prototype.mf_traverseNextSiblingStayingWithin=function(e){let t;if(this.isSameNode(e))return t;if(t=this.nextSibling)return t;for(t=this;t&&!t.nextSibling&&(!e||!t.parentNode.isSameNode(e));)t=t.parentNode;return t.nextSibling},Node.prototype.mf_topmostContainingNodeWithNameInArray=function(e){let t,o=this;for(;o&&!o.mf_isBody();)-1!==e.indexOf(o.nodeName.toLowerCase())&&(t=o),o=o.parentNode;return t},Node.prototype.mf_containsOnlySelectionMarkers=function(){let e=!1;if(this.firstChild){let t=this.firstChild;for(e=!0;t;)t instanceof HTMLElement&&"span"===t.tagName.toLowerCase()&&t.className===MFHtmlTemporaryEditingElement&&!t.firstChild||(e=!1),t=e?t.nextSibling:undefined}else e=!0;return e},Node.prototype.mf_isDescendantOfNode=function(e){let t=this,o=!1;for(;!o&&t;)t===e&&(o=!0),t=t.parentNode;return o},Node.prototype.mf_containingBlockQuote=function(){let e=this;for(;e&&!e.mf_quoteLevelDelta();)e=e.parentNode;return e},Node.prototype.mf_isAtBeginningOfContainerNode=function(e){let t=e;for(;t&&t!==this;)t=t.firstChild;return!!t},Node.prototype.mf_isAtEndOfContainerNode=function(e){let t=e;for(;t&&t!==this;)t=t.lastChild;return!!t},Node.prototype.mf_nextSiblingOrAunt=function(){let e,t=this;for(;!e&&t;)(e=t.nextSibling)||(t=t.parentNode);return e},Node.prototype.mf_highestContainingBlockQuote=function(){let e,t=this.mf_containingBlockQuote();for(;t&&(e=t.parentNode.mf_containingBlockQuote());)t=e;return t},Node.prototype.mf_firstDescendantBlockQuote=function(){let e;if(this.mf_quoteLevelDelta()>0)e=this;else{let t,o=this.childNodes,n=o.length;for(t=0;!e&&t<n;t++)e=o.item(t).mf_firstDescendantBlockQuote()}return e},Node.prototype.mf_blockNodeAncestor=function(){let e=this;for(;!isBlockLevelNode(e)&&"li"!==e.nodeName.toLowerCase();)e=e.parentNode;return e},Node.prototype.mf_findElement=function(e,t,o){e=e.toLowerCase();let n,i,r;if(this instanceof HTMLDocument?(r=this,i=this.body):(r=this.ownerDocument,i=this),i){let s,f=r.createNodeIterator(i,NodeFilter.SHOW_ELEMENT);for(;!n&&(s=f.nextNode());){let i=!0;e&&!(i=i&&s.nodeName.toLowerCase()===e)||(t&&!(i=i&&s.className===t)||o&&!(i=i&&s.id===o)||i&&(n=s))}}return n};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";const blockElementNames=new Set(["HTML","BODY","BR","OL","UL","TD","TH","HR","DD","DL","DT","PRE","BLOCKQUOTE","DIV","P","TR","H1","H2","H3","H4","H5","H6"]),isBlockElementName=function(e){return blockElementNames.has(e)};Range.prototype.stringValue=function(){let e=this.text();return isBlockElementName(this.endContainer.nodeName)&&0===this.endOffset&&(e+="\n"),e},Range.prototype.mf_hoistRange=function(){let e,t=!1;for(e=this.startContainer;!t&&!e.mf_isBody()&&!e.mf_quoteLevelDelta();)t=!0,this.endContainer===e&&(this.startOffset||this.endOffset!==e.childNodes.length||(this.setStartBefore(e),this.setEndAfter(e),e=this.startContainer,t=!1))},Range.prototype.mf_firstNode=function(){let e;if(this.collapsed)return e;let t=this.startContainer,n=this.startOffset,i=!1;if(t instanceof Text)e=(i=n>0)?t.mf_traverseNextNodeStayingWithin():t;else{for(e=t.firstChild;n-- >0;)e=e.nextSibling;e||(e=t.mf_traverseNextSiblingStayingWithin())}return e&&!this.intersectsNode(e)&&(e=undefined),e},Range.prototype.mf_lastNode=function(){let e;if(this.collapsed)return e;let t=this.endContainer,n=this.endOffset,i=!1;if(t instanceof Text)e=(i=n<t.length)?t.mf_traversePreviousNode():t;else{for(e=t.firstChild;--n>0;)e=e.nextSibling;e&&this.endOffset||(e=t.mf_traversePreviousNode())}return e&&!this.intersectsNode(e)&&(e=undefined),e};const IS_BLOCK_ELEMENT_NAME=function(e){const t=["HTML","BODY","BR","LI","OL","UL","TD","TH","HR","DD","DL","DT","PRE","BLOCKQUOTE","DIV","P","TR","H1","H2","H3","H4","H5","H6"];return e&&-1!==t.indexOf(e)},isBlockLevelNode=function(e){let t=!1;return t=!!IS_BLOCK_ELEMENT_NAME(e.nodeName)};Range.prototype.mf_getBlockBoundaryParentAndNextSibling=function(e){let t,n;if(e){let e=this.mf_firstNode(),t=e&&e.mf_topmostContainingNodeWithNameInArray(HTMLDocument.mf_listElements);if(t)return{parent:t.parentNode,nextSibling:t}}else{let e=this.mf_lastNode(),t=e&&e.mf_topmostContainingNodeWithNameInArray(HTMLDocument.mf_listElements);if(t)return{parent:t.parentNode,nextSibling:t.nextSibling}}let i,s,o;if(e?(i=this.startContainer,o=this.startOffset):(i=this.endContainer,o=this.endOffset),i instanceof Text)i=(s=i).parentNode;else for(s=i.firstChild;o-- >0;s=s.nextSibling);for(e&&(s=s?s.previousSibling:i.lastChild);!t&&i;){for(;!t&&s;)isBlockLevelNode(s)?(t=i,n=e||"BR"===s.nodeName.toUpperCase()?s.nextSibling:s):s=e?s.previousSibling:s.nextSibling;s||(isOrContainsBlockLevelNode(i)?(t=i,n=e?t.firstChild:undefined):(s=i,i=i.parentNode))}return{parent:t,nextSibling:n}};const isOrContainsBlockLevelNode=function(e){let t,n=!1;if(IS_BLOCK_ELEMENT_NAME(e.nodeName))n=!0;else for(t=e.firstChild;!n&&t;)n=isOrContainsBlockLevelNode(t),t=t.nextSibling;return n};
MSAttachmentItem
NSSecureCoding
NSCoding
MSComposeBundlePageController
WKWebProcessPlugInLoadDelegate
NSObject
MSBundlePageController
MSComposeBodyFieldController
MSComposeBundlePageControllerExtras
_MSComposeBundlePageControllerNSURL
JSExport
MSPDFAttachmentController
MSMailWebProcessAttachmentProxy
init
copy
contentID
encodeObject:forKey:
uttype
data
additionalMarkup
decodeObjectOfClass:forKey:
supportsSecureCoding
encodeWithCoder:
initWithCoder:
TB,R
initWithContentID:uttype:data:additionalMarkup:
.cxx_destruct
_contentID
_uttype
_data
_additionalMarkup
T@"NSString",R,C,N,V_contentID
T@"UTType",R,N,V_uttype
T@"NSData",R,C,N,V_data
T@"NSString",R,C,N,V_additionalMarkup
setLoadDelegate:
doesNotRecognizeSelector:
addObject:
resumePerformOnPage
firstObject
removeObjectAtIndex:
invokeMethod:withArguments:
performOnPage:
numberWithInteger:
arrayWithObjects:count:
performBodyFieldMethodOnPage:withArguments:
mainFrame
normalWorld
jsContextForWorld:
callStackSymbols
objectForKeyedSubscript:
toString
componentsSeparatedByString:
dictionaryWithObjects:forKeys:count:
stringWithFormat:
exceptionWithName:reason:userInfo:
observerProxy
composeBodyFieldDidThrowException:
setExceptionHandler:
globalObject
jsContext
exceptionHandler
initializeGlobalObject
willSendRequest:
initWithBytes:length:encoding:
stringWithUTF8String:
URLWithString:
evaluateScript:withSourceURL:
setObject:forKeyedSubscript:
currentThis
currentContext
rangeHandleWithJSValue:inContext:
text
ef_isWebAddress
isEqual:
class
self
performSelector:
performSelector:withObject:
performSelector:withObject:withObject:
isProxy
isKindOfClass:
isMemberOfClass:
conformsToProtocol:
respondsToSelector:
retain
release
autorelease
retainCount
zone
hash
superclass
description
debugDescription
TQ,R
T#,R
T@"NSString",R,C
webProcessPlugInBrowserContextController:didStartProvisionalLoadForFrame:
webProcessPlugInBrowserContextController:didReceiveServerRedirectForProvisionalLoadForFrame:
webProcessPlugInBrowserContextController:didCommitLoadForFrame:
webProcessPlugInBrowserContextController:didFinishDocumentLoadForFrame:
webProcessPlugInBrowserContextController:didFailProvisionalLoadWithErrorForFrame:error:
webProcessPlugInBrowserContextController:didFailLoadWithErrorForFrame:error:
webProcessPlugInBrowserContextController:didFinishLoadForFrame:
webProcessPlugInBrowserContextController:didSameDocumentNavigation:forFrame:
webProcessPlugInBrowserContextController:didClearWindowObjectForFrame:inScriptWorld:
webProcessPlugInBrowserContextController:globalObjectIsAvailableForFrame:inScriptWorld:
webProcessPlugInBrowserContextController:willInjectUserScriptForFrame:inScriptWorld:
webProcessPlugInBrowserContextController:didRemoveFrameFromHierarchy:
webProcessPlugInBrowserContextController:didHandleOnloadEventsForFrame:
webProcessPlugInBrowserContextController:didLayoutForFrame:
webProcessPlugInBrowserContextController:renderingProgressDidChange:
webProcessPlugInBrowserContextController:didFirstVisuallyNonEmptyLayoutForFrame:
webProcessPlugInBrowserContextControllerRenderingProgressEvents:
webProcessPlugInBrowserContextController:frame:willSendRequestForResource:request:redirectResponse:
webProcessPlugInBrowserContextController:frame:willSendRequest:redirectResponse:
webProcessPlugInBrowserContextController:frame:didInitiateLoadForResource:request:pageIsProvisionallyLoading:
webProcessPlugInBrowserContextController:frame:didInitiateLoadForResource:request:
webProcessPlugInBrowserContextController:frame:didReceiveResponse:forResource:
webProcessPlugInBrowserContextController:frame:didFinishLoadForResource:
webProcessPlugInBrowserContextController:frame:didFailLoadForResource:error:
initWithPlugIn:contextController:
invalidate
changeQuoteLevelBy:
suspendPerformOnPage
initializeBodyField:
plugIn
controller
jsBodyField
_performOnPageSuspendCount
_blocksToPerformOnPage
_jsBodyField
_plugIn
_controller
_jsContext
T@"<WKWebProcessPlugIn>",R,W,N,V_plugIn
T@"WKWebProcessPlugInBrowserContextController",R,N,V_controller
T@"JSContext",R,N,V_jsContext
T@"JSValue",R,N,V_jsBodyField
T@"<MSComposeBodyFieldObserver>",R,N
initWithString:
absoluteString
scheme
UTF8String
conformsToType:
initWithData:
pageCount
isLocked
delegate
currentHandler
handleFailureInMethod:object:file:lineNumber:description:
attachmentController:updateToInlineAttachment:
updateToInlinePDFAttachmentIfNeeded:
setDelegate:
_delegate
T@"<MSPDFAttachmentControllerDelegate>",W,N,V_delegate
B16@0:8
v24@0:8@16
@24@0:8@16
v24@0:8@"NSCoder"16
@24@0:8@"NSCoder"16
@48@0:8@16@24@32@40
@16@0:8
v16@0:8
@"NSString"
@"UTType"
@"NSData"
B24@0:8@16
#16@0:8
@24@0:8:16
@32@0:8:16@24
@40@0:8:16@24@32
B24@0:8#16
B24@0:8:16
Vv16@0:8
Q16@0:8
^{_NSZone=}16@0:8
B24@0:8@"Protocol"16
@"NSString"16@0:8
v32@0:8@16@24
v40@0:8@16@24@32
v40@0:8@16q24@32
v32@0:8@16Q24
Q24@0:8@16
@56@0:8@16@24Q32@40@48
v52@0:8@16@24Q32@40B48
v48@0:8@16@24Q32@40
v48@0:8@16@24@32Q40
v40@0:8@16@24Q32
v32@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24
v40@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24@"NSError"32
v40@0:8@"WKWebProcessPlugInBrowserContextController"16q24@"WKWebProcessPlugInFrame"32
v40@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24@"WKWebProcessPlugInScriptWorld"32
v32@0:8@"WKWebProcessPlugInBrowserContextController"16Q24
Q24@0:8@"WKWebProcessPlugInBrowserContextController"16
@"NSURLRequest"56@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32@"NSURLRequest"40@"NSURLResponse"48
@"NSURLRequest"48@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24@"NSURLRequest"32@"NSURLResponse"40
v52@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32@"NSURLRequest"40B48
v48@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32@"NSURLRequest"40
v48@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24@"NSURLResponse"32Q40
v40@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32
v48@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32@"NSError"40
@32@0:8@16@24
@32@0:8@"<WKWebProcessPlugIn>"16@"WKWebProcessPlugInBrowserContextController"24
v24@0:8q16
v24@0:8@?16
@"NSMutableArray"
@"JSValue"
@"<WKWebProcessPlugIn>"
@"WKWebProcessPlugInBrowserContextController"
@"JSContext"
@24@0:8@"NSString"16
v24@0:8@"MSAttachmentItem"16
@"<MSPDFAttachmentControllerDelegate>"
EFPropertyKey_contentID
EFPropertyKey_uttype
EFPropertyKey_data
EFPropertyKey_additionalMarkup
-[MSComposeBundlePageController observerProxy]
MSComposeBundlePageController.m
v8@?0
changeQuoteLevel
stack
JavaScript exception: %@:%@:%@: %@
sourceURL
line
column
v24@?0@"JSContext"8@"JSValue"16
addEventListener
unhandledrejection
reason
v16@?0@"JSValue"8
MailSupport/BodyField.js
MailSupport/Constants.js
MailSupport/DocumentExtras.js
MailSupport/ElementExtras.js
MailSupport/HTMLDocumentExtras.js
MailSupport/HTMLElementExtras.js
MailSupport/NodeExtras.js
MailSupport/RangeExtras.js
NSUTF8StringEncoding
NSURL
Range
prototype
@"NSString"8@?0
text
String
B8@?0
ef_isWebAddress
com.apple.email
MSPDFAttachmentController.m
Delegate is missing to update attachment
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";const _appendTextFromDOMRange=function(e,t,n,i){let o=t.text();if(o){e||(e=[]);let t=o;t=t.replace(/\xa0/g," "),i&&"\n"!==o.charAt(o.length-1)&&(t+="\n"),e.push([t,n])}return e},MFCreatePlainTextRepresentationFromDOMDocument=function(e,t,n){let i,o=[],r=e.body,l=e.createRange(),a=0;l.setStartBefore(r);let d=r.firstChild;for(;d&&r!==d;){let e,r=d.firstChild,s=d.mf_quoteLevelDelta(),f=t?t(d):undefined;if(n&&d instanceof HTMLAnchorElement){let t=document.createRange();t.selectNode(d),e=`${t.text()} <${d.href}>`}for((f||e||0!==s)&&(l.setEndBefore(d),i=_appendTextFromDOMRange(i,l,a,0!==s),l.collapse()),e&&(i&&(o.push(i),i=null),o.push([[e,a]]),l.setStartAfter(d)),f&&(i&&(o.push(i),i=null),o.push(f)),a+=s;!r&&d;){let e=d.mf_quoteLevelDelta();0!==e&&(l.setEndAfter(d),i=_appendTextFromDOMRange(i,l,a,!0),l.collapse(),a-=e);let t=d.nextSibling;r=t,d=t=d.parentNode}d=r}return l.setEndAfter(r),(i=_appendTextFromDOMRange(i,l,a,!1))&&o.push(i),o.length||((i=[]).push(["",0]),o=[i]),o},_copyHtmlStringFromRange=function(e,t,n,i,o,r,l,a){let d,s,f,c=e.body,m=t.startContainer.mf_commonAncestorWithNode(t.endContainer),h=t.cloneContents();if(i&&!o||h.recursivelyRemoveMailAttributes(!i,o,!1),h){let t,n,o=!0;for(t=m;o&&t;t=t.parentNode)o=c!==t;if(!o)for(t=m;t;t=t.parentNode){let e=t.cloneNode();if(e.appendChild(h),h=e,n=t,t===c){m=t.parentNode;break}}let r=e.head?e.head.cloneNode(!0):e.createElement("head");for(i||(f=r.querySelector("meta[http-equiv=Content-Type]"))||(f=e.createElement("meta"),r.appendChild(f)),h.insertBefore(r,h.firstChild),t=m;t&&e!==t;t=t.parentNode){let e,i=t.cloneNode();if(o&&n)for(e=i.firstChild;e&&n!==e;e=e.nextSibling){let t=e.cloneNode(!0);t&&i.appendChild(t)}if(h&&i.appendChild(h),o&&n)for(e=n.nextSibling;e;e=e.nextSibling){let t=e.cloneNode(!0);t&&i.appendChild(t)}o||(o=c===t),h=i,n=t}}if(h){if(h.normalize(),r){let e;if("html"===h.nodeName.toLowerCase()){let t=h.firstChild;for(;t;){if("body"===t.nodeName.toLowerCase()){e=t;break}t=t.nextSibling}}if(e){e.removeAttribute("id"),e.removeAttribute("contenteditable"),e.removeAttribute("style");let t=e.getElementsByTagName("IMG");for(let e=0;e<t.length;e++){let n,i=t.item(e);try{n=new URL(i.src)}catch(e){}n!==undefined&&"file:"===n.protocol&&i.setAttribute("SRC","cid:"+n.pathname.substring(1))}}}if(a&&h.querySelectorAll("attachment, img").forEach(a),s=charsetForString(h.outerHTML,n),i||(f.httpEquiv="content-type",f.content="text/html; charset="+s.charsetName()),l){let e=h.ownerDocument.createRange();e.selectNodeContents(h),e.linkify()}d=h.outerHTML}return{string:d,charset:s}},_isSelectionPlaceholderNode=function(e){return e instanceof HTMLElement&&(e.id!==MFHtmlIDSelectionStart&&e.id!==MFHtmlIDSelectionEnd)};Object.defineProperty(this,"BodyField",{value:function(){addEventListener("beforeinput",e=>{if("insertParagraph"!==e.inputType||this._insertingNewlineInQuotedContent)return;let t=e.getTargetRanges()[0];t&&t.startContainer.mf_isQuoteOrWithinQuote()&&(e.preventDefault(),this._insertingNewlineInQuotedContent=!0,document.execCommand("InsertNewlineInQuotedContent"),this._insertingNewlineInQuotedContent=!1)})}}),BodyField.prototype={constructor:BodyField},BodyField.prototype.insertNodeWithParentAndNextSibling=function(e,t,n){if(t&&e)if(Node.DOCUMENT_FRAGMENT_NODE===e.nodeType){let i;for(;i=e.firstChild;)this.insertNodeWithParentAndNextSibling(i,t,n)}else if(n){if(!t.isSameNode(n.parentNode))return;t.insertBefore(e,n),_isSelectionPlaceholderNode(e)&&(this._dirty=!0)}else t.appendChild(e)},BodyField.prototype.insertNodeWithParentAndOffset=function(e,t,n){let i,o=t.childNodes;if(t&&n<=o.length)if(Node.DOCUMENT_FRAGMENT_NODE===e.nodeType){let i;for(;i=e.firstChild;)this.insertNodeWithParentAndOffset(i,t,n++)}else n===o.length?t.appendChild(e):(i=o.item(n),t.insertBefore(e,i)),_isSelectionPlaceholderNode(e)&&(this._dirty=!0)},BodyField.prototype.deleteNode=function(e){let t=e.parentNode;if(t){e.nextSibling;t.removeChild(e),_isSelectionPlaceholderNode(e)&&(this._dirty=!0)}},BodyField.prototype.selectionIsWebAddress=function(){let e=window.getSelection();if(!e.rangeCount)return!1;let t=e.getRangeAt(0);return!!t&&t.toString().ef_isWebAddress()},BodyField.prototype._canonicalizeSelection=function(e){let t,n,i,o,r=e.startContainer,l=e.endContainer,a=e.startOffset,d=e.endOffset,s=r===l;if(r instanceof Text)if(t=r.parentNode,a)if(a>=r.length)n=r.nextSibling;else{let e=r.cloneNode(!1),i=e.splitText(a);this.insertNodeWithParentAndNextSibling(e,t,r),this.insertNodeWithParentAndNextSibling(i,t,r),this.deleteNode(r),s&&(d-=Math.min(d,a),l=i),n=i}else n=r;else{for(n=r.firstChild;a--;)n=n.nextSibling;t=r}if(l instanceof Text)if(i=l.parentNode,d)if(d>=l.length)o=l.nextSibling;else{let e=l.cloneNode(!1),t=e.splitText(d);this.insertNodeWithParentAndNextSibling(e,i,l),this.insertNodeWithParentAndNextSibling(t,i,l),s&&l===n&&(n=e),this.deleteNode(l),o=t}else o=l;else{for(o=l.firstChild;d--;)o=o.nextSibling;i=l}return{startParent:t,startNextSibling:n,endParent:i,endNextSibling:o}},BodyField.prototype.deleteRange=function(e){let t=e.commonAncestorContainer,{startParent:n,startNextSibling:i,endParent:o,endNextSibling:r}=this._canonicalizeSelection(e),l=i;for(;l&&(!r||!r.isSameNode(l));)if(r&&r.mf_isDescendantOfNode(l)||!l.isSameNode(o)&&o.mf_isDescendantOfNode(l))l=l.mf_traverseNextNodeStayingWithin(t);else{let e=l.mf_traverseNextSiblingStayingWithin(t);if(this.deleteNode(l),l.isSameNode(o))break;l=e}},BodyField.prototype.splitUpBlockQuotesOverlappingStartOfRange=function(e){let t,n,i,o,r,l,a;for(e.mf_hoistRange(),n=e.mf_firstNode(),i=e.mf_lastNode(),t=(r=n).mf_containingBlockQuote();t;)n.mf_isAtBeginningOfContainerNode(t)?r=r.parentNode:((l=n.ownerDocument.createRange()).setStartBefore(t.firstChild),l.setEndBefore(n),a=l.cloneContents(),(o=n.ownerDocument.mf_createMessageQuoteElement()).appendChild(a),this.deleteRange(l),this.insertNodeWithParentAndNextSibling(o,t.parentNode,t),e.setStartBefore(n),e.setEndAfter(i),r=o.parentNode),t=r.mf_containingBlockQuote()},BodyField.prototype.splitUpBlockQuotesOverlappingEndOfRange=function(e){let t,n,i,o,r,l,a;for(n=e.mf_firstNode(),t=(o=i=e.mf_lastNode()).mf_containingBlockQuote();t;)i.mf_isAtEndOfContainerNode(t)?o=o.parentNode:((l=n.ownerDocument.createRange()).setStartBefore(t.firstChild),l.setEndAfter(e.mf_lastNode()),a=l.cloneContents(),r=n.ownerDocument.mf_createMessageQuoteElement(),n.mf_isDescendantOfNode(t)&&(n=a.firstChild),i=a.lastChild,r.appendChild(a),this.deleteRange(l),this.insertNodeWithParentAndNextSibling(r,t.parentNode,t),e.setStartBefore(n),e.setEndAfter(i),o=r.parentNode),t=o.mf_containingBlockQuote()},BodyField.prototype.replaceNode=function(e,t){e&&t&&(this.insertNodeWithParentAndNextSibling(e,t.parentNode,t),this.deleteNode(t))},BodyField.prototype.removeBlockQuoteFromTree=function(e){let t,n,i=e.parentNode,o=!1,r=e.ownerDocument.createNodeIterator(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);for(t=r.nextNode();t;t=r.nextNode())if(t!==e&&t.mf_blockNodeAncestor()===e){o=!0;break}for(n=e,o&&(i=e.ownerDocument.createElement("div"),n=null);t=e.firstChild;)this.deleteNode(t),this.insertNodeWithParentAndNextSibling(t,i,n);o?this.replaceNode(i,e):this.deleteNode(e)},BodyField.prototype.temporaryEndingSelectionMarker=function(){let e=[window],t=e.length;for(;t>0;){let n,i=e[0];try{n=i.document}catch(e){}if(e.shift(),t--,n instanceof HTMLDocument){let e=n.mf_findElement("SPAN",MFHtmlTemporaryEditingElement,MFHtmlIDSelectionEnd);if(e)return e}let o=i.frames;o.length&&(t+=o.length,e=e.concat(Array.from(o)))}return undefined},BodyField.prototype.insertTemporarySelectionMarkersForRange=function(e){let t=e;if(!t){let e=getSelection();e.rangeCount&&(t=e.getRangeAt(0))}let n;if(t){let{startParent:e,startNextSibling:i,endParent:o,endNextSibling:r}=this._canonicalizeSelection(t),l=e.ownerDocument;if(l&&l instanceof HTMLDocument){let t=l.createElement("SPAN");t.className=MFHtmlTemporaryEditingElement,t.id=MFHtmlIDSelectionEnd,this.insertNodeWithParentAndNextSibling(t,o,r),(n=l.createElement("SPAN")).className=MFHtmlTemporaryEditingElement,n.id=MFHtmlIDSelectionStart,this.insertNodeWithParentAndNextSibling(n,e,t)}}return n},BodyField.prototype.restoreSelectionFromTemporaryMarkers=function(e){let t=[window],n=t.length;for(;n>0;){let i,o=t[0];try{i=o.document}catch(e){}if(t.shift(),n--,i instanceof HTMLDocument){let t=e?undefined:MFHtmlTemporaryEditingElement,n=i.mf_findElement("SPAN",t,MFHtmlIDSelectionStart),o=i.mf_findElement("SPAN",t,MFHtmlIDSelectionEnd);if(n||o){let e=i.createRange();n&&e.setStartBefore(n),o&&e.setEndBefore(o),n||e.collapse(!1),o||e.collapse(!0),n&&this.deleteNode(n),o&&this.deleteNode(o);let t=window.getSelection();t.empty(),t.addRange(e)}}let r=o.frames;r.length&&(n+=r.length,t=t.concat(Array.from(r)))}},BodyField.prototype.changeQuoteLevel=function(e){let t=getSelection();if(!t.rangeCount)return;let n=!1,i=t.getRangeAt(0),o=i.startContainer.ownerDocument;if(i.mf_hoistRange(),!i.collapsed&&e>0){let e=i.endContainer;if(e instanceof Text&&!i.endOffset){let t=e.previousSibling;"blockquote"===t.nodeName.toLowerCase()&&i.setEnd(t,t.childNodes.length)}}this.insertTemporarySelectionMarkersForRange(i);let{parent:r,nextSibling:l}=i.mf_getBlockBoundaryParentAndNextSibling(!0),{parent:a,nextSibling:d}=i.mf_getBlockBoundaryParentAndNextSibling(!1),s=o.createRange();if(l)s.setStartBefore(l);else{let e=r.lastChild;e||(e=r),s.setStartAfter(e)}if(d)s.setEndBefore(d);else{let e=a.lastChild;e||(e=a),s.setEndAfter(e)}let f;if(1===e){let e,t,i,r,c;if(f=o.mf_createMessageQuoteElement(),(c=s.cloneContents())&&f.appendChild(c),f.mf_containsOnlySelectionMarkers()&&f.mf_appendBlockPlaceholder(),n=!0,i=s.startContainer,r=s.endContainer,i===r)this.insertNodeWithParentAndNextSibling(f,i,l),s.setStartAfter(f),d?s.setEndBefore(d):s.setEndAfter(a),this.deleteRange(s);else if((e=s.commonAncestorContainer)===r){for(this.deleteRange(s),t=d;t&&t.parentNode!==e;)t=t.parentNode;this.insertNodeWithParentAndNextSibling(f,e,t)}else if(e===i)this.deleteRange(s),this.insertNodeWithParentAndOffset(f,e,s.startOffset);else{if(this.splitUpBlockQuotesOverlappingStartOfRange(s),this.splitUpBlockQuotesOverlappingEndOfRange(s),f=o.mf_createMessageQuoteElement(),(c=s.cloneContents())&&f.appendChild(c),f.mf_containsOnlySelectionMarkers()&&f.mf_appendBlockPlaceholder(),"blockquote"===(e=s.commonAncestorContainer).nodeName.toLowerCase())s.setStart(e,0),t=undefined,this.deleteRange(s);else{let n=s.endContainer;for(let t=n.parentElement;t!==e;t=t.parentElement)n=t;t=n.nextSibling,this.deleteRange(s),n.parentElement===e&&(t=n)}this.insertNodeWithParentAndNextSibling(f,e,t)}}else if(-1===e){let e,t,i,o,r;for(this.splitUpBlockQuotesOverlappingStartOfRange(s),this.splitUpBlockQuotesOverlappingEndOfRange(s),e=s.mf_lastNode(),i=s.mf_firstNode(),r=!1;!r&&i;)(o=(t=i).mf_highestContainingBlockQuote())||(o=t.mf_firstDescendantBlockQuote()),o?(r=e.mf_isDescendantOfNode(o),i=o.mf_nextSiblingOrAunt(),this.removeBlockQuoteFromTree(o),n=!0):(r=e.mf_isDescendantOfNode(t)||t.mf_isDescendantOfNode(e),i=t.mf_nextSiblingOrAunt())}return f&&this.temporaryEndingSelectionMarker()===f.lastChild&&f.parentNode.insertBefore(this.temporaryEndingSelectionMarker(),f.nextSibling),this.restoreSelectionFromTemporaryMarkers(),n},BodyField.prototype.convertInternalImagesToAttachments=function(e,t,n){let i={};for(let e of document.querySelectorAll("img")){let o=e.src;if(!o||!o.startsWith("cid:"))continue;let r=t[o];r&&(e.removeAttribute("src"),i[HTMLAttachmentElement.getAttachmentIdentifier(e)]=new NSURL(o),n&&n(e,r))}return i},BodyField.prototype.replacePlaceholderWithAttachment=function(e,t){let n;if(t.isImage){let t=document.createElement("img");e.replaceWith(t),n=HTMLAttachmentElement.getAttachmentIdentifier(t)}else{let t=document.createElement("attachment");e.replaceWith(t),n=t.uniqueIdentifier}return n},BodyField.prototype.convertObjectElementsToAttachmentElements=function(e,t){let n={};for(let i of e.querySelectorAll("object[type='application/x-apple-msg-attachment']")){let e=i.getAttribute("data"),o=new NSURL(e);if(!o)continue;let r=t[e];r&&(n[this.replacePlaceholderWithAttachment(i,r)]=o)}return n},BodyField.prototype.replaceRangeWithNode=function(e,t){e.deleteContents(),e.insertNode(t)};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";const MFContentIDScheme="cid",MFHtmlIDSelectionEnd="x-apple-selection:end",MFHtmlIDSelectionStart="x-apple-selection:start",MFHtmlTemporaryEditingElement="AppleTemporaryEditingElement",MFHtmlTemporaryPresentationElement="AppleTemporaryPresentationElement",MFMailDropBannerClass="x-apple-maildropbanner",MFMailDropItemClass="x-apple-maildrop",MFHtmlIDSignature="AppleMailSignature";
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";Document.prototype.createBlockPlaceholder=function(){let e=this.createElement("BR");return e.className="webkit-block-placeholder",e};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";Element.prototype.isRichTextElementType=function(){let e=this.nodeName.toUpperCase();return-1!==["B","I","U","H1","H2","H3","H4","H5","H6","A","TABLE","BDO","FONT","CODE","TT","UL","LI","OL","STYLE","STRIKE"].indexOf(e)},Element.prototype.hasMarginsOfZero=function(){let e;if(!this.hasAttribute("style"))return!1;e=this.style;for(let t of["margin-top","margin-bottom","margin-left","margin-right"]){let S=e.getPropertyCSSValue(t);if(!S||S.getFloatValue(S.primitiveType))return!1}return!0};const _isZeroColorComponent=function(e){return!e||0===e.getFloatValue(CSSPrimitiveValue.CSS_NUMBER)},_isBlackCSSColorValue=function(e){if(!e)return!0;let t=!1;switch(e.cssValueType){case CSSValue.CSS_VALUE_LIST:{let S=e;S.length>0&&(t=_isBlackCSSColorValue(S.item(0)))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let S=e,i=S.primitiveType;if(CSSPrimitiveValue.CSS_RGBCOLOR===i){let e=S.getRGBColorValue();t=!e||_isZeroColorComponent(e.red)&&_isZeroColorComponent(e.blue)&&_isZeroColorComponent(e.green)}else CSSPrimitiveValue.CSS_IDENT===i&&(t="black"===S.getStringValue().toLowerCase())}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return t},_isMatchingFontFamilyCSSValue=function(e,t){if(!e)return!0;let S=!1;switch(e.cssValueType){case CSSValue.CSS_VALUE_LIST:{let i=e;i.length>0&&(S=_isMatchingFontFamilyCSSValue(i.item(0),t))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{S=!0;let i=e;if(CSSPrimitiveValue.CSS_STRING===i.primitiveType){let e=i.getStringValue();e&&e.length&&(S=t.toLowerCase()===e.toLowerCase())}}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return S},_isMatchingPixelSizeCSSValue=function(e,t){if(!e)return!0;let S=!1;switch(e.cssValueType){case CSSValue.CSS_VALUE_LIST:{let i=e;i.length>0&&(S=_isMatchingPixelSizeCSSValue(i.item(0),t))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let i=e;switch(i.primitiveType){case CSSPrimitiveValue.CSS_PERCENTAGE:case CSSPrimitiveValue.CSS_EMS:case CSSPrimitiveValue.CSS_EXS:case CSSPrimitiveValue.CSS_PX:case CSSPrimitiveValue.CSS_CM:case CSSPrimitiveValue.CSS_MM:case CSSPrimitiveValue.CSS_IN:case CSSPrimitiveValue.CSS_PT:case CSSPrimitiveValue.CSS_PC:try{S=Math.abs(i.getFloatValue(CSSPrimitiveValue.CSS_PX)-t)<.1}catch(e){}}}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return S},lightWeight=Symbol("lightWeight"),normalWeight=Symbol("normalWeight"),heavyWeight=Symbol("heavyWeight"),_isMatchingFontWeightCSSValue=function(e,t){if(!e)return!0;let S,i=t,l=normalWeight;switch(e.cssValueType){case CSSValue.CSS_VALUE_LIST:{let S=e;S.length>0&&_isMatchingFontWeightCSSValue(S.item(0),t)&&(l=i)}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let t=e.primitiveType;l=CSSPrimitiveValue.CSS_STRING===t||CSSPrimitiveValue.CSS_IDENT===t?"normal"===(S=e.getStringValue().toLowerCase())||"400"===S?normalWeight:"bold"===S||"bolder"===S||S>400?heavyWeight:lightWeight:i;break}case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:l=i}return i===l},_isRichFontStyleCSSValue=function(e){if(!e)return!1;let t=e.cssText;return t.length&&"normal"!==t},_isRichTextDecorationStyleCSSValue=function(e){if(!e)return!1;let t=!1;switch(e.cssValueType){case CSSPrimitiveValue.CSS_VALUE_LIST:{let S=e;S.length>0&&(t=_isRichTextDecorationStyleCSSValue(S.item(0)))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let S=e,i=S.primitiveType;if(CSSPrimitiveValue.CSS_STRING===i||CSSPrimitiveValue.CSS_IDENT===i){let e=S.getStringValue().toLowerCase();t="none"!==e&&"inherit"!==e}}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return t},_isRichTextAlignmentStyleCSSValue=function(e){if(!e)return!1;let t=!1;switch(e.cssValueType){case CSSPrimitiveValue.CSS_VALUE_LIST:{let S=e;S.length>0&&(t=_isRichTextAlignmentStyleCSSValue(S.item(0)))}break;case CSSValue.CSS_PRIMITIVE_VALUE:{let S=e,i=S.primitiveType;if(CSSPrimitiveValue.CSS_STRING===i||CSSPrimitiveValue.CSS_IDENT===i){let e=S.getStringValue().toLowerCase();t="left"!==e&&"inherit"!==e}}break;case CSSValue.CSS_CUSTOM:case CSSValue.CSS_INHERIT:}return t};Element.prototype.isRichTextStyle=function(e){let t=!1;return(t=!_isBlackCSSColorValue(e.getPropertyCSSValue("color")))||(t||(t=!_isMatchingFontFamilyCSSValue(e.getPropertyCSSValue("font-family"),"Helvetica")),t||(t=!_isMatchingPixelSizeCSSValue(e.getPropertyCSSValue("font-size"),defaultComposeFontPixelSize)),t||(t=!_isMatchingFontWeightCSSValue(e.getPropertyCSSValue("font-weight"),normalWeight))),t||(t=_isRichFontStyleCSSValue(e.getPropertyCSSValue("font-style"))),t||(t=_isRichTextDecorationStyleCSSValue(e.getPropertyCSSValue("text-decoration"))),t||(t=_isRichTextAlignmentStyleCSSValue(e.getPropertyCSSValue("text-align"))),t||(t=!!e.getPropertyCSSValue("direction")),t},Element.prototype.isRichTextElement=function(){let e=this.isRichTextElementType();if(!e){let t=this.nodeName.toLowerCase();if("blockquote"===t){let t=this.getAttribute("type");e=!t||"cite"!==t.toLowerCase()}else if("img"===t){if(!(this instanceof HTMLImageElement&&this.attachmentIdentifier)){let t=this.src;t&&(e=new URL(t).protocol!==MFContentIDScheme+":")}}else"p"===t&&(e=!this.hasMarginsOfZero())}if(!e){let t=this.hasAttribute("STYLE")?this.style:undefined;t&&"none"!==t.getPropertyValue("display")&&(e=this.isRichTextStyle(t))}return e||this.getAttribute("class")!==MFMailDropItemClass&&this.getAttribute("class")!==MFMailDropBannerClass||(e=!0),e||this.getAttribute("id")===MFHtmlIDSignature&&(e=!0),e};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";HTMLDocument.prototype.mf_createMessageQuoteElement=function(){let e=this.createElement("BLOCKQUOTE");return e.setAttribute("TYPE","cite"),e},HTMLDocument.prototype.createElementFromMarkup=function(e){let t=this.createElement("template");return t.innerHTML=e,t.content.firstChild},HTMLDocument.mf_listElements=["ul","ol","dl"];
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";HTMLElement.prototype.mf_quoteLevelDelta=function(){if("BLOCKQUOTE"!==this.nodeName.toUpperCase())return 0;let t=this.getAttribute("type");if(t&&"CITE"===t.toUpperCase())return 1;let e=this.getAttribute("class");return e&&"GMAIL_QUOTE"===e.toUpperCase()?1:0};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";Node.prototype.mf_quoteLevelDelta=function(){return 0},Node.prototype.mf_isQuoteOrWithinQuote=function(){let e=this;for(;e;){if(e.mf_quoteLevelDelta()>0)return!0;e=e.parentNode}return!1},Node.prototype.mf_commonAncestorWithNode=function(e){let t,o,n=this;for(;n&&!t;n=n.parentNode)n===e?t=n:(o||(o=new Set),o.add(n));for(;e&&!t;e=e.parentNode)o&&o.has(e)&&(t=e);return t},Node.prototype.mf_appendBlockPlaceholder=function(){let e=this.ownerDocument.createBlockPlaceholder();return e&&this.appendChild(e),e},Node.prototype.mf_containsRichText=function(){let e=!1;this instanceof Element&&(e=this.isRichTextElement());let t=this.firstChild;for(;!e&&t;)e=t.mf_containsRichText(),t=t.nextSibling;return e},Node.prototype.stringValue=function(){let e=this.ownerDocument.createRange();return e.selectNode(this),e.stringValue()},Node.prototype.mf_isBody=function(){return"body"===this.nodeName.toLowerCase()},Node.prototype.mf_traversePreviousNode=function(){let e=this.previousSibling;for(;e&&e.lastChild;)e=e.lastChild;return e||this.parentNode},Node.prototype.mf_traverseNextNodeStayingWithin=function(e){let t=this.firstChild;if(t)return t;if(this.isSameNode(e))return undefined;if(t=this.nextSibling)return t;for(t=this;t&&!t.nextSibling&&(!e||!t.parentNode.isSameNode(e));)t=t.parentNode;return t.nextSibling},Node.prototype.mf_traverseNextSiblingStayingWithin=function(e){let t;if(this.isSameNode(e))return t;if(t=this.nextSibling)return t;for(t=this;t&&!t.nextSibling&&(!e||!t.parentNode.isSameNode(e));)t=t.parentNode;return t.nextSibling},Node.prototype.mf_topmostContainingNodeWithNameInArray=function(e){let t,o=this;for(;o&&!o.mf_isBody();)-1!==e.indexOf(o.nodeName.toLowerCase())&&(t=o),o=o.parentNode;return t},Node.prototype.mf_containsOnlySelectionMarkers=function(){let e=!1;if(this.firstChild){let t=this.firstChild;for(e=!0;t;)t instanceof HTMLElement&&"span"===t.tagName.toLowerCase()&&t.className===MFHtmlTemporaryEditingElement&&!t.firstChild||(e=!1),t=e?t.nextSibling:undefined}else e=!0;return e},Node.prototype.mf_isDescendantOfNode=function(e){let t=this,o=!1;for(;!o&&t;)t===e&&(o=!0),t=t.parentNode;return o},Node.prototype.mf_containingBlockQuote=function(){let e=this;for(;e&&!e.mf_quoteLevelDelta();)e=e.parentNode;return e},Node.prototype.mf_isAtBeginningOfContainerNode=function(e){let t=e;for(;t&&t!==this;)t=t.firstChild;return!!t},Node.prototype.mf_isAtEndOfContainerNode=function(e){let t=e;for(;t&&t!==this;)t=t.lastChild;return!!t},Node.prototype.mf_nextSiblingOrAunt=function(){let e,t=this;for(;!e&&t;)(e=t.nextSibling)||(t=t.parentNode);return e},Node.prototype.mf_highestContainingBlockQuote=function(){let e,t=this.mf_containingBlockQuote();for(;t&&(e=t.parentNode.mf_containingBlockQuote());)t=e;return t},Node.prototype.mf_firstDescendantBlockQuote=function(){let e;if(this.mf_quoteLevelDelta()>0)e=this;else{let t,o=this.childNodes,n=o.length;for(t=0;!e&&t<n;t++)e=o.item(t).mf_firstDescendantBlockQuote()}return e},Node.prototype.mf_blockNodeAncestor=function(){let e=this;for(;!isBlockLevelNode(e)&&"li"!==e.nodeName.toLowerCase();)e=e.parentNode;return e},Node.prototype.mf_findElement=function(e,t,o){e=e.toLowerCase();let n,i,r;if(this instanceof HTMLDocument?(r=this,i=this.body):(r=this.ownerDocument,i=this),i){let s,f=r.createNodeIterator(i,NodeFilter.SHOW_ELEMENT);for(;!n&&(s=f.nextNode());){let i=!0;e&&!(i=i&&s.nodeName.toLowerCase()===e)||(t&&!(i=i&&s.className===t)||o&&!(i=i&&s.id===o)||i&&(n=s))}}return n};
 * Copyright (c) <%= Time.now.strftime(fmt="%Y") %> Apple Inc. All rights reserved.
"use strict";const blockElementNames=new Set(["HTML","BODY","BR","OL","UL","TD","TH","HR","DD","DL","DT","PRE","BLOCKQUOTE","DIV","P","TR","H1","H2","H3","H4","H5","H6"]),isBlockElementName=function(e){return blockElementNames.has(e)};Range.prototype.stringValue=function(){let e=this.text();return isBlockElementName(this.endContainer.nodeName)&&0===this.endOffset&&(e+="\n"),e},Range.prototype.mf_hoistRange=function(){let e,t=!1;for(e=this.startContainer;!t&&!e.mf_isBody()&&!e.mf_quoteLevelDelta();)t=!0,this.endContainer===e&&(this.startOffset||this.endOffset!==e.childNodes.length||(this.setStartBefore(e),this.setEndAfter(e),e=this.startContainer,t=!1))},Range.prototype.mf_firstNode=function(){let e;if(this.collapsed)return e;let t=this.startContainer,n=this.startOffset,i=!1;if(t instanceof Text)e=(i=n>0)?t.mf_traverseNextNodeStayingWithin():t;else{for(e=t.firstChild;n-- >0;)e=e.nextSibling;e||(e=t.mf_traverseNextSiblingStayingWithin())}return e&&!this.intersectsNode(e)&&(e=undefined),e},Range.prototype.mf_lastNode=function(){let e;if(this.collapsed)return e;let t=this.endContainer,n=this.endOffset,i=!1;if(t instanceof Text)e=(i=n<t.length)?t.mf_traversePreviousNode():t;else{for(e=t.firstChild;--n>0;)e=e.nextSibling;e&&this.endOffset||(e=t.mf_traversePreviousNode())}return e&&!this.intersectsNode(e)&&(e=undefined),e};const IS_BLOCK_ELEMENT_NAME=function(e){const t=["HTML","BODY","BR","LI","OL","UL","TD","TH","HR","DD","DL","DT","PRE","BLOCKQUOTE","DIV","P","TR","H1","H2","H3","H4","H5","H6"];return e&&-1!==t.indexOf(e)},isBlockLevelNode=function(e){let t=!1;return t=!!IS_BLOCK_ELEMENT_NAME(e.nodeName)};Range.prototype.mf_getBlockBoundaryParentAndNextSibling=function(e){let t,n;if(e){let e=this.mf_firstNode(),t=e&&e.mf_topmostContainingNodeWithNameInArray(HTMLDocument.mf_listElements);if(t)return{parent:t.parentNode,nextSibling:t}}else{let e=this.mf_lastNode(),t=e&&e.mf_topmostContainingNodeWithNameInArray(HTMLDocument.mf_listElements);if(t)return{parent:t.parentNode,nextSibling:t.nextSibling}}let i,s,o;if(e?(i=this.startContainer,o=this.startOffset):(i=this.endContainer,o=this.endOffset),i instanceof Text)i=(s=i).parentNode;else for(s=i.firstChild;o-- >0;s=s.nextSibling);for(e&&(s=s?s.previousSibling:i.lastChild);!t&&i;){for(;!t&&s;)isBlockLevelNode(s)?(t=i,n=e||"BR"===s.nodeName.toUpperCase()?s.nextSibling:s):s=e?s.previousSibling:s.nextSibling;s||(isOrContainsBlockLevelNode(i)?(t=i,n=e?t.firstChild:undefined):(s=i,i=i.parentNode))}return{parent:t,nextSibling:n}};const isOrContainsBlockLevelNode=function(e){let t,n=!1;if(IS_BLOCK_ELEMENT_NAME(e.nodeName))n=!0;else for(t=e.firstChild;!n&&t;)n=isOrContainsBlockLevelNode(t),t=t.nextSibling;return n};
(%{public}@) Attachment is not a PDF
(%{public}@) Data is missing
(%{public}@) Could not create PDF document from data
(%{public}@) Attached PDF has %lu pages, isLocked=%{BOOL}d
MSAttachmentItem
NSSecureCoding
NSCoding
MSComposeBundlePageController
WKWebProcessPlugInLoadDelegate
NSObject
MSBundlePageController
MSComposeBodyFieldController
MSComposeBundlePageControllerExtras
_MSComposeBundlePageControllerNSURL
JSExport
MSPDFAttachmentController
MSMailWebProcessAttachmentProxy
init
copy
contentID
encodeObject:forKey:
uttype
data
additionalMarkup
decodeObjectOfClass:forKey:
supportsSecureCoding
encodeWithCoder:
initWithCoder:
TB,R
initWithContentID:uttype:data:additionalMarkup:
.cxx_destruct
_contentID
_uttype
_data
_additionalMarkup
T@"NSString",R,C,N,V_contentID
T@"UTType",R,N,V_uttype
T@"NSData",R,C,N,V_data
T@"NSString",R,C,N,V_additionalMarkup
setLoadDelegate:
doesNotRecognizeSelector:
addObject:
resumePerformOnPage
firstObject
removeObjectAtIndex:
invokeMethod:withArguments:
performOnPage:
numberWithInteger:
arrayWithObjects:count:
performBodyFieldMethodOnPage:withArguments:
mainFrame
normalWorld
jsContextForWorld:
callStackSymbols
objectForKeyedSubscript:
toString
componentsSeparatedByString:
dictionaryWithObjects:forKeys:count:
stringWithFormat:
exceptionWithName:reason:userInfo:
observerProxy
composeBodyFieldDidThrowException:
setExceptionHandler:
globalObject
jsContext
exceptionHandler
initializeGlobalObject
willSendRequest:
initWithBytes:length:encoding:
stringWithUTF8String:
URLWithString:
evaluateScript:withSourceURL:
setObject:forKeyedSubscript:
currentThis
currentContext
rangeHandleWithJSValue:inContext:
text
ef_isWebAddress
isEqual:
class
self
performSelector:
performSelector:withObject:
performSelector:withObject:withObject:
isProxy
isKindOfClass:
isMemberOfClass:
conformsToProtocol:
respondsToSelector:
retain
release
autorelease
retainCount
zone
hash
superclass
description
debugDescription
TQ,R
T#,R
T@"NSString",R,C
webProcessPlugInBrowserContextController:didStartProvisionalLoadForFrame:
webProcessPlugInBrowserContextController:didReceiveServerRedirectForProvisionalLoadForFrame:
webProcessPlugInBrowserContextController:didCommitLoadForFrame:
webProcessPlugInBrowserContextController:didFinishDocumentLoadForFrame:
webProcessPlugInBrowserContextController:didFailProvisionalLoadWithErrorForFrame:error:
webProcessPlugInBrowserContextController:didFailLoadWithErrorForFrame:error:
webProcessPlugInBrowserContextController:didFinishLoadForFrame:
webProcessPlugInBrowserContextController:didSameDocumentNavigation:forFrame:
webProcessPlugInBrowserContextController:didClearWindowObjectForFrame:inScriptWorld:
webProcessPlugInBrowserContextController:globalObjectIsAvailableForFrame:inScriptWorld:
webProcessPlugInBrowserContextController:willInjectUserScriptForFrame:inScriptWorld:
webProcessPlugInBrowserContextController:didRemoveFrameFromHierarchy:
webProcessPlugInBrowserContextController:didHandleOnloadEventsForFrame:
webProcessPlugInBrowserContextController:didLayoutForFrame:
webProcessPlugInBrowserContextController:renderingProgressDidChange:
webProcessPlugInBrowserContextController:didFirstVisuallyNonEmptyLayoutForFrame:
webProcessPlugInBrowserContextControllerRenderingProgressEvents:
webProcessPlugInBrowserContextController:frame:willSendRequestForResource:request:redirectResponse:
webProcessPlugInBrowserContextController:frame:willSendRequest:redirectResponse:
webProcessPlugInBrowserContextController:frame:didInitiateLoadForResource:request:pageIsProvisionallyLoading:
webProcessPlugInBrowserContextController:frame:didInitiateLoadForResource:request:
webProcessPlugInBrowserContextController:frame:didReceiveResponse:forResource:
webProcessPlugInBrowserContextController:frame:didFinishLoadForResource:
webProcessPlugInBrowserContextController:frame:didFailLoadForResource:error:
initWithPlugIn:contextController:
invalidate
changeQuoteLevelBy:
suspendPerformOnPage
initializeBodyField:
plugIn
controller
jsBodyField
_performOnPageSuspendCount
_blocksToPerformOnPage
_jsBodyField
_plugIn
_controller
_jsContext
T@"<WKWebProcessPlugIn>",R,W,N,V_plugIn
T@"WKWebProcessPlugInBrowserContextController",R,N,V_controller
T@"JSContext",R,N,V_jsContext
T@"JSValue",R,N,V_jsBodyField
T@"<MSComposeBodyFieldObserver>",R,N
initWithString:
absoluteString
scheme
UTF8String
conformsToType:
initWithData:
pageCount
isLocked
delegate
currentHandler
handleFailureInMethod:object:file:lineNumber:description:
attachmentController:updateToInlineAttachment:
updateToInlinePDFAttachmentIfNeeded:
setDelegate:
_delegate
T@"<MSPDFAttachmentControllerDelegate>",W,N,V_delegate
B16@0:8
v24@0:8@16
@24@0:8@16
v24@0:8@"NSCoder"16
@24@0:8@"NSCoder"16
@48@0:8@16@24@32@40
@16@0:8
v16@0:8
@"NSString"
@"UTType"
@"NSData"
B24@0:8@16
#16@0:8
@24@0:8:16
@32@0:8:16@24
@40@0:8:16@24@32
B24@0:8#16
B24@0:8:16
Vv16@0:8
Q16@0:8
^{_NSZone=}16@0:8
B24@0:8@"Protocol"16
@"NSString"16@0:8
v32@0:8@16@24
v40@0:8@16@24@32
v40@0:8@16q24@32
v32@0:8@16Q24
Q24@0:8@16
@56@0:8@16@24Q32@40@48
v52@0:8@16@24Q32@40B48
v48@0:8@16@24Q32@40
v48@0:8@16@24@32Q40
v40@0:8@16@24Q32
v32@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24
v40@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24@"NSError"32
v40@0:8@"WKWebProcessPlugInBrowserContextController"16q24@"WKWebProcessPlugInFrame"32
v40@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24@"WKWebProcessPlugInScriptWorld"32
v32@0:8@"WKWebProcessPlugInBrowserContextController"16Q24
Q24@0:8@"WKWebProcessPlugInBrowserContextController"16
@"NSURLRequest"56@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32@"NSURLRequest"40@"NSURLResponse"48
@"NSURLRequest"48@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24@"NSURLRequest"32@"NSURLResponse"40
v52@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32@"NSURLRequest"40B48
v48@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32@"NSURLRequest"40
v48@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24@"NSURLResponse"32Q40
v40@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32
v48@0:8@"WKWebProcessPlugInBrowserContextController"16@"WKWebProcessPlugInFrame"24Q32@"NSError"40
@32@0:8@16@24
@32@0:8@"<WKWebProcessPlugIn>"16@"WKWebProcessPlugInBrowserContextController"24
v24@0:8q16
v24@0:8@?16
@"NSMutableArray"
@"JSValue"
@"<WKWebProcessPlugIn>"
@"WKWebProcessPlugInBrowserContextController"
@"JSContext"
@24@0:8@"NSString"16
v24@0:8@"MSAttachmentItem"16
@"<MSPDFAttachmentControllerDelegate>"
