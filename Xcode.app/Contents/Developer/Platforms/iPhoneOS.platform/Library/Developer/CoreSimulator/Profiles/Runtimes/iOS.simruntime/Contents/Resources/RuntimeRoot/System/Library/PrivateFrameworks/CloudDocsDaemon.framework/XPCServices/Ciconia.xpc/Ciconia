@(#)PROGRAM:Ciconia  PROJECT:CloudDocs-1
sideFaultsCount
clonedFolders
clonedFiles
clonedSideFaults
clonedAppLibraries
cloningFailures
reconciledItems
reconciliationFailures
migratedSideFaults
nonMigratedItems
expectedMigrations
materialisedInCloudDocs
materializedInFPFS
itemsNotFoundInDB
itemsChangedDuringCloning
ignoredContentProtectedItems
packagesWithoutBundleBit
unexpectedCreations
totalItemCount
duration
cloningDuration
importDuration
uuid
ciconiaVersion
lastError
manuallyTriggered
migrationUUID
domainID
sideFaultsBelowThreshold
nonSideFaultsCompletelyMigrated
expectedAmountOfItemsMigrated
itemsThatAreNotMigrated
typeOfMigrated
typeOfNotMigrated
materialisedCountOnICD
materialisedCountOnFPFS
errorOriginatorId
ciconia/cleanup.state
currentStep
startDate
cloningStartDate
importStartDate
stats
importSteps
version
v20@?0B8@"NSError"12
ciconia
unlock
lock
unlocked
locked
ciconia-telemetry-queue-%@
PRAGMA synchronous = 0
B16@?0@"PQLConnection"8
v16@?0@"NSError"8
v8@?0
INSERT INTO ciconia_reconciliation (old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation) VALUES (%llu, NULL, NULL, NULL, NULL, NULL)
INSERT INTO ciconia_reconciliation (old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation) VALUES (NULL, %llu, NULL, NULL, NULL, NULL)
INSERT INTO ciconia_reconciliation (old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation) VALUES (%llu, %llu, %u, %llu, %llu, %u)
INSERT INTO ciconia_reconciliation (old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation) VALUES (NULL, %llu, %u, NULL, %llu, %u)
SELECT version_content_signature FROM client_items WHERE item_doc_id = %llu
com.apple.FinderInfo
files
/usr/bin/fileproviderctl fault prune '%@'
FS removal
session/ciconia_diagnose
/usr/bin/fileproviderctl check -v -d %@
fpck.out
/usr/bin/fileproviderctl dump --full-dump %@
fileprovider.dump
aborted in another thread
telemetry disabled
cannot defer
failed to defer
SELECT key, value from ciconia_migration_info
SELECT item_type, item_localsyncupstate, rowid, item_file_id, item_doc_id FROM client_items WHERE rowid > %llu ORDER BY rowid ASC LIMIT 1000
%llu
SELECT old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation, rowid FROM ciconia_reconciliation WHERE reconciled = 0 limit 100
UPDATE ciconia_reconciliation SET reconciled = 1 WHERE rowid = %llu
Couldn't update the item for rowid %llu
SELECT COUNT(*) FROM client_items WHERE item_doc_id = %llu
SELECT COUNT(*) FROM client_items WHERE item_file_id = %llu
DELETE FROM client_items WHERE item_doc_id = %llu
DELETE FROM client_items WHERE item_file_id = %llu
SELECT item_file_id, item_generation FROM client_items WHERE item_doc_id = %llu
UPDATE client_items SET item_file_id = %llu, item_generation = %u, item_doc_id = %llu WHERE item_doc_id = %llu
Couldn't update the item for docID %llu
SELECT item_generation FROM client_items WHERE item_file_id = %llu
UPDATE client_items SET item_file_id = %llu, item_generation = %u WHERE item_file_id = %llu
Couldn't update the item for fileID %llu
Ciconia
domain removal
Ciconia-
v24@?0@"NSArray"8@"NSError"16
__defaultPersonaID__
state.plist
v24@?0Q8@"NSError"16
Account for persona %@ disabled
com.apple.CloudDocs.iCloudDriveFileProviderManaged
group.com.apple.iCloudDrive
com.apple.CloudDocs.iCloudDriveFileProvider
Cleaning up old domains failed!
Library/Application Support/CloudDocs/session/db
client.db
hook.out
v24@?0@"NSString"8^B16
 CREATE TABLE ciconia_reconciliation ( old_doc_id integer, old_file_id integer, old_generation, new_doc_id integer, new_file_id integer, new_generation, reconciled integer NOT NULL DEFAULT 0)
CREATE TABLE ciconia_migration_info ( key TEXT NOT NULL primary key, value integer not null)
SELECT COUNT(*) FROM client_items
Library/Application Support/CloudDocs/session/x
Ciconia-%@
.importFinished
BRCiconiaImportDidFinish
v16@?0@"NSNotification"8
Timeout during the import
/usr/bin/fileproviderctl check -v -d -a '%@'
FPCK failed
totalMaterializedItems:\s+(\d+)
v32@?0@"NSTextCheckingResult"8Q16^B24
Received signal %d
Migration already running
v16@?0@"NSObject<OS_xpc_object>"8
persona
com.apple.CloudDocs.ciconia.activity-%@
com.apple.CloudDocs.ciconia.cleanup-%@
encodeInt64:forKey:
encodeDouble:forKey:
encodeObject:forKey:
init
decodeInt64ForKey:
decodeDoubleForKey:
decodeObjectOfClass:forKey:
supportsSecureCoding
encodeWithCoder:
initWithCoder:
TB,R
sideFaultsCount
setSideFaultsCount:
clonedFolders
setClonedFolders:
clonedFiles
setClonedFiles:
clonedSideFaults
setClonedSideFaults:
clonedAppLibraries
setClonedAppLibraries:
cloningFailures
setCloningFailures:
reconciledItems
setReconciledItems:
reconciliationFailures
setReconciliationFailures:
migratedSideFaults
setMigratedSideFaults:
nonMigratedItems
setNonMigratedItems:
expectedMigrations
setExpectedMigrations:
materialisedInCloudDocs
setMaterialisedInCloudDocs:
materializedInFPFS
setMaterializedInFPFS:
itemsNotFoundInDB
setItemsNotFoundInDB:
itemsChangedDuringCloning
setItemsChangedDuringCloning:
ignoredContentProtectedItems
setIgnoredContentProtectedItems:
packagesWithoutBundleBit
setPackagesWithoutBundleBit:
unexpectedCreations
setUnexpectedCreations:
totalItemCount
setTotalItemCount:
duration
setDuration:
cloningDuration
setCloningDuration:
importDuration
setImportDuration:
uuid
setUuid:
.cxx_destruct
TQ,VsideFaultsCount
TQ,VclonedFolders
TQ,VclonedFiles
TQ,VclonedSideFaults
TQ,VclonedAppLibraries
TQ,VcloningFailures
TQ,VreconciledItems
TQ,VreconciliationFailures
TQ,VmigratedSideFaults
TQ,VnonMigratedItems
TQ,VexpectedMigrations
TQ,VmaterialisedInCloudDocs
TQ,VmaterializedInFPFS
TQ,VitemsNotFoundInDB
TQ,VitemsChangedDuringCloning
TQ,VignoredContentProtectedItems
TQ,VpackagesWithoutBundleBit
Tq,VunexpectedCreations
TQ,VtotalItemCount
Td,Vduration
Td,VcloningDuration
Td,VimportDuration
T@"NSUUID",&,Vuuid
encodeBool:forKey:
encodeInt:forKey:
decodeBoolForKey:
decodeIntForKey:
archivedDataWithRootObject:requiringSecureCoding:error:
unarchivedObjectOfClass:fromData:error:
fp_prettyDescription
cloudDocsAppSupportURL
URLByAppendingPathComponent:
migrationReportFromData:
cleanupStateURL
convertToData
ciconiaVersion
setCiconiaVersion:
lastError
setLastError:
manuallyTriggered
setManuallyTriggered:
migrationUUID
setMigrationUUID:
domainID
setDomainID:
sideFaultsBelowThreshold
setSideFaultsBelowThreshold:
nonSideFaultsCompletelyMigrated
setNonSideFaultsCompletelyMigrated:
expectedAmountOfItemsMigrated
setExpectedAmountOfItemsMigrated:
itemsThatAreNotMigrated
setItemsThatAreNotMigrated:
typeOfNotMigrated
setTypeOfNotMigrated:
materialisedCountOnICD
setMaterialisedCountOnICD:
materialisedCountOnFPFS
setMaterialisedCountOnFPFS:
typeOfMigrated
setTypeOfMigrated:
errorOriginatorId
setErrorOriginatorId:
TQ,VciconiaVersion
TB,VmanuallyTriggered
T@"NSUUID",&,VmigrationUUID
T@"NSString",&,VdomainID
T@"NSError",&,N,VlastError
TQ,VerrorOriginatorId
TB,VsideFaultsBelowThreshold
TB,VnonSideFaultsCompletelyMigrated
TQ,VexpectedAmountOfItemsMigrated
TQ,VitemsThatAreNotMigrated
T{BRTypesField=(?=i{?=b1b1b1b1b1b1b1b1b1})},VtypeOfNotMigrated
T{BRTypesField=(?=i{?=b1b1b1b1b1b1b1b1b1})},VtypeOfMigrated
TQ,VmaterialisedCountOnICD
TQ,VmaterialisedCountOnFPFS
encodeInteger:forKey:
version
decodeIntegerForKey:
persistedStateFromData:
currentStep
setCurrentStep:
startDate
setStartDate:
cloningStartDate
setCloningStartDate:
importStartDate
setImportStartDate:
stats
setStats:
importSteps
setImportSteps:
TQ,VcurrentStep
T@"NSDate",&,VstartDate
T@"NSDate",&,VcloningStartDate
T@"NSDate",&,VimportStartDate
T@"BRCMigrationStats",&,Vstats
TQ,VimportSteps
initWithPersona:hook:andActivity:
numberWithBool:
setObjResult:error:
queryTelemetryEnablement:
error
result
boolValue
ciconiaWorkDirForCurrentPersona
path
fileSystemRepresentation
fp_prettyPath
lockUnlockWorkDir:withFD:andError:
br_errorFromErrno
arrayWithObjects:count:
stringWithFormat:
UTF8String
defaultManager
defaultConnection
newSyncProxy
defaultsForMangledID:
ciconiaMaxSideFaultsMigration
ciconiaMaxReconciliationFailures
ciconiaHideMigrationDomain
ciconiaKeepDomainAfterMigration
ciconiaImportTimeout
isTelemetryEnabled:
dealloc
openAtURL:withFlags:error:
setupPragmas
close:
execute:
useBatchingWithDelay:changeCount:
makeNextFlushFullSync
flush
performWithFlags:action:
numberWithUnsignedInt:
reportItemMismatchDuringSilentMigration:information:uuid:reply:
unsignedLongLongValue
resourceValuesForKeys:error:
_reconcileItemAt:fileID:genCount:withError:
objectForKeyedSubscript:
_docIDForURL:andFileID:error:
fp_isPOSIXErrorCode:
brc_errorNotOnDisk:
fetch:
next
objectOfClass:atIndex:
brc_signatureIsPackage
close
enumeratorAtURL:includingPropertiesForKeys:options:errorHandler:
countByEnumeratingWithState:objects:count:
_deferActivityIfNeeded:error:
lastPathComponent
br_isExcludedWithMaximumDepth:
fp_obfuscatedFilename
_isFolderAPackage:
_reconcileDocIDTrackedAt:docID:fileID:genCount:updatedDocID:withError:
_cloneContentsOfDirectoryAtURL:to:noReconciliation:depth:
br_isCloudDocsErrorCode:
br_isPromiseURL
_removeDocIDTrackedAt:docID:fileID:withError:
_makeFileSparse:from:withError:
signalStartOfSilentTelemetry:uuid:manual:version:reply:
br_errorWithPOSIXCode:
_fsRemoveWorkDirectory:
br_isPOSIXErrorCode:
taskWithCommandWithArguments:
exec
waitStatus
_removeWorkDirectory:
reportCleanupFailureDuringSilentMigration:operationType:uuid:reply:
removeItemAtURL:error:
createDirectoryAtURL:withIntermediateDirectories:attributes:error:
sessionForBackingUpDatabasesAtURL:
backupDatabaseToURL:error:
setRedirectStdoutToFileAtPath:
_cleanupAndTelemetry:canFailCleanup:
UUIDString
length
_removeWorkDir:canFailCleanup:
timeIntervalSinceNow
_generateDiagnosticOutput:
writeToURL:options:error:
_cleanupAndTelemetry:canFailCleanup:persisted:
_generateCiconiaFPDomain:reportIfFailed:removingFailed:
reportFinishedMigration:uuid:reply:
_removePersistedCleanupState
brc_errorCiconiaAborted:
setObject:forKey:
_calculateUnexpectedCreations:
objectForKey:
longLongValue
intAtIndex:
longLongAtIndex:
brc_errorItemNotFound:
_setTypeFieldFromDBType:migrated:
_analyzeMigrationInfo:
numberAtIndex:
unsignedIntValue
changes
_reportFailedReconciliation:info:
numberWithSQL:
unsignedLongValue
initWithIdentifier:displayName:
setReplicated:
setHidden:
br_isCocoaErrorCode:
removeDomain:forProviderIdentifier:completionHandler:
identifier
hasPrefix:
getDomainsForProviderIdentifier:completionHandler:
isEqualToString:
sharedManager
currentPersona
isDataSeparatedPersona
userPersonaUniqueString
copyCurrentPersonaContextWithError:
generateAndRestorePersonaContextWithPersonaUniqueString:
errorWithDomain:code:userInfo:
queryLastCiconiaVersion:
homeDirectoryURL
brc_accountIDPathForAccountPath:
fileExistsAtPath:
dataWithContentsOfURL:
fileExistsAtPath:isDirectory:
_openAndLockWorkDir:
stringByAppendingPathComponent:
providerDomainWithID:error:
UUID
_signalMigrationStart
_cleanupOldCiconiaDomains
_cleanupAndTelemetry:
setRedirectStderrToFileAtPath:
stringWithContentsOfFile:usedEncoding:error:
enumerateLinesUsingBlock:
_setUpDatabaseAt:synchronous:withError:
_closeDatabase
_reconcileDatabaseWithError:deferred:
_generateCiconiaFPDomain:reportIfFailed:
importDomain:forProviderIdentifier:fromDirectoryAtURL:completionHandler:
fp_isFileProviderError:
setMaxConcurrentOperationCount:
defaultCenter
userInfo
addObserverForName:object:queue:usingBlock:
brc_errorCiconiaFailed:
attributesOfItemAtPath:error:
fileCreationDate
timeIntervalSinceDate:
_analyzeDatabaseWithError:
storageURLs
objectAtIndexedSubscript:
regularExpressionWithPattern:options:error:
rangeAtIndex:
substringWithRange:
numberFromString:
enumerateMatchesInString:options:range:usingBlock:
_initiateSilentMigrationOf:
migratorFor:withActivity:
migratorFor:withHook:
probeWorkDirLock
startMigrationOf:isExternal:error:
abortMigrationWithError:
cleanupCiconia
finishCiconiaCleanup
persona
_externalURL
_manager
_properties
_proxy
_telemetryAllowed
_telemetryQueue
_activity
_persona
_persistedState
_deviceID
_importSemaphore
_extensionID
_postDBCloneHook
_sideFaultsThreshold
_reconciliationFailuresThreshold
_isFPFSDomainHidden
_keepFPFSDomainAfterMigration
_importTimeout
_database
_targetURL
_persistURL
_nonMigratedTypes
_migratedTypes
_errorOriginatorId
_ciconiaFD
_aborted
_cleanupInProgress
bytes
initiateSilentMigrationOf:forPersonaID:withHook:andReply:
queueSilentMigrationActivityForPersonaID:withReply:
queryCiconiaVersion:
cleanupCiconiaForPersonaID:withReply:
finishCleanupForPersonaID:withReply:
interfaceWithProtocol:
setExportedInterface:
setExportedObject:
resume
isEqual:
class
self
performSelector:
performSelector:withObject:
performSelector:withObject:withObject:
isProxy
isKindOfClass:
isMemberOfClass:
conformsToProtocol:
respondsToSelector:
retain
release
autorelease
retainCount
zone
hash
superclass
description
debugDescription
TQ,R
T#,R
T@"NSString",R,C
listener:shouldAcceptNewConnection:
serviceListener
setDelegate:
br_currentPersonaID
mobileDocumentsURL
brc_errorInvalidParameter:value:
_scheduleBlockWithActivityForPersonaID:name:block:
initWithKeyOptions:valueOptions:capacity:
BRCMigrationStats
NSSecureCoding
NSCoding
BRCMigrationReport
BRCiconiaPersistedState
BRCiconiaMigrator
CiconiaProtocol
ServiceDelegate
NSXPCListenerDelegate
NSObject
Ciconia
B16@0:8
v24@0:8@16
@24@0:8@16
v24@0:8@"NSCoder"16
@24@0:8@"NSCoder"16
Q16@0:8
v24@0:8Q16
q16@0:8
v24@0:8q16
d16@0:8
v24@0:8d16
@16@0:8
v16@0:8
@"NSUUID"
v20@0:8B16
{BRTypesField=(?=i{?=b1b1b1b1b1b1b1b1b1})}16@0:8
v20@0:8{BRTypesField=(?=i{?=b1b1b1b1b1b1b1b1b1})}16
{BRTypesField=""(?="types"i""{?="doc"b1"alias"b1"symlink"b1"folder"b1"fault"b1"root"b1"bookmark"b1"bookmarkfault"b1"shareacceptfault"b1})}
@"NSError"
@"NSString"
@"NSDate"
@"BRCMigrationStats"
@32@0:8@16@24
B24@0:8@16
B32@0:8B16i20^@24
@40@0:8@16@24@32
B36@0:8@16B24^@28
@40@0:8@16Q24^@32
v32@0:8@16@24
B48@0:8@16@24Q32^@40
B60@0:8@16@24Q32I40^@44^@52
B44@0:8@16Q24I32^@36
B40@0:8@16@24^@32
@44@0:8@16@24B32Q36
B24@0:8^@16
v24@0:8B16B20
@28@0:8@16B24
v32@0:8@16B24B28
B28@0:8B16^@20
v24@0:8c16B20
B32@0:8^@16^B24
@36@0:8@16B24^B28
@36@0:8@16B24^@28
@"NSFileManager"
@"NSArray"
@"BRXPCSyncProxy<BRProtocolShared>"
@"NSObject<OS_dispatch_queue>"
@"NSObject<OS_xpc_object>"
@"BRCiconiaPersistedState"
@"NSObject<OS_dispatch_semaphore>"
@"PQLConnection"
@"NSURL"
v48@0:8@16@24@32@?40
v32@0:8@16@?24
v24@0:8@?16
v48@0:8@"NSURL"16@"NSString"24@"NSString"32@?<v@?@"BRCMigrationStats"@"NSError">40
v32@0:8@"NSString"16@?<v@?@"NSError">24
v24@0:8@?<v@?Q>16
#16@0:8
@24@0:8:16
@32@0:8:16@24
@40@0:8:16@24@32
B24@0:8#16
B24@0:8:16
Vv16@0:8
^{_NSZone=}16@0:8
B24@0:8@"Protocol"16
@"NSString"16@0:8
B32@0:8@16@24
B32@0:8@"NSXPCListener"16@"NSXPCConnection"24
v40@0:8@16@24@?32
[WARNING] Failed restoring migration report: %@
[WARNING] Failed restoring state: %@
[ERROR] Failed opening workdir %@ %{errno}d
[ERROR] Cannot %s workdir %{errno}d
[NOTICE] workdir got %s
[CRIT] Assertion failed: !(hook != nil && activity != nil)
[ERROR] Can't close database at %@: %@
[WARNING] Failed making DB async, will execute slower
[ERROR] Failed to open %@ %{errno}d
[ERROR] Failed to open %@ (%llu) %{errno}d
[ERROR] GSLibraryGetOrAllocateDocumentId failed to allocate docID for %@ (fd:%d, fid:%lld) %{errno}d
[ERROR] fstat(%d): dev:%d, ino:%lld, mode:0x%x, lnk:%hu, uid:%d, gid:%d
[ERROR] Failed closing %@ %{errno}d
[ERROR] Failed reconciliation: %@ (%@)
[ERROR] Failed submitting event: %@
[ERROR] DB insert failed: %@
[DEBUG] Item %llu is actually a package
[DEBUG] cloning %@ -> %@ (%ld) nor:%d
[DEBUG] %@ is excluded from sync (will ignore anything below)
[WARNING] Failed querying properties for %@: %@
[ERROR] copyfile(%@, %@) failed: %@
[ERROR] Failed getting finder info for %@ %{errno}d
[ERROR] FinderInfo has invalid size (%ld - exp %ld) for %@
[WARNING] Folder %@ has mismatch between disk and DB: %d - %d
[ERROR] Failed opening %@ %{errno}d
[WARNING] copyfile %@ -> %@ failed on a class A/B file - ignoring
[ERROR] Failed removing the class A/B file %@ from DB: %@
[ERROR] copyfile %@ -> %@ failed: %@
[ERROR] Failed to make the file %@ sparse: %@
[ERROR] fileproviderctl return %d
[ERROR] Failed _removeWorkDirectory with error %@
[WARNING] Failed removing persisted state at %@: %@
[WARNING] diagnose: Failed removing %@: %@
[ERROR] diagnose: Failed creating %@: %@
[ERROR] diagnose: backupDatabaseToURL:%@ failed: %@
[DEBUG] Already undergoing a cleanup, bye!
[NOTICE] Finishing migration with error: %@
[NOTICE] Error was thrown at: %llu
[DEBUG] No target -> no telemetry
[DEBUG] Not started -> no telemetry
[WARNING] Failed persisting cleanup status: %@
[ERROR] Failed removing persisted cleanup state at %@: %@
[WARNING] Removing domain failed, retrying later...
[DEBUG] Sending final telemetry
[DEBUG] Telemetry is not allowed
[ERROR] Unexpected type!
[DEBUG] Ciconia Migration Info: %@
[ERROR] Failed migrating (%d) item (fid: %llu, did: %llu) at rowID: %llu
[DEBUG] Found an item not existing on disk at rowID: %llu
[ERROR] Marking rowID reconciled failed: %@
[NOTICE] There's no class protected item did:%llu fid:%llu in the DB
[ERROR] Failed removing data protected file did:%llu, fid:%llu: %@
[WARNING] Item with docID %llu (fid:%llu, gc:%u) not found in the DB
[WARNING] Mismatch DB/Disk for docID %llu: db(fid:%llu, gc:%lu), disk(fid:%llu, gc:%u)
[WARNING] Item with fileID %llu (gc:%u) not found in the DB
[WARNING] Mismatch DB/Disk for fileID %llu: db(gc:%lu), disk(gc:%u)
[ERROR] DB update failed: %@
[DEBUG] Will remove domain: %@
[WARNING] removeDomain:%@ failed: %@
[DEBUG] Looking for old Ciconia domains
[WARNING] Enumerating domains failed: %@
[DEBUG] Found old domain %@, dropping
[WARNING] Failed to remove old domain %@: %@
[ERROR] won't restore persona: %@
[ERROR] Can't adopt persona %@: %@
[DEBUG] Not allowed to adopt persona - should fallback persona
[DEBUG] Last ciconia was already run...
[ERROR] stating %@ failed %{errno}d
[WARNING] Creating the container failed, expect failures during the migration: %s
[WARNING] removeItemAtURL:%@ failed: %@
[ERROR] Persisted state with invalid UUID: %@ - restarting from scratch
[ERROR] workdir %@ not found - restarting from scratch
[ERROR] workdir %@ could not be locked - failing
[ERROR] Domain %@ not found - restarting from scratch
[NOTICE] Continuing activity for UUID %@ at step %lu
[DEBUG] Telemetry is not allowed, no event will be sent
[NOTICE] Initiating silent migration from %@ to %@ for %@
[NOTICE] Targets: DB = %@, files = %@
[NOTICE] Ciconia version: %llu
[NOTICE] Using activity: %p, telemetry: %d, UUID: %@
[NOTICE] Step 1: cleanup
[ERROR] _cleanupOldCiconiaDomains timed out!
[WARNING] _removeWorkDirectory failed: %@
[NOTICE] Step 2: create new target
[ERROR] Failed locking workdir %@: %@
[NOTICE] Step 3: clone the DB
[ERROR] setiopolicy_np(IGNORE_PERMISSION, ON) failed %{errno}d
[ERROR] setiopolicy_np(SKIP_MTIME_UPDATE, ON) failed %{errno}d
[ERROR] BRCSetupVNodeRapidAging(YES) failed %{errno}d
[DEBUG] Going to clone the account DSID from %@ to %@
[ERROR] clonefile failed: %@
[DEBUG] Going to clone the DB from %@ to %@
[ERROR] backupDatabaseToURL:%@ failed: %@
[DEBUG] Executing hook '%@', output in %@
[ERROR] Hook failed with status: %d
[DEBUG] hook %d: %@
[DEBUG] Starting the new DB at %@
[ERROR] Failed creating ciconia_reconciliation table: %@
[ERROR] Failed creating ciconia_migration_info table: %@
[NOTICE] Step 3b: clone the extended attributes
[DEBUG] clonefile %@ -> %@
[NOTICE] Step 4: clone the hierarchy
[ERROR] createDirectoryAtURL: %@ failed: %@
[ERROR] cloneContentsOfDirectoryAtURL:%@ to:%@ failed: %@
[ERROR] setiopolicy_np(IGNORE_PERMISSIONS, OFF) failed %{errno}d
[ERROR] setiopolicy_np(SKIP_MTIME_UPDATE, OFF) failed %{errno}d
[ERROR] BRCSetupVNodeRapidAging(NO) failed %{errno}d
[DEBUG] Cloning duration: %lf
[NOTICE] Step 4b: reconcile the database
[ERROR] At least one error occured during reconciliation: %@
[NOTICE] Step 5: import the domain in FileProvider
[WARNING] importDomain:%@ failed: %@
[ERROR] importDomain %@ at %@ failed: %@
[NOTICE] Step 6: Waiting for the import to finish
[ERROR] Failed persisting import status: %@
[DEBUG] Received notification for %@ - %@
[DEBUG] Signaling the end of the import
[ERROR] Aborting import, steps: %llu/%llu, duration: %lf
[DEBUG] Import is finished (%ld, %d)
[DEBUG] Import duration: %lf
[NOTICE] Step 7: scan the DB for the migration report
[DEBUG] Reopening the migration DB at %@
[ERROR] setUpDatabaseWithError failed: %@
[ERROR] At least one error was found was analyzing the database: %@
[NOTICE] Step 8: run fpck on the imported domain
[ERROR] providerDomainWithID %@ failed: %@
[DEBUG] Found domain: %@
[ERROR] fpck return %d
[ERROR] fpck %d: %@
[NOTICE] Mismatching ciconia version (%lld - %lld), dropping
[CRIT] Ciconia is failing with: %@
[CRIT] Ciconia is failing because of signal: %d
[ERROR] Probing workdir failed
[NOTICE] reply(%@, %@)
[CRIT] Assertion failed: [migrator.persona isEqualToString:persona]
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>application-identifier</key>
<string>com.apple.CloudDocs.ciconia</string>
<key>com.apple.application-identifier</key>
<string>com.apple.CloudDocs.ciconia</string>
<key>com.apple.fileprovider.enumerate</key>
<true/>
<key>com.apple.private.MobileContainerManager.otherIdLookup</key>
<true/>
<key>com.apple.private.MobileContainerManager.unrestrictedPersona</key>
<true/>
<key>com.apple.private.clouddocs.ciconia</key>
<true/>
<key>com.apple.private.clouddocs.spi</key>
<array>
<string>queryTelemetryEnablement:</string>
</array>
<key>com.apple.private.security.storage.AppDataContainers</key>
<true/>
<key>com.apple.private.security.storage.MobileDocuments</key>
<true/>
<key>com.apple.private.security.storage.ciconia</key>
<true/>
<key>com.apple.private.vfs.authorized-access</key>
<true/>
<key>com.apple.private.vfs.skip-mtime-updates</key>
<true/>
<key>com.apple.security.app-sandbox</key>
<true/>
<key>com.apple.security.enterprise-volume-access</key>
<true/>
<key>com.apple.security.exception.files.home-relative-path.read-only</key>
<array>
<string>/Library/Mobile Documents/</string>
</array>
<key>com.apple.security.temporary-exception.files.home-relative-path.read-only</key>
<array>
<string>/Library/Mobile Documents/</string>
<string>/Documents/</string>
<string>/Desktop/</string>
</array>
</dict>
</plist>
@(#)PROGRAM:Ciconia  PROJECT:CloudDocs-1
sideFaultsCount
clonedFolders
clonedFiles
clonedSideFaults
clonedAppLibraries
cloningFailures
reconciledItems
reconciliationFailures
migratedSideFaults
nonMigratedItems
expectedMigrations
materialisedInCloudDocs
materializedInFPFS
itemsNotFoundInDB
itemsChangedDuringCloning
ignoredContentProtectedItems
packagesWithoutBundleBit
unexpectedCreations
totalItemCount
duration
cloningDuration
importDuration
uuid
ciconiaVersion
lastError
manuallyTriggered
migrationUUID
domainID
sideFaultsBelowThreshold
nonSideFaultsCompletelyMigrated
expectedAmountOfItemsMigrated
itemsThatAreNotMigrated
typeOfMigrated
typeOfNotMigrated
materialisedCountOnICD
materialisedCountOnFPFS
errorOriginatorId
ciconia/cleanup.state
currentStep
startDate
cloningStartDate
importStartDate
stats
importSteps
version
v20@?0B8@"NSError"12
ciconia
unlock
lock
unlocked
locked
ciconia-telemetry-queue-%@
PRAGMA synchronous = 0
B16@?0@"PQLConnection"8
v16@?0@"NSError"8
v8@?0
INSERT INTO ciconia_reconciliation (old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation) VALUES (%llu, NULL, NULL, NULL, NULL, NULL)
INSERT INTO ciconia_reconciliation (old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation) VALUES (NULL, %llu, NULL, NULL, NULL, NULL)
INSERT INTO ciconia_reconciliation (old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation) VALUES (%llu, %llu, %u, %llu, %llu, %u)
INSERT INTO ciconia_reconciliation (old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation) VALUES (NULL, %llu, %u, NULL, %llu, %u)
SELECT version_content_signature FROM client_items WHERE item_doc_id = %llu
com.apple.FinderInfo
files
/usr/bin/fileproviderctl fault prune '%@'
FS removal
session/ciconia_diagnose
/usr/bin/fileproviderctl check -v -d %@
fpck.out
/usr/bin/fileproviderctl dump --full-dump %@
fileprovider.dump
aborted in another thread
telemetry disabled
cannot defer
failed to defer
SELECT key, value from ciconia_migration_info
SELECT item_type, item_localsyncupstate, rowid, item_file_id, item_doc_id FROM client_items WHERE rowid > %llu ORDER BY rowid ASC LIMIT 1000
%llu
SELECT old_doc_id, old_file_id, old_generation, new_doc_id, new_file_id, new_generation, rowid FROM ciconia_reconciliation WHERE reconciled = 0 limit 100
UPDATE ciconia_reconciliation SET reconciled = 1 WHERE rowid = %llu
Couldn't update the item for rowid %llu
SELECT COUNT(*) FROM client_items WHERE item_doc_id = %llu
SELECT COUNT(*) FROM client_items WHERE item_file_id = %llu
DELETE FROM client_items WHERE item_doc_id = %llu
DELETE FROM client_items WHERE item_file_id = %llu
SELECT item_file_id, item_generation FROM client_items WHERE item_doc_id = %llu
UPDATE client_items SET item_file_id = %llu, item_generation = %u, item_doc_id = %llu WHERE item_doc_id = %llu
Couldn't update the item for docID %llu
SELECT item_generation FROM client_items WHERE item_file_id = %llu
UPDATE client_items SET item_file_id = %llu, item_generation = %u WHERE item_file_id = %llu
Couldn't update the item for fileID %llu
Ciconia
domain removal
Ciconia-
v24@?0@"NSArray"8@"NSError"16
__defaultPersonaID__
state.plist
v24@?0Q8@"NSError"16
Account for persona %@ disabled
com.apple.CloudDocs.iCloudDriveFileProviderManaged
group.com.apple.iCloudDrive
com.apple.CloudDocs.iCloudDriveFileProvider
Cleaning up old domains failed!
Library/Application Support/CloudDocs/session/db
client.db
hook.out
v24@?0@"NSString"8^B16
 CREATE TABLE ciconia_reconciliation ( old_doc_id integer, old_file_id integer, old_generation, new_doc_id integer, new_file_id integer, new_generation, reconciled integer NOT NULL DEFAULT 0)
CREATE TABLE ciconia_migration_info ( key TEXT NOT NULL primary key, value integer not null)
SELECT COUNT(*) FROM client_items
Library/Application Support/CloudDocs/session/x
Ciconia-%@
.importFinished
BRCiconiaImportDidFinish
v16@?0@"NSNotification"8
Timeout during the import
/usr/bin/fileproviderctl check -v -d -a '%@'
FPCK failed
totalMaterializedItems:\s+(\d+)
v32@?0@"NSTextCheckingResult"8Q16^B24
Received signal %d
Migration already running
v16@?0@"NSObject<OS_xpc_object>"8
persona
com.apple.CloudDocs.ciconia.activity-%@
com.apple.CloudDocs.ciconia.cleanup-%@
rangeAtIndex:
importDomain:forProviderIdentifier:fromDirectoryAtURL:completionHandler:
fp_isFileProviderError:
isDataSeparatedPersona
encodeBool:forKey:
makeNextFlushFullSync
errorWithDomain:code:userInfo:
setupPragmas
decodeInt64ForKey:
brc_errorNotOnDisk:
br_errorWithPOSIXCode:
objectOfClass:atIndex:
useBatchingWithDelay:changeCount:
URLByAppendingPathComponent:
close:
next
result
stringWithFormat:
brc_errorItemNotFound:
interfaceWithProtocol:
longLongValue
flush
unsignedLongValue
stringWithContentsOfFile:usedEncoding:error:
decodeDoubleForKey:
queryTelemetryEnablement:
setHidden:
close
identifier
objectForKeyedSubscript:
br_errorFromErrno
error
UUIDString
brc_errorInvalidParameter:value:
resourceValuesForKeys:error:
newSyncProxy
setExportedObject:
br_currentPersonaID
queryLastCiconiaVersion:
intAtIndex:
longLongAtIndex:
decodeBoolForKey:
objectForKey:
mobileDocumentsURL
enumeratorAtURL:includingPropertiesForKeys:options:errorHandler:
unsignedLongLongValue
homeDirectoryURL
stringByAppendingPathComponent:
setExportedInterface:
UUID
reportItemMismatchDuringSilentMigration:information:uuid:reply:
ciconiaMaxSideFaultsMigration
dataWithContentsOfURL:
storageURLs
objectAtIndexedSubscript:
providerDomainWithID:error:
brc_errorCiconiaFailed:
enumerateMatchesInString:options:range:usingBlock:
hasPrefix:
fileSystemRepresentation
unsignedIntValue
setObject:forKey:
boolValue
reportFinishedMigration:uuid:reply:
ciconiaMaxReconciliationFailures
defaultsForMangledID:
fileExistsAtPath:isDirectory:
initWithKeyOptions:valueOptions:capacity:
enumerateLinesUsingBlock:
brc_errorCiconiaAborted:
length
backupDatabaseToURL:error:
getDomainsForProviderIdentifier:completionHandler:
numberWithUnsignedInt:
setObjResult:error:
reportCleanupFailureDuringSilentMigration:operationType:uuid:reply:
currentPersona
defaultManager
ciconiaKeepDomainAfterMigration
brc_accountIDPathForAccountPath:
attributesOfItemAtPath:error:
fileExistsAtPath:
initWithIdentifier:displayName:
generateAndRestorePersonaContextWithPersonaUniqueString:
writeToURL:options:error:
lastPathComponent
unarchivedObjectOfClass:fromData:error:
encodeObject:forKey:
numberWithSQL:
removeItemAtURL:error:
defaultConnection
fileCreationDate
ciconiaImportTimeout
createDirectoryAtURL:withIntermediateDirectories:attributes:error:
waitStatus
br_isPromiseURL
defaultCenter
arrayWithObjects:count:
removeDomain:forProviderIdentifier:completionHandler:
encodeInteger:forKey:
numberWithBool:
fp_prettyPath
ciconiaHideMigrationDomain
numberFromString:
br_isPOSIXErrorCode:
countByEnumeratingWithState:objects:count:
fetch:
performWithFlags:action:
timeIntervalSinceNow
regularExpressionWithPattern:options:error:
copyCurrentPersonaContextWithError:
archivedDataWithRootObject:requiringSecureCoding:error:
encodeInt:forKey:
changes
setMaxConcurrentOperationCount:
setReplicated:
signalStartOfSilentTelemetry:uuid:manual:version:reply:
addObserverForName:object:queue:usingBlock:
fp_prettyDescription
decodeObjectOfClass:forKey:
UTF8String
timeIntervalSinceDate:
numberAtIndex:
br_isExcludedWithMaximumDepth:
path
sessionForBackingUpDatabasesAtURL:
encodeInt64:forKey:
bytes
setDelegate:
decodeIntegerForKey:
userPersonaUniqueString
fp_obfuscatedFilename
br_isCocoaErrorCode:
serviceListener
setRedirectStdoutToFileAtPath:
execute:
sharedManager
taskWithCommandWithArguments:
encodeDouble:forKey:
userInfo
brc_signatureIsPackage
isEqualToString:
fp_isPOSIXErrorCode:
decodeIntForKey:
setRedirectStderrToFileAtPath:
resume
exec
substringWithRange:
br_isCloudDocsErrorCode:
openAtURL:withFlags:error:
cloudDocsAppSupportURL
init
supportsSecureCoding
encodeWithCoder:
initWithCoder:
TB,R
sideFaultsCount
setSideFaultsCount:
clonedFolders
setClonedFolders:
clonedFiles
setClonedFiles:
clonedSideFaults
setClonedSideFaults:
clonedAppLibraries
setClonedAppLibraries:
cloningFailures
setCloningFailures:
reconciledItems
setReconciledItems:
reconciliationFailures
setReconciliationFailures:
migratedSideFaults
setMigratedSideFaults:
nonMigratedItems
setNonMigratedItems:
expectedMigrations
setExpectedMigrations:
materialisedInCloudDocs
setMaterialisedInCloudDocs:
materializedInFPFS
setMaterializedInFPFS:
itemsNotFoundInDB
setItemsNotFoundInDB:
itemsChangedDuringCloning
setItemsChangedDuringCloning:
ignoredContentProtectedItems
setIgnoredContentProtectedItems:
packagesWithoutBundleBit
setPackagesWithoutBundleBit:
unexpectedCreations
setUnexpectedCreations:
totalItemCount
setTotalItemCount:
duration
setDuration:
cloningDuration
setCloningDuration:
importDuration
setImportDuration:
uuid
setUuid:
.cxx_destruct
TQ,VsideFaultsCount
TQ,VclonedFolders
TQ,VclonedFiles
TQ,VclonedSideFaults
TQ,VclonedAppLibraries
TQ,VcloningFailures
TQ,VreconciledItems
TQ,VreconciliationFailures
TQ,VmigratedSideFaults
TQ,VnonMigratedItems
TQ,VexpectedMigrations
TQ,VmaterialisedInCloudDocs
TQ,VmaterializedInFPFS
TQ,VitemsNotFoundInDB
TQ,VitemsChangedDuringCloning
TQ,VignoredContentProtectedItems
TQ,VpackagesWithoutBundleBit
Tq,VunexpectedCreations
TQ,VtotalItemCount
Td,Vduration
Td,VcloningDuration
Td,VimportDuration
T@"NSUUID",&,Vuuid
migrationReportFromData:
cleanupStateURL
convertToData
ciconiaVersion
setCiconiaVersion:
lastError
setLastError:
manuallyTriggered
setManuallyTriggered:
migrationUUID
setMigrationUUID:
domainID
setDomainID:
sideFaultsBelowThreshold
setSideFaultsBelowThreshold:
nonSideFaultsCompletelyMigrated
setNonSideFaultsCompletelyMigrated:
expectedAmountOfItemsMigrated
setExpectedAmountOfItemsMigrated:
itemsThatAreNotMigrated
setItemsThatAreNotMigrated:
typeOfNotMigrated
setTypeOfNotMigrated:
materialisedCountOnICD
setMaterialisedCountOnICD:
materialisedCountOnFPFS
setMaterialisedCountOnFPFS:
typeOfMigrated
setTypeOfMigrated:
errorOriginatorId
setErrorOriginatorId:
TQ,VciconiaVersion
TB,VmanuallyTriggered
T@"NSUUID",&,VmigrationUUID
T@"NSString",&,VdomainID
T@"NSError",&,N,VlastError
TQ,VerrorOriginatorId
TB,VsideFaultsBelowThreshold
TB,VnonSideFaultsCompletelyMigrated
TQ,VexpectedAmountOfItemsMigrated
TQ,VitemsThatAreNotMigrated
T{BRTypesField=(?=i{?=b1b1b1b1b1b1b1b1b1})},VtypeOfNotMigrated
T{BRTypesField=(?=i{?=b1b1b1b1b1b1b1b1b1})},VtypeOfMigrated
TQ,VmaterialisedCountOnICD
TQ,VmaterialisedCountOnFPFS
persistedStateFromData:
currentStep
setCurrentStep:
startDate
setStartDate:
cloningStartDate
setCloningStartDate:
importStartDate
setImportStartDate:
stats
setStats:
importSteps
setImportSteps:
TQ,VcurrentStep
T@"NSDate",&,VstartDate
T@"NSDate",&,VcloningStartDate
T@"NSDate",&,VimportStartDate
T@"BRCMigrationStats",&,Vstats
TQ,VimportSteps
dealloc
version
migratorFor:withActivity:
migratorFor:withHook:
isTelemetryEnabled:
ciconiaWorkDirForCurrentPersona
probeWorkDirLock
lockUnlockWorkDir:withFD:andError:
initWithPersona:hook:andActivity:
_setUpDatabaseAt:synchronous:withError:
_closeDatabase
_docIDForURL:andFileID:error:
_reportFailedReconciliation:info:
_removeDocIDTrackedAt:docID:fileID:withError:
_reconcileDocIDTrackedAt:docID:fileID:genCount:updatedDocID:withError:
_reconcileItemAt:fileID:genCount:withError:
_isFolderAPackage:
_makeFileSparse:from:withError:
_cloneContentsOfDirectoryAtURL:to:noReconciliation:depth:
_signalMigrationStart
_fsRemoveWorkDirectory:
_removeWorkDirectory:
_removeWorkDir:canFailCleanup:
_generateDiagnosticOutput:
_cleanupAndTelemetry:
_cleanupAndTelemetry:canFailCleanup:
_removePersistedCleanupState
_cleanupAndTelemetry:canFailCleanup:persisted:
_deferActivityIfNeeded:error:
_setTypeFieldFromDBType:migrated:
_analyzeMigrationInfo:
_calculateUnexpectedCreations:
_analyzeDatabaseWithError:
_reconcileDatabaseWithError:deferred:
_generateCiconiaFPDomain:reportIfFailed:
_generateCiconiaFPDomain:reportIfFailed:removingFailed:
_cleanupOldCiconiaDomains
_openAndLockWorkDir:
_initiateSilentMigrationOf:
startMigrationOf:isExternal:error:
abortMigrationWithError:
cleanupCiconia
finishCiconiaCleanup
persona
_externalURL
_manager
_properties
_proxy
_telemetryAllowed
_telemetryQueue
_activity
_persona
_persistedState
_deviceID
_importSemaphore
_extensionID
_postDBCloneHook
_sideFaultsThreshold
_reconciliationFailuresThreshold
_isFPFSDomainHidden
_keepFPFSDomainAfterMigration
_importTimeout
_database
_targetURL
_persistURL
_nonMigratedTypes
_migratedTypes
_errorOriginatorId
_ciconiaFD
_aborted
_cleanupInProgress
initiateSilentMigrationOf:forPersonaID:withHook:andReply:
queueSilentMigrationActivityForPersonaID:withReply:
queryCiconiaVersion:
cleanupCiconiaForPersonaID:withReply:
finishCleanupForPersonaID:withReply:
isEqual:
class
self
performSelector:
performSelector:withObject:
performSelector:withObject:withObject:
isProxy
isKindOfClass:
isMemberOfClass:
conformsToProtocol:
respondsToSelector:
retain
release
autorelease
retainCount
zone
hash
superclass
description
debugDescription
TQ,R
T#,R
T@"NSString",R,C
listener:shouldAcceptNewConnection:
_scheduleBlockWithActivityForPersonaID:name:block:
BRCMigrationStats
NSSecureCoding
NSCoding
BRCMigrationReport
BRCiconiaPersistedState
BRCiconiaMigrator
CiconiaProtocol
ServiceDelegate
NSXPCListenerDelegate
NSObject
Ciconia
B16@0:8
v24@0:8@16
@24@0:8@16
v24@0:8@"NSCoder"16
@24@0:8@"NSCoder"16
Q16@0:8
v24@0:8Q16
q16@0:8
v24@0:8q16
d16@0:8
v24@0:8d16
@16@0:8
v16@0:8
@"NSUUID"
v20@0:8B16
{BRTypesField=(?=i{?=b1b1b1b1b1b1b1b1b1})}16@0:8
v20@0:8{BRTypesField=(?=i{?=b1b1b1b1b1b1b1b1b1})}16
{BRTypesField=""(?="types"i""{?="doc"b1"alias"b1"symlink"b1"folder"b1"fault"b1"root"b1"bookmark"b1"bookmarkfault"b1"shareacceptfault"b1})}
@"NSError"
@"NSString"
@"NSDate"
@"BRCMigrationStats"
@32@0:8@16@24
B24@0:8@16
B32@0:8B16i20^@24
@40@0:8@16@24@32
B36@0:8@16B24^@28
@40@0:8@16Q24^@32
v32@0:8@16@24
B48@0:8@16@24Q32^@40
B60@0:8@16@24Q32I40^@44^@52
B44@0:8@16Q24I32^@36
B40@0:8@16@24^@32
@44@0:8@16@24B32Q36
B24@0:8^@16
v24@0:8B16B20
@28@0:8@16B24
v32@0:8@16B24B28
B28@0:8B16^@20
v24@0:8c16B20
B32@0:8^@16^B24
@36@0:8@16B24^B28
@36@0:8@16B24^@28
@"NSFileManager"
@"NSArray"
@"BRXPCSyncProxy<BRProtocolShared>"
@"NSObject<OS_dispatch_queue>"
@"NSObject<OS_xpc_object>"
@"BRCiconiaPersistedState"
@"NSObject<OS_dispatch_semaphore>"
@"PQLConnection"
@"NSURL"
v48@0:8@16@24@32@?40
v32@0:8@16@?24
v24@0:8@?16
v48@0:8@"NSURL"16@"NSString"24@"NSString"32@?<v@?@"BRCMigrationStats"@"NSError">40
v32@0:8@"NSString"16@?<v@?@"NSError">24
v24@0:8@?<v@?Q>16
#16@0:8
@24@0:8:16
@32@0:8:16@24
@40@0:8:16@24@32
B24@0:8#16
B24@0:8:16
Vv16@0:8
^{_NSZone=}16@0:8
B24@0:8@"Protocol"16
@"NSString"16@0:8
B32@0:8@16@24
B32@0:8@"NSXPCListener"16@"NSXPCConnection"24
v40@0:8@16@24@?32
[WARNING] Failed restoring migration report: %@
[WARNING] Failed restoring state: %@
[ERROR] Failed opening workdir %@ %{errno}d
[ERROR] Cannot %s workdir %{errno}d
[NOTICE] workdir got %s
[CRIT] Assertion failed: !(hook != nil && activity != nil)
[ERROR] Can't close database at %@: %@
[WARNING] Failed making DB async, will execute slower
[ERROR] Failed to open %@ %{errno}d
[ERROR] Failed to open %@ (%llu) %{errno}d
[ERROR] GSLibraryGetOrAllocateDocumentId failed to allocate docID for %@ (fd:%d, fid:%lld) %{errno}d
[ERROR] fstat(%d): dev:%d, ino:%lld, mode:0x%x, lnk:%hu, uid:%d, gid:%d
[ERROR] Failed closing %@ %{errno}d
[ERROR] Failed reconciliation: %@ (%@)
[ERROR] Failed submitting event: %@
[ERROR] DB insert failed: %@
[DEBUG] Item %llu is actually a package
[DEBUG] cloning %@ -> %@ (%ld) nor:%d
[DEBUG] %@ is excluded from sync (will ignore anything below)
[WARNING] Failed querying properties for %@: %@
[ERROR] copyfile(%@, %@) failed: %@
[ERROR] Failed getting finder info for %@ %{errno}d
[ERROR] FinderInfo has invalid size (%ld - exp %ld) for %@
[WARNING] Folder %@ has mismatch between disk and DB: %d - %d
[ERROR] Failed opening %@ %{errno}d
[WARNING] copyfile %@ -> %@ failed on a class A/B file - ignoring
[ERROR] Failed removing the class A/B file %@ from DB: %@
[ERROR] copyfile %@ -> %@ failed: %@
[ERROR] Failed to make the file %@ sparse: %@
[ERROR] fileproviderctl return %d
[ERROR] Failed _removeWorkDirectory with error %@
[WARNING] Failed removing persisted state at %@: %@
[WARNING] diagnose: Failed removing %@: %@
[ERROR] diagnose: Failed creating %@: %@
[ERROR] diagnose: backupDatabaseToURL:%@ failed: %@
[DEBUG] Already undergoing a cleanup, bye!
[NOTICE] Finishing migration with error: %@
[NOTICE] Error was thrown at: %llu
[DEBUG] No target -> no telemetry
[DEBUG] Not started -> no telemetry
[WARNING] Failed persisting cleanup status: %@
[ERROR] Failed removing persisted cleanup state at %@: %@
[WARNING] Removing domain failed, retrying later...
[DEBUG] Sending final telemetry
[DEBUG] Telemetry is not allowed
[ERROR] Unexpected type!
[DEBUG] Ciconia Migration Info: %@
[ERROR] Failed migrating (%d) item (fid: %llu, did: %llu) at rowID: %llu
[DEBUG] Found an item not existing on disk at rowID: %llu
[ERROR] Marking rowID reconciled failed: %@
[NOTICE] There's no class protected item did:%llu fid:%llu in the DB
[ERROR] Failed removing data protected file did:%llu, fid:%llu: %@
[WARNING] Item with docID %llu (fid:%llu, gc:%u) not found in the DB
[WARNING] Mismatch DB/Disk for docID %llu: db(fid:%llu, gc:%lu), disk(fid:%llu, gc:%u)
[WARNING] Item with fileID %llu (gc:%u) not found in the DB
[WARNING] Mismatch DB/Disk for fileID %llu: db(gc:%lu), disk(gc:%u)
[ERROR] DB update failed: %@
[DEBUG] Will remove domain: %@
[WARNING] removeDomain:%@ failed: %@
[DEBUG] Looking for old Ciconia domains
[WARNING] Enumerating domains failed: %@
[DEBUG] Found old domain %@, dropping
[WARNING] Failed to remove old domain %@: %@
[ERROR] won't restore persona: %@
[ERROR] Can't adopt persona %@: %@
[DEBUG] Not allowed to adopt persona - should fallback persona
[DEBUG] Last ciconia was already run...
[ERROR] stating %@ failed %{errno}d
[WARNING] Creating the container failed, expect failures during the migration: %s
[WARNING] removeItemAtURL:%@ failed: %@
[ERROR] Persisted state with invalid UUID: %@ - restarting from scratch
[ERROR] workdir %@ not found - restarting from scratch
[ERROR] workdir %@ could not be locked - failing
[ERROR] Domain %@ not found - restarting from scratch
[NOTICE] Continuing activity for UUID %@ at step %lu
[DEBUG] Telemetry is not allowed, no event will be sent
[NOTICE] Initiating silent migration from %@ to %@ for %@
[NOTICE] Targets: DB = %@, files = %@
[NOTICE] Ciconia version: %llu
[NOTICE] Using activity: %p, telemetry: %d, UUID: %@
[NOTICE] Step 1: cleanup
[ERROR] _cleanupOldCiconiaDomains timed out!
[WARNING] _removeWorkDirectory failed: %@
[NOTICE] Step 2: create new target
[ERROR] Failed locking workdir %@: %@
[NOTICE] Step 3: clone the DB
[ERROR] setiopolicy_np(IGNORE_PERMISSION, ON) failed %{errno}d
[ERROR] setiopolicy_np(SKIP_MTIME_UPDATE, ON) failed %{errno}d
[ERROR] BRCSetupVNodeRapidAging(YES) failed %{errno}d
[DEBUG] Going to clone the account DSID from %@ to %@
[ERROR] clonefile failed: %@
[DEBUG] Going to clone the DB from %@ to %@
[ERROR] backupDatabaseToURL:%@ failed: %@
[DEBUG] Executing hook '%@', output in %@
[ERROR] Hook failed with status: %d
[DEBUG] hook %d: %@
[DEBUG] Starting the new DB at %@
[ERROR] Failed creating ciconia_reconciliation table: %@
[ERROR] Failed creating ciconia_migration_info table: %@
[NOTICE] Step 3b: clone the extended attributes
[DEBUG] clonefile %@ -> %@
[NOTICE] Step 4: clone the hierarchy
[ERROR] createDirectoryAtURL: %@ failed: %@
[ERROR] cloneContentsOfDirectoryAtURL:%@ to:%@ failed: %@
[ERROR] setiopolicy_np(IGNORE_PERMISSIONS, OFF) failed %{errno}d
[ERROR] setiopolicy_np(SKIP_MTIME_UPDATE, OFF) failed %{errno}d
[ERROR] BRCSetupVNodeRapidAging(NO) failed %{errno}d
[DEBUG] Cloning duration: %lf
[NOTICE] Step 4b: reconcile the database
[ERROR] At least one error occured during reconciliation: %@
[NOTICE] Step 5: import the domain in FileProvider
[WARNING] importDomain:%@ failed: %@
[ERROR] importDomain %@ at %@ failed: %@
[NOTICE] Step 6: Waiting for the import to finish
[ERROR] Failed persisting import status: %@
[DEBUG] Received notification for %@ - %@
[DEBUG] Signaling the end of the import
[ERROR] Aborting import, steps: %llu/%llu, duration: %lf
[DEBUG] Import is finished (%ld, %d)
[DEBUG] Import duration: %lf
[NOTICE] Step 7: scan the DB for the migration report
[DEBUG] Reopening the migration DB at %@
[ERROR] setUpDatabaseWithError failed: %@
[ERROR] At least one error was found was analyzing the database: %@
[NOTICE] Step 8: run fpck on the imported domain
[ERROR] providerDomainWithID %@ failed: %@
[DEBUG] Found domain: %@
[ERROR] fpck return %d
[ERROR] fpck %d: %@
[NOTICE] Mismatching ciconia version (%lld - %lld), dropping
[CRIT] Ciconia is failing with: %@
[CRIT] Ciconia is failing because of signal: %d
[ERROR] Probing workdir failed
[NOTICE] reply(%@, %@)
[CRIT] Assertion failed: [migrator.persona isEqualToString:persona]
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>application-identifier</key>
<string>com.apple.CloudDocs.ciconia</string>
<key>com.apple.application-identifier</key>
<string>com.apple.CloudDocs.ciconia</string>
<key>com.apple.fileprovider.enumerate</key>
<true/>
<key>com.apple.private.MobileContainerManager.otherIdLookup</key>
<true/>
<key>com.apple.private.MobileContainerManager.unrestrictedPersona</key>
<true/>
<key>com.apple.private.clouddocs.ciconia</key>
<true/>
<key>com.apple.private.clouddocs.spi</key>
<array>
<string>queryTelemetryEnablement:</string>
</array>
<key>com.apple.private.security.storage.AppDataContainers</key>
<true/>
<key>com.apple.private.security.storage.MobileDocuments</key>
<true/>
<key>com.apple.private.security.storage.ciconia</key>
<true/>
<key>com.apple.private.vfs.authorized-access</key>
<true/>
<key>com.apple.private.vfs.skip-mtime-updates</key>
<true/>
<key>com.apple.security.app-sandbox</key>
<true/>
<key>com.apple.security.enterprise-volume-access</key>
<true/>
<key>com.apple.security.exception.files.home-relative-path.read-only</key>
<array>
<string>/Library/Mobile Documents/</string>
</array>
<key>com.apple.security.temporary-exception.files.home-relative-path.read-only</key>
<array>
<string>/Library/Mobile Documents/</string>
<string>/Documents/</string>
<string>/Desktop/</string>
</array>
</dict>
</plist>
