<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>BuildMachineOSBuild</key>
<string>20A241133</string>
<key>CFBundleAllowMixedLocalizations</key>
<true/>
<key>CFBundleExecutable</key>
<string>storebookkeeperd</string>
<key>CFBundleIdentifier</key>
<string>com.apple.storebookkeeperd</string>
<key>CFBundleInfoDictionaryVersion</key>
<string>6.0</string>
<key>CFBundleSupportedPlatforms</key>
<array>
<string>iPhoneSimulator</string>
</array>
<key>DTCompiler</key>
<string>com.apple.compilers.llvm.clang.1_0</string>
<key>DTPlatformBuild</key>
<string>14A6200i</string>
<key>DTPlatformName</key>
<string>iphonesimulator</string>
<key>DTPlatformVersion</key>
<string>16.0</string>
<key>DTSDKBuild</key>
<string>20A300</string>
<key>DTSDKName</key>
<string>iphonesimulator16.0.internal</string>
<key>DTXcode</key>
<string>1400</string>
<key>DTXcodeBuild</key>
<string>14A6200i</string>
<key>MinimumOSVersion</key>
<string>16.0</string>
<key>UIDeviceFamily</key>
<array>
<integer>1</integer>
<integer>2</integer>
</array>
</dict>
</plist>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>DataProtectionClass</key>
<string>NSFileProtectionComplete</string>
<key>application-identifier</key>
<string>com.apple.storebookkeeperd</string>
<key>aps-connection-initiate</key>
<true/>
<key>com.apple.accounts.appleaccount.fullaccess</key>
<true/>
<key>com.apple.authkit.client.internal</key>
<true/>
<key>com.apple.itunesstored.private</key>
<true/>
<key>com.apple.private.applemediaservices</key>
<true/>
<key>com.apple.private.tcc.allow</key>
<array>
<string>kTCCServiceMediaLibrary</string>
</array>
<key>com.apple.private.tcc.manager.get-identity-for-credential</key>
<true/>
</dict>
</plist>
initWithXPCConnection:
init
setExportedObject:
serviceInterface
setExportedInterface:
serviceClientInterface
setRemoteObjectInterface:
setInvalidationHandler:
setInterruptionHandler:
remoteObjectProxy
isEqual:
playbackPositionDomain
synchronizeImmediatelyWithCompletionHandler:
_sendSyncHandlerMessageWithBlock:
beginAccessingPlaybackPositionEntities
endAccessingPlaybackPositionEntities
auditToken
description
persistPlaybackPositionEntity:isCheckpoint:clientIdentity:completionBlock:
deletePlaybackPositionEntity:clientIdentity:
deletePlaybackPositionEntitiesWithClientIdentity:
updateForeignDatabaseWithValuesFromPlaybackPositionEntity:clientIdentity:
pullLocalPlaybackPositionForEntityIdentifiers:clientIdentity:completionBlock:
pullPlaybackPositionEntity:completionBlock:
_sendValueHandlerMessageWithBlock:
pushPlaybackPositionEntity:completionBlock:
supportsSyncProtocol
initWithDomain:
serviceForXPCConnection:
class
self
performSelector:
performSelector:withObject:
performSelector:withObject:withObject:
isProxy
isKindOfClass:
isMemberOfClass:
conformsToProtocol:
respondsToSelector:
retain
release
autorelease
retainCount
zone
hash
superclass
debugDescription
TQ,R
T#,R
T@"NSString",R,C
persistPlaybackPositionEntity:isCheckpoint:completionBlock:
deletePlaybackPositionEntity:
deletePlaybackPositionEntities
updateForeignDatabaseWithValuesFromPlaybackPositionEntity:
pullLocalPlaybackPositionForEntityIdentifiers:completionBlock:
setClientConfiguration:
XPCConnection
queue
clientProxy
syncHandler
valueHandler
clientConfiguration
.cxx_destruct
_XPCConnection
_queue
_clientProxy
_syncHandler
_valueHandler
_clientConfiguration
T@"NSObject<OS_dispatch_queue>",R,N,V_queue
T@"<SBCPlaybackPositionClientProtocol>",R,N,V_clientProxy
T@"SBDDomainSyncServiceHandler",R,N,V_syncHandler
T@"SBDDomainValueServiceHandler",R,N,V_valueHandler
T@"SBCClientConfiguration",R,N,V_clientConfiguration
T@"NSXPCConnection",R,N,V_XPCConnection
domain
_domain
T@"SBCPlaybackPositionDomain",R,N,V_domain
XPCInterfaceDebugDescription
server
start
_init
currentHandler
handleFailureInMethod:object:file:lineNumber:description:
defaultIdentityStore
userIdentitiesForManageableAccountsWithError:
array
countByEnumeratingWithState:objects:count:
musicLibraryForUserAccount:
databasePath
domainForSyncingMusicLibraryWithLibraryPath:
addObject:
copy
allSyncingDomains
sharedManager
setHttpArchiveBufferSize:
_updatePushNotificationRegistrations
defaultCenter
_accountsDidChangeNotification:
addObserver:selector:name:object:
_updateForAccountChangeAfterReloadingAccounts:
addObserverForName:object:queue:usingBlock:
_updateForSharedLibraryImportFinished
synchronizeForUpdateJobForAccount:withDomain:withCompletionHandler:
initializeBackgroundTaskAgentWithJobRunner:
removeObserver:name:object:
removeObserver:
valueForKey:
invalidate
makeObjectsPerformSelector:
suspend
setDelegate:
dealloc
arrayByAddingObject:
resume
newListener
synchronizeIfNeedsInitialSynchronization
defaultStore
reloadAccounts
valueForKeyPath:
foreignDatabasePath
containsObject:
synchronizeForChangedAccountStatus
synchronizeForUpdatedRemoteDomainVersion:
_performOnDomainSyncServiceHandlerWithBookkeeperDomain:forAccountWithIdentifier:completion:
accountDSID
integerValue
domainIdentifier
isEqualToString:
_pushNotificationController
setDelegate:forBookkeeperDomain:
setEnabledDomains:
listener:shouldAcceptNewConnection:
pushNotificationController:didReceiveUpdateRequestForAccount:withBookkeeperDomain:toDomainRevision:
xpcListener
pushNotificationController
serviceConnections
_SBKStoreAccountChangedNotificationObserver
_SBKSBKSharedMusicLibraryImportFinishedObserver
_accountChangeUpdatePending
_accountChangeUpdateShouldReloadAccounts
_systemSyncHandlers
_xpcListener
_serviceConnections
T@"NSXPCListener",R,N,V_xpcListener
T@"SBDPushNotificationController",R,N,V_pushNotificationController
T@"NSArray",R,N,V_serviceConnections
enableTransactions
initWithIdentifier:
open
count
removeObject:
close
sharedInstance
beginTransactionWithIdentifier:
isInTransaction
endTransaction:
openTransactions
_openTransactions
T@"NSMutableArray",R,N,V_openTransactions
stringWithFormat:
UTF8String
identifier
_transaction
_identifier
T@"NSString",R,C,N,V_identifier
currentRunLoop
dictionaryWithCapacity:
objectForKey:
initWithPlaybackPositionDomain:
setObject:forKey:
initWithPath:
uppDatabase
UPPDomainIdentifier
initWithDomain:dataSource:automaticSynchronizeOptions:accountIdentifier:isActive:
setMaxConcurrentOperationCount:
pollingIntervalInSeconds
loadBagContextWithCompletionBlock:
dateLastSynced
timeIntervalSinceReferenceDate
numberWithDouble:
date
hasRemoteChangesToPull
hasLocalChangesToPush
hasSyncedAtleastOnce
_onOperationQueue_scheduleSyncBeforeDate:isCheckpoint:
addOperationWithBlock:
longLongValue
lastNotificationDomainVersion
setLastNotificationDomainVersion:
updateUbiquitousDatabaseByPerformingWriteTransactionWithBlock:
currentRevision
setLastSyncedEntityRevision:
setLastSyncedDomainVersion:
distantFuture
setDateToSyncWithUbiquitousStore:
updateUbiquitousDatabaseWithClientIdentity:persistUbiquitousMetadataWithEntity:
foreignDatabaseEntityID
updateUbiquitousDatabaseWithClientIdentity:removeUbiquitousMetadataFromTrackWithPersistentID:
updateMusicLibraryWithClientIdentity:applyUbiquitousBookmarkMetadataToTrackWithPersistentID:
readUbiquitousDatabaseMetadataValuesWithClientIdentity:identifiers:
timeIntervalSinceNow
dateToSyncWithUbiquitousStore
timeIntervalSinceDate:
dateWithTimeIntervalSinceNow:
jobSchedulerForAccount:withDomain:
scheduleUpdateJobWithTimeInterval:replaceExisting:
predicateWithProperty:equalToValue:
anyInLibrary:predicate:
_isEnabled
SBKBeginTransactionWithItemsToSyncEnumerationBlock:
SBKCancelUniversalPlaybackPositionTransaction:
SBKCommitUniversalPlaybackPositionTransaction:domainVersion:metadataEnumerationBlock:
bookkeeperStorageControllerDidSync:
storageControllerForPlaybackPositionDomain:
beginTransactionWithItemsToSyncEnumerationBlock:
cancelUniversalPlaybackPositionTransaction:
commitUniversalPlaybackPositionTransaction:domainVersion:metadataEnumerationBlock:
needsPoll
needsPull
needsPush
needsInitialSync
synchronizeBeforeDate:isCheckpoint:
synchronizeForUpdatedRemoteDomainVersion:beforeDate:
synchronizeForChangedAccountByResetInvalidatingLocalChanges:beforeDate:
persistPlaybackPositionEntity:clientIdentity:completionBlock:
readUbiquitousDatabaseMetadataValuesForIdentifiers:clientIdentity:
lastSynchronizedAccountIdentifier
lastSynchronizationFailureAccountIdentifier
addStorageObserver:
removeStorageObserver:
accountIdentifier
_databaseHasBookmarkableContents
_observers
_operationQueue
_uppStore
_ubiquitousDatabase
_musicLibrary
_accountIdentifier
_targetSyncDate
_playbackPositionDomain
T@"SBCPlaybackPositionDomain",R,C,N,V_playbackPositionDomain
TB,R,N
T@"NSNumber",R,C,N
supportsUPP
performDatabaseTransactionWithBlock:
valueForDatabaseProperty:
setValue:forDatabaseProperty:
numberWithUnsignedLongLong:
_setValue:forDatabaseProperty:
_valueForDatabaseProperty:
doubleValue
dateWithTimeIntervalSinceReferenceDate:
length
numberWithUnsignedInteger:
numberWithBool:
numberWithLongLong:
arrayWithObjects:count:
executeUpdate:withParameters:error:
_updateUbiquitousDatabase_setBookmarkMetadataWithValuesFromTrackWithMetadataIdentifier:hasBeenPlayed:playCount:bookmarkTime:timestamp:syncRevision:usingConnection:
ubiquitousIdentifier
initWithClientIdentity:
setPrivacyContext:
_databaseHasEntryForEntity:
hasBeenPlayedModified
hasBeenPlayed
userPlayCountModified
userPlayCount
bookmarkTimeModified
bookmarkTime
bookmarkTimestampModified
bookmarkTimestamp
allKeys
appendFormat:
appendString:
enumerateObjectsUsingBlock:
executeQuery:withParameters:
numberForColumnIndex:
enumerateRowsWithBlock:
hasAtLeastOneRow
databaseConnectionAllowingWrites:withBlock:
initWithPersistentID:inLibrary:
valueForProperty:
boolValue
dictionaryWithObjects:forKeys:count:
setValuesForPropertiesWithDictionary:
defaultRenderer
statementWithPrefix:inParameterCount:
allObjects
firstObject
stringWithString:
subarrayWithRange:
stringForColumnIndex:
initWithPlaybackPositionDomain:ubiquitousIdentifier:foreignDatabaseEntityID:
unsignedIntegerValue
setUserPlayCount:
setHasBeenPlayed:
setBookmarkTime:
setBookmarkTimestamp:
lastSyncedDomainVersion
lastSyncedEntityRevision
musicLibrary
predicateWithProperty:value:comparison:
executeQuery:
stringValue
unsignedLongLongValue
initWithMusicLibrary:
setDateLastSynced:
updateUbiquitousDatabaseByInsertingUbiquitousMetadataForTrackWithMetadataIdentifier:hasBeenPlayed:playCount:bookmarkTime:timestamp:syncRevision:
updateUbiquitousDatabaseByResetingSyncEntityRevisionForItemsWithMetadataIdentifiers:
readUbiquitousDatabaseMetadataValuesWithClientIdentity:identifier:
dumpUbiquitousMetadata
T@"ML3MusicLibrary",R,W,N,V_musicLibrary
TQ,N
T@"NSString",C,N
T@"NSDate",&,N
setTimeStyle:
setDateStyle:
stringFromDate:
setMusicLibrary:
transactionEntityRevision
setTransactionEntityRevision:
ubiquitousIdentifiersToSync
setUbiquitousIdentifiersToSync:
_lastSyncedEntityRevision
_transactionEntityRevision
_lastSyncedDomainVersion
_ubiquitousIdentifiersToSync
T@"ML3MusicLibrary",&,N,V_musicLibrary
TQ,N,V_lastSyncedEntityRevision
TQ,N,V_transactionEntityRevision
T@"NSString",C,N,V_lastSyncedDomainVersion
T@"NSMutableSet",&,N,V_ubiquitousIdentifiersToSync
entity
enumerateValuesForProperties:usingBlock:
initWithUbiquitousIdentifier:inLibrary:
_entity
T@"NSString",R,N,V_identifier
T@"SBCPlaybackPositionEntity",R,N,V_entity
dictionary
setWithArray:
null
objectAtIndex:
getValues:forProperties:count:
SBKPropertyValueForML3PropertyValue:ML3Property:
persistentID
track
_persistentID
_track
Tq,R,N,V_persistentID
T@"ML3Track",R,N,V_track
URLWithString:
unsignedIntValue
numberWithInteger:
unsignedLongValue
predicateMatchingPredicates:
unrestrictedAllItemsQueryWithlibrary:predicate:orderingTerms:
SBKQueryForTracksNeedingPushWithEntityRevisionAnchor:orderingTerms:
enumeratePersistentIDsUsingBlock:
SBKSQLQueryStringForItemsNeedingPush
performReadOnlyDatabaseTransactionWithBlock:
itemIdentifier
timestamp
playCount
enumerateKeysAndObjectsUsingBlock:
removeObjectsForKeys:
delegate
_delegate
T@"<SBDPushNotificationControllerDelegate>",W,N,V_delegate
storeBookkeeperPreferences
objectForKey:withDefaultValue:
unarchivedObjectOfClasses:fromData:error:
_startServiceConnectionsWithCompletionHandler:
removeFromRunLoop
objectForKeyedSubscript:
setEnabledTopics:
updateNotificationRegistrationsWithCompletionBlock:
removeObjectForKey:
_onQueue_updateConnectionTopicsAndStoreRegistrations
isEqualToSet:
updateStoreBookkeeperNotificationRegistration:
initWithCapacity:
initWithObjects:
_portNameForEnvironmentName:
initWithEnvironmentName:namedDelegatePort:queue:
publicToken
base64EncodedStringWithOptions:
_loadURLBagWithCompletionHandler:
initWithURLBagContext:
loadWithCompletionBlock:
allValues
unionSet:
archivedDataWithRootObject:requiringSecureCoding:error:
setObject:forKeyedSubscript:
requestForDomain:optIn:accountID:typeRegistrationURL:
isEqualToRegistrationRequest:
cancel
requestProperties
statusCode
allHeaderFields
startWithConnectionResponseBlock:
_onQueue_updateStoreBookkeeperNotificationRegistration:
_onQueue_updateStoreBookkeeperNotificationRegistrationForDomain:optIn:accountID:withCompletionHandler:
_registeredAccountIDs
optIn
storeAccountID
connection:didReceivePublicToken:
connection:didReceiveToken:forTopic:identifier:
connection:didReceiveToken:forInfo:
connection:didReceiveURLToken:forInfo:
connection:didReceiveURLTokenError:forInfo:
connection:didReceiveIncomingMessage:
connection:didReceiveMessageForTopic:userInfo:
connection:didSendOutgoingMessage:
connection:didFailToSendOutgoingMessage:error:
connection:didChangeConnectedStatus:
connectionDidReconnect:
connection:channelSubscriptionsFailedWithFailures:
isEnabledForDomain:
enabledDomains
connection
weakDomainDelegates
pendingAccountRequests
registeredAccountsForDomains
_environment
_temporaryConnectionsByEnvironment
_typeRegistrationURL
_enabledDomains
_pushEnabled
_bagLoaded
_registrationUpdateScheduled
_fakeNotificationObserver
_connection
_weakDomainDelegates
_pendingAccountRequests
_registeredAccountsForDomains
T@"APSConnection",R,N,V_connection
T@"NSMutableDictionary",R,N,V_weakDomainDelegates
T@"NSMutableDictionary",R,N,V_pendingAccountRequests
T@"NSMutableDictionary",R,N,V_registeredAccountsForDomains
T@"NSSet",&,N
_requestPropertiesForDomain:optIn:typeRegistrationURL:
initWithRequestProperties:
initWithURL:
setHTTPMethod:
setValue:forHTTPHeaderField:
setITunesStoreRequest:
copyDeviceGUID
setRequestParameters:
initWithDomain:optIn:accountID:typeRegistrationURL:
_optIn
_storeAccountID
T@"NSNumber",R,N,V_storeAccountID
T@"NSString",R,C,N,V_domain
TB,R,N,V_optIn
componentsSeparatedByString:
bodyData
propertyListFromData:mutabilityOption:format:errorDescription:
initWithDomain:code:userInfo:
_onQueueSynchronizeWithInterval:isCheckpoint:
_onQueue_clearHasChanges
synchronizeImmediately
synchronizeForChangedAccountByResetInvalidatingLocalChanges:
syncedStorageController
preferredSynchronizeInterval
hasChangesToPush
isActive
_hasChangesToPush
_isActive
_syncedStorageController
_preferredSynchronizeInterval
T@"SBDDomainSyncedStorageController",R,N,V_syncedStorageController
Td,R,N,V_preferredSynchronizeInterval
TB,R,N,V_hasChangesToPush
TB,R,N,V_isActive
initWithDomain:dataSource:automaticSynchronizeOptions:isActive:
copyWithValuesFromSBKUniversalPlaybackPositionMetadata:
pullMetadataItemWithItemIdentifier:completionBlock:
SBKUniversalPlaybackPositionMetadata
pushMetadataItem:completionBlock:
cloudStore
_cloudStore
T@"SBKUniversalPlaybackPositionStore",R,N,V_cloudStore
setDomain:
setAccountIdentifier:
removeScheduledJobs
T@"NSString",C,N,V_domain
T@"NSNumber",C,N,V_accountIdentifier
Connection invalidated: %@
Connection interrupted: %@
client %@ did not supply a domain in client connection configuration %@
Could not create client identity from XPCConnection=%@
attempt to use sync APIs on domain (%@) that does not support the sync protocol
Starting storebookkeeperd
Vending services: %@
Exiting storebookkeeperd main()
SBCPlaybackPositionDomain: Error fetching user identities. err=%@
Starting service 'SBCPlaybackPositionService'
reloading store accounts
Handling account did change notification
Dropping handler. foreignDatabasePath=nil
Dropping handler. handlerAccountID=nil
Dropping handler. handlerAccountID not in storeAccountIdentifiers
Scheduling reset sync
[SBDDomainSyncServiceHandler synchronizeForUpdatedRemoteDomainVersion]
synchronizeImmediatelyWithCompletionHandler
unable to load bag and determine polling interval
checking needsPoll, pollIntervalInSeconds = %@, lastSynced = %@ (%@)
received request update for domain version change to version: %@
skipping scheduling a sync, last synced domain version already %@
received request handle account change (set sync anchor to 0%@)
clearing all local changes that had been scheduled for push
reseting sync anchor to 0, and scheduling pull from server
running synchronizeImmediatelyWithCompletionHandler: now
received request to scheduleSyncBeforeDate: %@ (in %.2f sec)
target sync date from client: %@ (in %.2f sec)
target sync date in database has been passed, using sync date of 'now': %@ (in %.2f sec)
target sync date from database: %@ (in %.2f sec)
setting target date to: %@ (in %.2f sec)
scheduling sync NOW.
scheduling sync (via BackgroundTaskJob) %f seconds from now...
setting %@ to %@
failed to update ubiquitous bookmarkmatadata for metadata identifier %@.
updateMusicLibraryByApplyingUbiquitousBookmarkMetadataToTrackWithPersistentID:, persistentID %lld doesn't exist.
Error: SBDPushNotificationController init: Error unarchiving _registeredDomains from registeredDomains. registeredDomains=%@ error=%@
%@ APSConnection (env:%@) = %@ removed from runloop in dealloc
%@ connection:%@ didReceivePublicToken:%@
%@ connection:%@ didReceiveMessageForTopic:%@ userInfo:%@
Received push notification for storebookkeeper topic '%@' with userInfo %@
Received push notification for storebookkeeper domain '%@
Processing push notification for storebookkeeper domain '%@', version %@
%@ connection:%@ didReceiveIncomingMessage:%@
%@ connection:%@ didSendOutgoingMessage:%@
%@ connection:%@ didFailToSendOutgoingMessage:%@, error = %@
%@ connection:%@ didChangeConnectedStatus: connected = %d
%@ connectionDidReconnect:%@
Setting APNS connection enabled topics to %@ on connection %@
%@ Beginning APS bringup - creating connections...
%@ Push enabled: %d, environment: %@
%@->_connection (env:%@) = %@
%@ APSConnection (env:%@) = %@ removed from runloop
Push token: %@
Loading URL Bag
Finished loading URL Bag.  _pushEnabled = %@, _typeRegistrationURL = %@, _env = %@
Unable to update push notification registration to %@ for domain '%@' (accountID %@): reason = 'URL bag has not been loaded'.
Unable to update push notification registration to %@ for domain '%@' (accountID %@): reason = 'type registration URL not found in URL bag'.
Skipping opt-in push notification registration attempt for domain '%@' (accountID %@).  reason = 'push is not enabled at the moment'.
Unable to update push notification registration to %@ for domain '%@' (accountID %@): reason = 'account ID missing, not set, or unspecified'.
Skipping opt-out push notification registration attempt for domain '%@' (accountID %@).  reason = 'itunesstored has already sent an opt-out on our behalf'.
Making sure blocked accountID %@ is opted-out for push notifications
%@ push notification registration for domain '%@' (accountID: %@)
StoreBookkeeper update push notification registration to %@ for domain '%@' (accountID %@) issuing request %@ with properties %@
StoreBookkeeper update push notification registration to %@ for domain '%@' (accountID: %@) returned response %@ with status %ld with decoded body %@%@
...response-headers %@
ERROR: exception while handling SBKBlacklistedAccountIDs preference: %@
Received request: -%@, client=%@, entity=%@
[UPP] attempt to set hasChangeToPush while inactive may result in changes not being pushed to the servers.
received push notification event, %@'s version changed to %@
received changed account event, will reset sync%@
received request to do initial sync
received changed account event, will schedule sync
received request to synchronize immediately
v16@?0@"SBDDomainSyncServiceHandler"8
v16@?0@"SBDDomainValueServiceHandler"8
SBDServer.m
Use +sharedInstance instead
com.apple.storebookkeeperd.SBDServer
SBKStoreAccountChangedNotification
v16@?0@"NSNotification"8
SBKSharedMusicLibraryImportFinished
v32@?0@"NSNumber"8@"NSString"16@?<v@?B@"NSError">24
v20@?0B8@"NSError"12
XPCConnection
com.apple.storebookkeeperd.launched
@distinctUnionOfObjects.domain.foreignDatabasePath
com.apple.storebookkeeperd.XPCTransactionController
%@ identifier = %@ %@
DaemonTemporaryKeepAlive
v20@?0@"SBKStoreURLBagContext"8B16
 and clear last-sync revision number
com.apple.amp.storebookkeeperd
Default
Push
Server
SBDML3UbiquitousDatabase.m
use initWithMusicLibrary:
MLUbiquitousBookmarkEntityRevisionAnchor
MPUbiquitousBookmarkDomainVersionAnchorToken
MPDateLastSynced
MPUbiquitousBookmarkDomainVersionRemoteToken
MPDateToSyncWithUbiquitousStore
INSERT OR REPLACE INTO cloud_kvs (key, play_count_user, has_been_played, bookmark_time_ms, bookmark_sync_timestamp, bookmark_sync_revision) VALUES (?, ?, ?, ?, ?, ?)
has_been_played
play_count_user
bookmark_time_ms
bookmark_sync_timestamp
bookmark_sync_revision
%@ = ?
v32@?0@"NSString"8Q16^B24
UPDATE cloud_kvs SET %@ WHERE key = ?
SELECT item_pid, play_count_user, has_been_played, bookmark_time_ms FROM cloud_kvs INNER JOIN item_kvs USING (key) LEFT OUTER JOIN item USING (item_pid) WHERE key = ? AND item.item_pid IS NOT NULL
UPDATE item_stats SET bookmark_time_ms = ?, has_been_played = ?, play_count_user = ? where item_pid = ?
SELECT key FROM cloud_kvs WHERE key = ?
v16@?0@"ML3DatabaseConnection"8
DELETE FROM cloud_kvs WHERE key = ?
SELECT play_count_user, has_been_played, bookmark_time_ms FROM cloud_kvs WHERE key = ?
UPDATE cloud_kvs SET bookmark_sync_timestamp = ?, bookmark_sync_revision = ? WHERE key = ?
UPDATE cloud_kvs SET bookmark_sync_revision = 0 WHERE key
SELECT key, play_count_user, has_been_played, bookmark_time_ms, bookmark_sync_timestamp FROM cloud_kvs WHERE key
SELECT key, title, item_pid, bookmark_sync_timestamp, bookmark_time_ms, has_been_played, play_count_user  FROM cloud_kvs JOIN item_kvs using (key) JOIN item_extra using (item_pid)
id = %s; titles = %s; item_pids = %s; timestamp = %s; bookmark_time_ms = %s; has_been_played = %s; play_count_user %s
__SBDML3UbiquitousDatabaseKey
<NO VERSION>
%@: lastSyncedDomainVersion = %@, entityRevisions.lastSynced = %llu, entityRevisions.currentSyncTransaction = %llu)
v32@?0@"NSString"8@16^B24
%@ properties = %@
@16@?0@8
SELECT key FROM cloud_kvs LEFT OUTER JOIN item_kvs using (key) WHERE item_pid IS NULL AND bookmark_sync_timestamp != 0 AND bookmark_sync_revision >= ?
v32@?0q8Q16^B24
v32@?0@"ML3DatabaseRow"8@"NSError"16^B24
B16@?0@"ML3DatabaseConnection"8
v32@?0@"SBKUniversalPlaybackPositionMetadata"8@"ML3Track"16^B24
v32@?0@"SBKUniversalPlaybackPositionMetadata"8@16^B24
v32@?0@8@16^B24
com.apple.storebookkeeper
push-notifications.environment
push-notification-types.add-push-notification-type-url
SBKPushNotificationRegisteredDomains
com.apple.SBD.push-notification-controller
v32@?0@"NSString"8@"APSConnection"16^B24
PushNotificationConfiguration-LoadURLBag
v24@?0@"NSDictionary"8@"NSError"16
com.apple.aps.storebookkeeperd
com.apple.aps.storebookkeeperd.dev
com.apple.aps.storebookkeeperd.demo
Opt-in to
Opt-out of
, **error** = %@, %@
status
v24@?0@"SSURLConnectionResponse"8@"NSError"16
v28@?0@"NSString"8B16@"NSNumber"20
v32@?0@"NSString"8@"SBDPushRegistrationRequest"16^B24
domain
v32@?0@"NSString"8@"NSSet"16^B24
POST
application/x-apple-plist
Content-Type
bookkeeperDomain:%@
guid
notification-type
mzbookkeeper
put-parameters
SBKBlacklistedAccountIDs
unknown error
bad password token
unrecognized push notification type
no push device error
bad parameters in request
Request Failed: response status error (%d) '%@'
v8@?0
v12@?0B8
 (dropping local changes)
v40@?0@"SBKUniversalPlaybackPositionMetadata"8@"NSString"16@"NSString"24@"NSError"32
SBDPlaybackPositionService
SBCPlaybackPositionServiceProtocol_Internal
SBCPlaybackPositionServiceProtocol
SBCDomainSyncServiceProtocol
NSObject
SBCDomainValueServiceProtocol
SBCDomainSyncServiceProtocol_Internal
SBDDomainServiceHandler
SBDServer
NSXPCListenerDelegate
SBDPushNotificationControllerDelegate
XPCTransactionController
XPCTransaction
SBDDomainSyncedStorageController
SBKUniversalPlaybackPositionDataSource
SBDML3UbiquitousDatabase
SBDPlaybackPositionTransaction
SBKUniversalPlaybackPositionTransactionContext
SBDPlaybackPositionMediaItem
SBKUniversalPlaybackPositionMediaItem
SBDPlaybackPositionML3TrackMediaItem
SBKML3Properties
SBKSync
SBDWeakDomainDelegate
SBDPushNotificationController
APSConnectionDelegate
SBDPushRegistrationRequest
SBDDomainSyncServiceHandler
SBDDomainSyncedStorageObserver
SBDDomainValueServiceHandler
SBDJobScheduler
@24@0:8@16
B24@0:8@16
#16@0:8
@16@0:8
@24@0:8:16
@32@0:8:16@24
@40@0:8:16@24@32
B16@0:8
B24@0:8#16
B24@0:8:16
Vv16@0:8
Q16@0:8
^{_NSZone=}16@0:8
B24@0:8@"Protocol"16
@"NSString"16@0:8
Vv36@0:8@16B24@?28
Vv24@0:8@16
Vv32@0:8@16@?24
Vv36@0:8@"SBCPlaybackPositionEntity"16B24@?<v@?B>28
Vv24@0:8@"SBCPlaybackPositionEntity"16
Vv32@0:8@"NSArray"16@?<v@?B@"NSError"@"NSArray">24
Vv32@0:8@"SBCPlaybackPositionEntity"16@?<v@?B@"NSError"@"SBCPlaybackPositionEntity">24
Vv24@0:8@?16
Vv24@0:8@?<v@?B@"NSError">16
Vv24@0:8@"SBCClientConfiguration"16
v24@0:8@?16
v16@0:8
@"NSXPCConnection"
@"NSObject<OS_dispatch_queue>"
@"<SBCPlaybackPositionClientProtocol>"
@"SBDDomainSyncServiceHandler"
@"SBDDomainValueServiceHandler"
@"SBCClientConfiguration"
@"SBCPlaybackPositionDomain"
B32@0:8@16@24
B32@0:8@"NSXPCListener"16@"NSXPCConnection"24
v48@0:8@16@24@32@40
v48@0:8@"SBDPushNotificationController"16@"NSNumber"24@"NSString"32@"NSString"40
v20@0:8B16
v24@0:8@16
v40@0:8@16@24@?32
@"NSMutableArray"
@"NSXPCListener"
@"SBDPushNotificationController"
@"NSArray"
@"NSObject<OS_os_transaction>"
@"NSString"
@24@0:8@?16
@"<SBKUniversalPlaybackPositionTransactionContext>"24@0:8@?<v@?@"<SBKUniversalPlaybackPositionMediaItem>">16
v24@0:8@"<SBKUniversalPlaybackPositionTransactionContext>"16
v40@0:8@"<SBKUniversalPlaybackPositionTransactionContext>"16@"NSString"24@?<@"SBKUniversalPlaybackPositionMetadata"@?>32
v28@0:8@16B24
v32@0:8@16@24
v28@0:8B16@20
@32@0:8@16@24
@"NSOperationQueue"
@"SBKUniversalPlaybackPositionStore"
@"SBDML3UbiquitousDatabase"
@"ML3MusicLibrary"
@"NSNumber"
@"NSDate"
v24@0:8Q16
B68@0:8@16B24Q28d36d44q52@60
B60@0:8@16B24Q28d36d44q52
v32@0:8@16q24
@"NSMutableSet"
v32@0:8@16@?24
v32@0:8@"NSSet"16@?<v@?@"NSString"@^B>24
@"SBCPlaybackPositionEntity"
@32@0:8q16@24
q16@0:8
@"ML3Track"
@32@0:8Q16@24
@"<SBDPushNotificationControllerDelegate>"
v40@0:8@16@24@32
v32@0:8@"APSConnection"16@"NSData"24
v48@0:8@"APSConnection"16@"NSData"24@"NSString"32@"NSString"40
v40@0:8@"APSConnection"16@"NSData"24@"APSAppTokenInfo"32
v40@0:8@"APSConnection"16@"APSURLToken"24@"APSURLTokenInfo"32
v40@0:8@"APSConnection"16@"NSError"24@"APSURLTokenInfo"32
v32@0:8@"APSConnection"16@"APSIncomingMessage"24
v40@0:8@"APSConnection"16@"NSString"24@"NSDictionary"32
v32@0:8@"APSConnection"16@"APSOutgoingMessage"24
v40@0:8@"APSConnection"16@"APSOutgoingMessage"24@"NSError"32
v28@0:8@"APSConnection"16B24
v24@0:8@"APSConnection"16
v32@0:8@"APSConnection"16@"NSArray"24
v44@0:8@16B24@28@?36
@"NSMutableDictionary"
@"NSURL"
@"NSSet"
@"APSConnection"
@44@0:8@16B24@28@36
@36@0:8@16B24@28
v24@0:8@"SBDDomainSyncedStorageController"16
v28@0:8d16B24
d16@0:8
@"SBDDomainSyncedStorageController"
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>BuildMachineOSBuild</key>
<string>20A241133</string>
<key>CFBundleAllowMixedLocalizations</key>
<true/>
<key>CFBundleExecutable</key>
<string>storebookkeeperd</string>
<key>CFBundleIdentifier</key>
<string>com.apple.storebookkeeperd</string>
<key>CFBundleInfoDictionaryVersion</key>
<string>6.0</string>
<key>CFBundleSupportedPlatforms</key>
<array>
<string>iPhoneSimulator</string>
</array>
<key>DTCompiler</key>
<string>com.apple.compilers.llvm.clang.1_0</string>
<key>DTPlatformBuild</key>
<string>14A6200i</string>
<key>DTPlatformName</key>
<string>iphonesimulator</string>
<key>DTPlatformVersion</key>
<string>16.0</string>
<key>DTSDKBuild</key>
<string>20A300</string>
<key>DTSDKName</key>
<string>iphonesimulator16.0.internal</string>
<key>DTXcode</key>
<string>1400</string>
<key>DTXcodeBuild</key>
<string>14A6200i</string>
<key>MinimumOSVersion</key>
<string>16.0</string>
<key>UIDeviceFamily</key>
<array>
<integer>1</integer>
<integer>2</integer>
</array>
</dict>
</plist>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>DataProtectionClass</key>
<string>NSFileProtectionComplete</string>
<key>application-identifier</key>
<string>com.apple.storebookkeeperd</string>
<key>aps-connection-initiate</key>
<true/>
<key>com.apple.accounts.appleaccount.fullaccess</key>
<true/>
<key>com.apple.authkit.client.internal</key>
<true/>
<key>com.apple.itunesstored.private</key>
<true/>
<key>com.apple.private.applemediaservices</key>
<true/>
<key>com.apple.private.tcc.allow</key>
<array>
<string>kTCCServiceMediaLibrary</string>
</array>
<key>com.apple.private.tcc.manager.get-identity-for-credential</key>
<true/>
</dict>
</plist>
valueForProperty:
valueForKeyPath:
valueForKey:
valueForDatabaseProperty:
userPlayCountModified
userPlayCount
userIdentitiesForManageableAccountsWithError:
unsignedLongValue
unsignedLongLongValue
unsignedIntegerValue
unsignedIntValue
unrestrictedAllItemsQueryWithlibrary:predicate:orderingTerms:
unionSet:
unarchivedObjectOfClasses:fromData:error:
ubiquitousIdentifier
timestamp
timeIntervalSinceReferenceDate
timeIntervalSinceNow
timeIntervalSinceDate:
suspend
supportsSyncProtocol
subarrayWithRange:
stringWithString:
stringWithFormat:
stringValue
stringFromDate:
stringForColumnIndex:
storeBookkeeperPreferences
statusCode
statementWithPrefix:inParameterCount:
startWithConnectionResponseBlock:
sharedManager
setWithArray:
setValuesForPropertiesWithDictionary:
setValue:forHTTPHeaderField:
setValue:forDatabaseProperty:
setUserPlayCount:
setTimeStyle:
setRequestParameters:
setRemoteObjectInterface:
setPrivacyContext:
setObject:forKeyedSubscript:
setObject:forKey:
setMaxConcurrentOperationCount:
setInvalidationHandler:
setInterruptionHandler:
setITunesStoreRequest:
setHttpArchiveBufferSize:
setHasBeenPlayed:
setHTTPMethod:
setExportedObject:
setExportedInterface:
setEnabledTopics:
setDateStyle:
setBookmarkTimestamp:
setBookmarkTime:
serviceInterface
serviceClientInterface
resume
requestProperties
removeObserver:name:object:
removeObserver:
removeObjectsForKeys:
removeObjectForKey:
removeObject:
removeFromRunLoop
remoteObjectProxy
reloadAccounts
pushMetadataItem:completionBlock:
pullMetadataItemWithItemIdentifier:completionBlock:
publicToken
propertyListFromData:mutabilityOption:format:errorDescription:
predicateWithProperty:value:comparison:
predicateWithProperty:equalToValue:
predicateMatchingPredicates:
pollingIntervalInSeconds
playCount
performReadOnlyDatabaseTransactionWithBlock:
performDatabaseTransactionWithBlock:
objectForKeyedSubscript:
objectForKey:withDefaultValue:
objectForKey:
objectAtIndex:
numberWithUnsignedLongLong:
numberWithUnsignedInteger:
numberWithLongLong:
numberWithInteger:
numberWithDouble:
numberWithBool:
numberForColumnIndex:
null
newListener
musicLibraryForUserAccount:
makeObjectsPerformSelector:
longLongValue
loadWithCompletionBlock:
loadBagContextWithCompletionBlock:
length
itemIdentifier
isEqualToString:
isEqualToSet:
integerValue
initWithURLBagContext:
initWithURL:
initWithPlaybackPositionDomain:ubiquitousIdentifier:foreignDatabaseEntityID:
initWithPath:
initWithObjects:
initWithEnvironmentName:namedDelegatePort:queue:
initWithDomain:dataSource:automaticSynchronizeOptions:isActive:
initWithDomain:dataSource:automaticSynchronizeOptions:accountIdentifier:isActive:
initWithDomain:code:userInfo:
initWithClientIdentity:
initWithCapacity:
hasBeenPlayedModified
hasBeenPlayed
hasAtLeastOneRow
handleFailureInMethod:object:file:lineNumber:description:
getValues:forProperties:count:
foreignDatabasePath
foreignDatabaseEntityID
firstObject
executeUpdate:withParameters:error:
executeQuery:withParameters:
executeQuery:
enumerateRowsWithBlock:
enumeratePersistentIDsUsingBlock:
enumerateObjectsUsingBlock:
enumerateKeysAndObjectsUsingBlock:
enableTransactions
domainIdentifier
domainForSyncingMusicLibraryWithLibraryPath:
distantFuture
dictionaryWithObjects:forKeys:count:
dictionaryWithCapacity:
dictionary
defaultStore
defaultRenderer
defaultIdentityStore
defaultCenter
dateWithTimeIntervalSinceReferenceDate:
dateWithTimeIntervalSinceNow:
date
databasePath
databaseConnectionAllowingWrites:withBlock:
currentRunLoop
currentRevision
currentHandler
countByEnumeratingWithState:objects:count:
count
copyWithValuesFromSBKUniversalPlaybackPositionMetadata:
copyDeviceGUID
copy
containsObject:
componentsSeparatedByString:
boolValue
bookmarkTimestampModified
bookmarkTimestamp
bookmarkTimeModified
bookmarkTime
bodyData
base64EncodedStringWithOptions:
auditToken
arrayWithObjects:count:
arrayByAddingObject:
array
archivedDataWithRootObject:requiringSecureCoding:error:
appendString:
appendFormat:
anyInLibrary:predicate:
allValues
allObjects
allKeys
allHeaderFields
addOperationWithBlock:
addObserverForName:object:queue:usingBlock:
addObserver:selector:name:object:
addObject:
accountDSID
XPCInterfaceDebugDescription
UTF8String
URLWithString:
UPPDomainIdentifier
SBKUniversalPlaybackPositionMetadata
init
serviceForXPCConnection:
isEqual:
class
self
performSelector:
performSelector:withObject:
performSelector:withObject:withObject:
isProxy
isKindOfClass:
isMemberOfClass:
conformsToProtocol:
respondsToSelector:
retain
release
autorelease
retainCount
zone
hash
superclass
description
debugDescription
TQ,R
T#,R
T@"NSString",R,C
beginAccessingPlaybackPositionEntities
endAccessingPlaybackPositionEntities
persistPlaybackPositionEntity:isCheckpoint:completionBlock:
deletePlaybackPositionEntity:
deletePlaybackPositionEntities
updateForeignDatabaseWithValuesFromPlaybackPositionEntity:
pullLocalPlaybackPositionForEntityIdentifiers:completionBlock:
pullPlaybackPositionEntity:completionBlock:
pushPlaybackPositionEntity:completionBlock:
synchronizeImmediatelyWithCompletionHandler:
setClientConfiguration:
initWithXPCConnection:
_sendSyncHandlerMessageWithBlock:
_sendValueHandlerMessageWithBlock:
XPCConnection
queue
clientProxy
syncHandler
valueHandler
clientConfiguration
.cxx_destruct
_XPCConnection
_queue
_clientProxy
_syncHandler
_valueHandler
_clientConfiguration
T@"NSObject<OS_dispatch_queue>",R,N,V_queue
T@"<SBCPlaybackPositionClientProtocol>",R,N,V_clientProxy
T@"SBDDomainSyncServiceHandler",R,N,V_syncHandler
T@"SBDDomainValueServiceHandler",R,N,V_valueHandler
T@"SBCClientConfiguration",R,N,V_clientConfiguration
T@"NSXPCConnection",R,N,V_XPCConnection
initWithDomain:
domain
_domain
T@"SBCPlaybackPositionDomain",R,N,V_domain
_accountsDidChangeNotification:
invalidate
dealloc
server
allSyncingDomains
listener:shouldAcceptNewConnection:
pushNotificationController:didReceiveUpdateRequestForAccount:withBookkeeperDomain:toDomainRevision:
_init
start
_pushNotificationController
_updateForSharedLibraryImportFinished
_updateForAccountChangeAfterReloadingAccounts:
synchronizeForUpdateJobForAccount:withDomain:withCompletionHandler:
_performOnDomainSyncServiceHandlerWithBookkeeperDomain:forAccountWithIdentifier:completion:
_updatePushNotificationRegistrations
xpcListener
pushNotificationController
serviceConnections
_SBKStoreAccountChangedNotificationObserver
_SBKSBKSharedMusicLibraryImportFinishedObserver
_accountChangeUpdatePending
_accountChangeUpdateShouldReloadAccounts
_systemSyncHandlers
_xpcListener
_serviceConnections
T@"NSXPCListener",R,N,V_xpcListener
T@"SBDPushNotificationController",R,N,V_pushNotificationController
T@"NSArray",R,N,V_serviceConnections
sharedInstance
beginTransactionWithIdentifier:
isInTransaction
endTransaction:
openTransactions
_openTransactions
T@"NSMutableArray",R,N,V_openTransactions
initWithIdentifier:
open
close
identifier
_transaction
_identifier
T@"NSString",R,C,N,V_identifier
storageControllerForPlaybackPositionDomain:
beginTransactionWithItemsToSyncEnumerationBlock:
cancelUniversalPlaybackPositionTransaction:
commitUniversalPlaybackPositionTransaction:domainVersion:metadataEnumerationBlock:
initWithPlaybackPositionDomain:
needsPoll
needsPull
needsPush
needsInitialSync
synchronizeBeforeDate:isCheckpoint:
synchronizeForUpdatedRemoteDomainVersion:beforeDate:
synchronizeForChangedAccountByResetInvalidatingLocalChanges:beforeDate:
persistPlaybackPositionEntity:clientIdentity:completionBlock:
deletePlaybackPositionEntity:clientIdentity:
updateForeignDatabaseWithValuesFromPlaybackPositionEntity:clientIdentity:
readUbiquitousDatabaseMetadataValuesForIdentifiers:clientIdentity:
lastSynchronizedAccountIdentifier
lastSynchronizationFailureAccountIdentifier
addStorageObserver:
removeStorageObserver:
_onOperationQueue_scheduleSyncBeforeDate:isCheckpoint:
accountIdentifier
_databaseHasBookmarkableContents
_isEnabled
playbackPositionDomain
_observers
_operationQueue
_uppStore
_ubiquitousDatabase
_musicLibrary
_accountIdentifier
_targetSyncDate
_playbackPositionDomain
T@"SBCPlaybackPositionDomain",R,C,N,V_playbackPositionDomain
TB,R,N
T@"NSNumber",R,C,N
doubleValue
initWithMusicLibrary:
updateUbiquitousDatabaseByPerformingWriteTransactionWithBlock:
_valueForDatabaseProperty:
_setValue:forDatabaseProperty:
setLastSyncedEntityRevision:
lastSyncedEntityRevision
setLastSyncedDomainVersion:
lastSyncedDomainVersion
setDateLastSynced:
dateLastSynced
setLastNotificationDomainVersion:
lastNotificationDomainVersion
setDateToSyncWithUbiquitousStore:
dateToSyncWithUbiquitousStore
_updateUbiquitousDatabase_setBookmarkMetadataWithValuesFromTrackWithMetadataIdentifier:hasBeenPlayed:playCount:bookmarkTime:timestamp:syncRevision:usingConnection:
updateUbiquitousDatabaseByInsertingUbiquitousMetadataForTrackWithMetadataIdentifier:hasBeenPlayed:playCount:bookmarkTime:timestamp:syncRevision:
updateUbiquitousDatabaseWithClientIdentity:persistUbiquitousMetadataWithEntity:
_databaseHasEntryForEntity:
updateUbiquitousDatabaseWithClientIdentity:removeUbiquitousMetadataFromTrackWithPersistentID:
updateMusicLibraryWithClientIdentity:applyUbiquitousBookmarkMetadataToTrackWithPersistentID:
updateUbiquitousDatabaseByResetingSyncEntityRevisionForItemsWithMetadataIdentifiers:
readUbiquitousDatabaseMetadataValuesWithClientIdentity:identifier:
readUbiquitousDatabaseMetadataValuesWithClientIdentity:identifiers:
hasSyncedAtleastOnce
hasRemoteChangesToPull
hasLocalChangesToPush
dumpUbiquitousMetadata
musicLibrary
T@"ML3MusicLibrary",R,W,N,V_musicLibrary
TQ,N
T@"NSString",C,N
T@"NSDate",&,N
uppDatabase
supportsUPP
setMusicLibrary:
transactionEntityRevision
setTransactionEntityRevision:
ubiquitousIdentifiersToSync
setUbiquitousIdentifiersToSync:
_lastSyncedEntityRevision
_transactionEntityRevision
_lastSyncedDomainVersion
_ubiquitousIdentifiersToSync
T@"ML3MusicLibrary",&,N,V_musicLibrary
TQ,N,V_lastSyncedEntityRevision
TQ,N,V_transactionEntityRevision
T@"NSString",C,N,V_lastSyncedDomainVersion
T@"NSMutableSet",&,N,V_ubiquitousIdentifiersToSync
enumerateValuesForProperties:usingBlock:
initWithUbiquitousIdentifier:inLibrary:
entity
_entity
T@"NSString",R,N,V_identifier
T@"SBCPlaybackPositionEntity",R,N,V_entity
initWithPersistentID:inLibrary:
persistentID
track
_persistentID
_track
Tq,R,N,V_persistentID
T@"ML3Track",R,N,V_track
SBKPropertyValueForML3PropertyValue:ML3Property:
SBKQueryForTracksNeedingPushWithEntityRevisionAnchor:orderingTerms:
SBKSQLQueryStringForItemsNeedingPush
SBKBeginTransactionWithItemsToSyncEnumerationBlock:
SBKCancelUniversalPlaybackPositionTransaction:
SBKCommitUniversalPlaybackPositionTransaction:domainVersion:metadataEnumerationBlock:
delegate
setDelegate:
_delegate
T@"<SBDPushNotificationControllerDelegate>",W,N,V_delegate
cancel
connection:didReceivePublicToken:
connection:didReceiveToken:forTopic:identifier:
connection:didReceiveToken:forInfo:
connection:didReceiveURLToken:forInfo:
connection:didReceiveURLTokenError:forInfo:
connection:didReceiveIncomingMessage:
connection:didReceiveMessageForTopic:userInfo:
connection:didSendOutgoingMessage:
connection:didFailToSendOutgoingMessage:error:
connection:didChangeConnectedStatus:
connectionDidReconnect:
connection:channelSubscriptionsFailedWithFailures:
_onQueue_updateConnectionTopicsAndStoreRegistrations
setDelegate:forBookkeeperDomain:
isEnabledForDomain:
setEnabledDomains:
enabledDomains
updateNotificationRegistrationsWithCompletionBlock:
_startServiceConnectionsWithCompletionHandler:
_loadURLBagWithCompletionHandler:
_portNameForEnvironmentName:
_registeredAccountIDs
_onQueue_updateStoreBookkeeperNotificationRegistrationForDomain:optIn:accountID:withCompletionHandler:
updateStoreBookkeeperNotificationRegistration:
_onQueue_updateStoreBookkeeperNotificationRegistration:
connection
weakDomainDelegates
pendingAccountRequests
registeredAccountsForDomains
_environment
_temporaryConnectionsByEnvironment
_typeRegistrationURL
_enabledDomains
_pushEnabled
_bagLoaded
_registrationUpdateScheduled
_fakeNotificationObserver
_connection
_weakDomainDelegates
_pendingAccountRequests
_registeredAccountsForDomains
T@"APSConnection",R,N,V_connection
T@"NSMutableDictionary",R,N,V_weakDomainDelegates
T@"NSMutableDictionary",R,N,V_pendingAccountRequests
T@"NSMutableDictionary",R,N,V_registeredAccountsForDomains
T@"NSSet",&,N
initWithRequestProperties:
requestForDomain:optIn:accountID:typeRegistrationURL:
initWithDomain:optIn:accountID:typeRegistrationURL:
_requestPropertiesForDomain:optIn:typeRegistrationURL:
isEqualToRegistrationRequest:
storeAccountID
optIn
_optIn
_storeAccountID
T@"NSNumber",R,N,V_storeAccountID
T@"NSString",R,C,N,V_domain
TB,R,N,V_optIn
bookkeeperStorageControllerDidSync:
persistPlaybackPositionEntity:isCheckpoint:clientIdentity:completionBlock:
deletePlaybackPositionEntitiesWithClientIdentity:
synchronizeImmediately
pullLocalPlaybackPositionForEntityIdentifiers:clientIdentity:completionBlock:
synchronizeForUpdatedRemoteDomainVersion:
synchronizeForChangedAccountByResetInvalidatingLocalChanges:
synchronizeIfNeedsInitialSynchronization
synchronizeForChangedAccountStatus
_onQueue_clearHasChanges
_onQueueSynchronizeWithInterval:isCheckpoint:
syncedStorageController
preferredSynchronizeInterval
hasChangesToPush
isActive
_hasChangesToPush
_isActive
_syncedStorageController
_preferredSynchronizeInterval
T@"SBDDomainSyncedStorageController",R,N,V_syncedStorageController
Td,R,N,V_preferredSynchronizeInterval
TB,R,N,V_hasChangesToPush
TB,R,N,V_isActive
cloudStore
_cloudStore
T@"SBKUniversalPlaybackPositionStore",R,N,V_cloudStore
jobSchedulerForAccount:withDomain:
initializeBackgroundTaskAgentWithJobRunner:
scheduleUpdateJobWithTimeInterval:replaceExisting:
removeScheduledJobs
setDomain:
setAccountIdentifier:
T@"NSString",C,N,V_domain
T@"NSNumber",C,N,V_accountIdentifier
Connection invalidated: %@
Connection interrupted: %@
client %@ did not supply a domain in client connection configuration %@
Could not create client identity from XPCConnection=%@
attempt to use sync APIs on domain (%@) that does not support the sync protocol
Starting storebookkeeperd
Vending services: %@
Exiting storebookkeeperd main()
SBCPlaybackPositionDomain: Error fetching user identities. err=%@
Starting service 'SBCPlaybackPositionService'
reloading store accounts
Handling account did change notification
Dropping handler. foreignDatabasePath=nil
Dropping handler. handlerAccountID=nil
Dropping handler. handlerAccountID not in storeAccountIdentifiers
Scheduling reset sync
[SBDDomainSyncServiceHandler synchronizeForUpdatedRemoteDomainVersion]
synchronizeImmediatelyWithCompletionHandler
unable to load bag and determine polling interval
checking needsPoll, pollIntervalInSeconds = %@, lastSynced = %@ (%@)
received request update for domain version change to version: %@
skipping scheduling a sync, last synced domain version already %@
received request handle account change (set sync anchor to 0%@)
clearing all local changes that had been scheduled for push
reseting sync anchor to 0, and scheduling pull from server
running synchronizeImmediatelyWithCompletionHandler: now
received request to scheduleSyncBeforeDate: %@ (in %.2f sec)
target sync date from client: %@ (in %.2f sec)
target sync date in database has been passed, using sync date of 'now': %@ (in %.2f sec)
target sync date from database: %@ (in %.2f sec)
setting target date to: %@ (in %.2f sec)
scheduling sync NOW.
scheduling sync (via BackgroundTaskJob) %f seconds from now...
setting %@ to %@
failed to update ubiquitous bookmarkmatadata for metadata identifier %@.
updateMusicLibraryByApplyingUbiquitousBookmarkMetadataToTrackWithPersistentID:, persistentID %lld doesn't exist.
Error: SBDPushNotificationController init: Error unarchiving _registeredDomains from registeredDomains. registeredDomains=%@ error=%@
%@ APSConnection (env:%@) = %@ removed from runloop in dealloc
%@ connection:%@ didReceivePublicToken:%@
%@ connection:%@ didReceiveMessageForTopic:%@ userInfo:%@
Received push notification for storebookkeeper topic '%@' with userInfo %@
Received push notification for storebookkeeper domain '%@
Processing push notification for storebookkeeper domain '%@', version %@
%@ connection:%@ didReceiveIncomingMessage:%@
%@ connection:%@ didSendOutgoingMessage:%@
%@ connection:%@ didFailToSendOutgoingMessage:%@, error = %@
%@ connection:%@ didChangeConnectedStatus: connected = %d
%@ connectionDidReconnect:%@
Setting APNS connection enabled topics to %@ on connection %@
%@ Beginning APS bringup - creating connections...
%@ Push enabled: %d, environment: %@
%@->_connection (env:%@) = %@
%@ APSConnection (env:%@) = %@ removed from runloop
Push token: %@
Loading URL Bag
Finished loading URL Bag.  _pushEnabled = %@, _typeRegistrationURL = %@, _env = %@
Unable to update push notification registration to %@ for domain '%@' (accountID %@): reason = 'URL bag has not been loaded'.
Unable to update push notification registration to %@ for domain '%@' (accountID %@): reason = 'type registration URL not found in URL bag'.
Skipping opt-in push notification registration attempt for domain '%@' (accountID %@).  reason = 'push is not enabled at the moment'.
Unable to update push notification registration to %@ for domain '%@' (accountID %@): reason = 'account ID missing, not set, or unspecified'.
Skipping opt-out push notification registration attempt for domain '%@' (accountID %@).  reason = 'itunesstored has already sent an opt-out on our behalf'.
Making sure blocked accountID %@ is opted-out for push notifications
%@ push notification registration for domain '%@' (accountID: %@)
StoreBookkeeper update push notification registration to %@ for domain '%@' (accountID %@) issuing request %@ with properties %@
StoreBookkeeper update push notification registration to %@ for domain '%@' (accountID: %@) returned response %@ with status %ld with decoded body %@%@
...response-headers %@
ERROR: exception while handling SBKBlacklistedAccountIDs preference: %@
Received request: -%@, client=%@, entity=%@
[UPP] attempt to set hasChangeToPush while inactive may result in changes not being pushed to the servers.
received push notification event, %@'s version changed to %@
received changed account event, will reset sync%@
received request to do initial sync
received changed account event, will schedule sync
received request to synchronize immediately
v16@?0@"SBDDomainSyncServiceHandler"8
v16@?0@"SBDDomainValueServiceHandler"8
SBDServer.m
Use +sharedInstance instead
com.apple.storebookkeeperd.SBDServer
SBKStoreAccountChangedNotification
v16@?0@"NSNotification"8
SBKSharedMusicLibraryImportFinished
v32@?0@"NSNumber"8@"NSString"16@?<v@?B@"NSError">24
v20@?0B8@"NSError"12
XPCConnection
com.apple.storebookkeeperd.launched
@distinctUnionOfObjects.domain.foreignDatabasePath
com.apple.storebookkeeperd.XPCTransactionController
%@ identifier = %@ %@
DaemonTemporaryKeepAlive
v20@?0@"SBKStoreURLBagContext"8B16
 and clear last-sync revision number
com.apple.amp.storebookkeeperd
Default
Push
Server
SBDML3UbiquitousDatabase.m
use initWithMusicLibrary:
MLUbiquitousBookmarkEntityRevisionAnchor
MPUbiquitousBookmarkDomainVersionAnchorToken
MPDateLastSynced
MPUbiquitousBookmarkDomainVersionRemoteToken
MPDateToSyncWithUbiquitousStore
INSERT OR REPLACE INTO cloud_kvs (key, play_count_user, has_been_played, bookmark_time_ms, bookmark_sync_timestamp, bookmark_sync_revision) VALUES (?, ?, ?, ?, ?, ?)
has_been_played
play_count_user
bookmark_time_ms
bookmark_sync_timestamp
bookmark_sync_revision
%@ = ?
v32@?0@"NSString"8Q16^B24
UPDATE cloud_kvs SET %@ WHERE key = ?
SELECT item_pid, play_count_user, has_been_played, bookmark_time_ms FROM cloud_kvs INNER JOIN item_kvs USING (key) LEFT OUTER JOIN item USING (item_pid) WHERE key = ? AND item.item_pid IS NOT NULL
UPDATE item_stats SET bookmark_time_ms = ?, has_been_played = ?, play_count_user = ? where item_pid = ?
SELECT key FROM cloud_kvs WHERE key = ?
v16@?0@"ML3DatabaseConnection"8
DELETE FROM cloud_kvs WHERE key = ?
SELECT play_count_user, has_been_played, bookmark_time_ms FROM cloud_kvs WHERE key = ?
UPDATE cloud_kvs SET bookmark_sync_timestamp = ?, bookmark_sync_revision = ? WHERE key = ?
UPDATE cloud_kvs SET bookmark_sync_revision = 0 WHERE key
SELECT key, play_count_user, has_been_played, bookmark_time_ms, bookmark_sync_timestamp FROM cloud_kvs WHERE key
SELECT key, title, item_pid, bookmark_sync_timestamp, bookmark_time_ms, has_been_played, play_count_user  FROM cloud_kvs JOIN item_kvs using (key) JOIN item_extra using (item_pid)
id = %s; titles = %s; item_pids = %s; timestamp = %s; bookmark_time_ms = %s; has_been_played = %s; play_count_user %s
__SBDML3UbiquitousDatabaseKey
<NO VERSION>
%@: lastSyncedDomainVersion = %@, entityRevisions.lastSynced = %llu, entityRevisions.currentSyncTransaction = %llu)
v32@?0@"NSString"8@16^B24
%@ properties = %@
@16@?0@8
SELECT key FROM cloud_kvs LEFT OUTER JOIN item_kvs using (key) WHERE item_pid IS NULL AND bookmark_sync_timestamp != 0 AND bookmark_sync_revision >= ?
v32@?0q8Q16^B24
v32@?0@"ML3DatabaseRow"8@"NSError"16^B24
B16@?0@"ML3DatabaseConnection"8
v32@?0@"SBKUniversalPlaybackPositionMetadata"8@"ML3Track"16^B24
v32@?0@"SBKUniversalPlaybackPositionMetadata"8@16^B24
v32@?0@8@16^B24
com.apple.storebookkeeper
push-notifications.environment
push-notification-types.add-push-notification-type-url
SBKPushNotificationRegisteredDomains
com.apple.SBD.push-notification-controller
v32@?0@"NSString"8@"APSConnection"16^B24
PushNotificationConfiguration-LoadURLBag
v24@?0@"NSDictionary"8@"NSError"16
com.apple.aps.storebookkeeperd
com.apple.aps.storebookkeeperd.dev
com.apple.aps.storebookkeeperd.demo
Opt-in to
Opt-out of
, **error** = %@, %@
status
v24@?0@"SSURLConnectionResponse"8@"NSError"16
v28@?0@"NSString"8B16@"NSNumber"20
v32@?0@"NSString"8@"SBDPushRegistrationRequest"16^B24
domain
v32@?0@"NSString"8@"NSSet"16^B24
POST
application/x-apple-plist
Content-Type
bookkeeperDomain:%@
guid
notification-type
mzbookkeeper
put-parameters
SBKBlacklistedAccountIDs
unknown error
bad password token
unrecognized push notification type
no push device error
bad parameters in request
Request Failed: response status error (%d) '%@'
v8@?0
v12@?0B8
 (dropping local changes)
v40@?0@"SBKUniversalPlaybackPositionMetadata"8@"NSString"16@"NSString"24@"NSError"32
SBDPlaybackPositionService
SBCPlaybackPositionServiceProtocol_Internal
SBCPlaybackPositionServiceProtocol
SBCDomainSyncServiceProtocol
NSObject
SBCDomainValueServiceProtocol
SBCDomainSyncServiceProtocol_Internal
SBDDomainServiceHandler
SBDServer
NSXPCListenerDelegate
SBDPushNotificationControllerDelegate
XPCTransactionController
XPCTransaction
SBDDomainSyncedStorageController
SBKUniversalPlaybackPositionDataSource
SBDML3UbiquitousDatabase
SBDPlaybackPositionTransaction
SBKUniversalPlaybackPositionTransactionContext
SBDPlaybackPositionMediaItem
SBKUniversalPlaybackPositionMediaItem
SBDPlaybackPositionML3TrackMediaItem
SBKML3Properties
SBKSync
SBDWeakDomainDelegate
SBDPushNotificationController
APSConnectionDelegate
SBDPushRegistrationRequest
SBDDomainSyncServiceHandler
SBDDomainSyncedStorageObserver
SBDDomainValueServiceHandler
SBDJobScheduler
@24@0:8@16
B24@0:8@16
#16@0:8
@16@0:8
@24@0:8:16
@32@0:8:16@24
@40@0:8:16@24@32
B16@0:8
B24@0:8#16
B24@0:8:16
Vv16@0:8
Q16@0:8
^{_NSZone=}16@0:8
B24@0:8@"Protocol"16
@"NSString"16@0:8
Vv36@0:8@16B24@?28
Vv24@0:8@16
Vv32@0:8@16@?24
Vv36@0:8@"SBCPlaybackPositionEntity"16B24@?<v@?B>28
Vv24@0:8@"SBCPlaybackPositionEntity"16
Vv32@0:8@"NSArray"16@?<v@?B@"NSError"@"NSArray">24
Vv32@0:8@"SBCPlaybackPositionEntity"16@?<v@?B@"NSError"@"SBCPlaybackPositionEntity">24
Vv24@0:8@?16
Vv24@0:8@?<v@?B@"NSError">16
Vv24@0:8@"SBCClientConfiguration"16
v24@0:8@?16
v16@0:8
@"NSXPCConnection"
@"NSObject<OS_dispatch_queue>"
@"<SBCPlaybackPositionClientProtocol>"
@"SBDDomainSyncServiceHandler"
@"SBDDomainValueServiceHandler"
@"SBCClientConfiguration"
@"SBCPlaybackPositionDomain"
B32@0:8@16@24
B32@0:8@"NSXPCListener"16@"NSXPCConnection"24
v48@0:8@16@24@32@40
v48@0:8@"SBDPushNotificationController"16@"NSNumber"24@"NSString"32@"NSString"40
v20@0:8B16
v24@0:8@16
v40@0:8@16@24@?32
@"NSMutableArray"
@"NSXPCListener"
@"SBDPushNotificationController"
@"NSArray"
@"NSObject<OS_os_transaction>"
@"NSString"
@24@0:8@?16
@"<SBKUniversalPlaybackPositionTransactionContext>"24@0:8@?<v@?@"<SBKUniversalPlaybackPositionMediaItem>">16
v24@0:8@"<SBKUniversalPlaybackPositionTransactionContext>"16
v40@0:8@"<SBKUniversalPlaybackPositionTransactionContext>"16@"NSString"24@?<@"SBKUniversalPlaybackPositionMetadata"@?>32
v28@0:8@16B24
v32@0:8@16@24
v28@0:8B16@20
@32@0:8@16@24
@"NSOperationQueue"
@"SBKUniversalPlaybackPositionStore"
@"SBDML3UbiquitousDatabase"
@"ML3MusicLibrary"
@"NSNumber"
@"NSDate"
v24@0:8Q16
B68@0:8@16B24Q28d36d44q52@60
B60@0:8@16B24Q28d36d44q52
v32@0:8@16q24
@"NSMutableSet"
v32@0:8@16@?24
v32@0:8@"NSSet"16@?<v@?@"NSString"@^B>24
@"SBCPlaybackPositionEntity"
@32@0:8q16@24
q16@0:8
@"ML3Track"
@32@0:8Q16@24
@"<SBDPushNotificationControllerDelegate>"
v40@0:8@16@24@32
v32@0:8@"APSConnection"16@"NSData"24
v48@0:8@"APSConnection"16@"NSData"24@"NSString"32@"NSString"40
v40@0:8@"APSConnection"16@"NSData"24@"APSAppTokenInfo"32
v40@0:8@"APSConnection"16@"APSURLToken"24@"APSURLTokenInfo"32
v40@0:8@"APSConnection"16@"NSError"24@"APSURLTokenInfo"32
v32@0:8@"APSConnection"16@"APSIncomingMessage"24
v40@0:8@"APSConnection"16@"NSString"24@"NSDictionary"32
v32@0:8@"APSConnection"16@"APSOutgoingMessage"24
v40@0:8@"APSConnection"16@"APSOutgoingMessage"24@"NSError"32
v28@0:8@"APSConnection"16B24
v24@0:8@"APSConnection"16
v32@0:8@"APSConnection"16@"NSArray"24
v44@0:8@16B24@28@?36
@"NSMutableDictionary"
@"NSURL"
@"NSSet"
@"APSConnection"
@44@0:8@16B24@28@36
@36@0:8@16B24@28
v24@0:8@"SBDDomainSyncedStorageController"16
v28@0:8d16B24
d16@0:8
@"SBDDomainSyncedStorageController"
